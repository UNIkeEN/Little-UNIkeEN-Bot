{"config":{"lang":["en","ja"],"separator":"[\\s\\-\\.]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Index","text":"<p><code>version 1.2.0</code></p>"},{"location":"#1","title":"1. \u200b\u7b80\u4ecb","text":"<p>Little-UNIkeEN-Bot \u200b\u662f\u200b\u4e00\u4e2a\u200b\u7531\u200b Python \u200b\u7f16\u5199\u200b\u7684\u200b\u8f7b\u91cf\u7ea7\u200b\u3001\u200b\u53ef\u200b\u6269\u5c55\u200b\u7684\u200bQQ\u200b\u673a\u5668\u4eba\u200b\u524d\u7aef\u200b\uff0c\u200b\u5e95\u5c42\u200b\u57fa\u4e8e\u200b go-cqhttp\u3001flask\u3001mysql \u200b\u7b49\u200b\u7b2c\u4e09\u65b9\u200b\u4f9d\u8d56\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u5b58\u5728\u200b\u5f88\u591a\u200b\u5904\u200b\u6587\u6863\u200b\u5185\u5bb9\u200b\u843d\u540e\u200b\u4e8e\u200b\u4ee3\u7801\u200b\u7684\u200b\u60c5\u51b5\u200b</p> <p>\u200b\u7531\u4e8e\u200b\u6b64\u200b\u9879\u76ee\u200b\u968f\u7f18\u200b\u66f4\u65b0\u200b\u3001\u200b\u5f00\u53d1\u200b\u5f3a\u5ea6\u200b\u4e0d\u200b\u5927\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5b58\u5728\u200b\u5f88\u591a\u200b\u5904\u200b\u6587\u6863\u200b\u5185\u5bb9\u200b\u843d\u540e\u200b\u4e8e\u200b\u4ee3\u7801\u200b\u7684\u200b\u60c5\u51b5\u200b\u3002\u200b\u5efa\u8bae\u200b\u6709\u200b\u6761\u4ef6\u200b\u7684\u200b\u5f00\u53d1\u8005\u200b\u76f4\u63a5\u200b\u9605\u8bfb\u200b\u6e90\u7801\u200b\u8fdb\u884c\u200b\u5f00\u53d1\u200b\u3002</p>"},{"location":"#2","title":"2. \u200b\u9879\u76ee\u200b\u67b6\u6784\u56fe","text":"<ol> <li>\u200b\u7ea2\u6846\u200b\u6807\u6ce8\u200b\u7684\u200b\u662f\u200b\u7528\u6237\u200b\uff08\u200b\u63d2\u4ef6\u200b\u5f00\u53d1\u8005\u200b\uff09\u200b\u9700\u6c42\u200b</li> <li>\u200b\u84dd\u7ebf\u200b\u6807\u6ce8\u200b\u7684\u200b\u662f\u200b\u9700\u8981\u200b\u7528\u6237\u200b\u81ea\u884c\u200b\u8c03\u7528\u200b\u6216\u200b\u7f16\u5199\u200b\u7684\u200b\u903b\u8f91\u200b</li> <li>\u200b\u7eff\u7ebf\u200b\u6807\u6ce8\u200b\u7684\u200b\u662f\u200bbot\u200b\u5c01\u88c5\u200b\u597d\u200b\u7684\u200b\u903b\u8f91\u200b</li> </ol>"},{"location":"#3","title":"3. \u200b\u8fd0\u884c\u200b\u6d41\u7a0b\u56fe","text":""},{"location":"about/","title":"\u5173\u4e8e\u200b\u672c\u200b\u9879\u76ee","text":""},{"location":"about/#_1","title":"\u4f5c\u8005\u200b\u4ecb\u7ecd","text":"<ul> <li>UNIkeEN</li> <li>\u200b\u8eab\u4efd\u200b\uff1aSJTU 21\u200b\u7ea7\u200b\u672c\u79d1\u751f\u200b\uff0c\u200b\u7535\u9662\u200b</li> <li>\u200b\u804c\u52a1\u200b\uff1a\u200b\u9879\u76ee\u200b\u53d1\u8d77\u4eba\u200b\u3001\u200b\u4e3b\u8981\u200b\u5f00\u53d1\u8005\u200b</li> <li>fangtiancheng</li> <li>\u200b\u8eab\u4efd\u200b\uff1aSJTU 19\u200b\u7ea7\u200b\u672c\u79d1\u751f\u200b\uff0c\u200b\u7535\u9662\u200b</li> <li>\u200b\u804c\u52a1\u200b\uff1a\u200b\u4e3b\u200b\u67b6\u6784\u5e08\u200b\u3001\u200b\u6280\u672f\u987e\u95ee\u200b</li> </ul>"},{"location":"about/#_2","title":"\u5f00\u53d1\u200b\u5386\u7a0b","text":"<p>2022\u200b\u5e74\u200b\u6691\u5047\u200b\uff0c\u200b\u5468\u56f4\u200b\u7684\u200b\u670b\u53cb\u200b\u53d7\u200b\u67d0\u79cd\u200b\u98ce\u6c14\u200b\u5f71\u54cd\u200b\uff0c\u200b\u7eb7\u7eb7\u200b\u8dd1\u200b\u53bb\u200b\u5f00\u53d1\u200b QQ \u200b\u804a\u5929\u200b\u673a\u5668\u4eba\u200b\uff0c\u200b\u5176\u4e2d\u200b\u5927\u90e8\u5206\u200b\u4eba\u200b\u9009\u62e9\u200b nonebot \u200b\u4f5c\u4e3a\u200b\u57fa\u7840\u200b\u6846\u67b6\u200b\u3002\u200b\u4f5c\u4e3a\u200b\u540e\u6765\u8005\u200b\uff0c\u200b\u6211\u200b\u89c2\u5bdf\u200b\u5230\u200b\uff1a\u200b\u4ed6\u4eec\u200b\u5728\u200b\u4f7f\u7528\u200b nonebot \u200b\u540e\u200b\uff0c\u200b\u8fd8\u200b\u7eb7\u7eb7\u200b\u8dd1\u200b\u53bb\u200b\u770b\u200b go-cqhttp \u200b\u6587\u6863\u200b\uff0c\u200b\u751a\u81f3\u200b\u6709\u200b\u51e0\u4e2a\u200b\u62b1\u6028\u200b nonebot \u200b\u5c01\u88c5\u200b\u592a\u6df1\u200b\u3002\u200b\u53d7\u6b64\u200b\u5f71\u54cd\u200b\uff0c\u200b\u6211\u200b\u4fbf\u200b\u6253\u7b97\u200b\u53ea\u200b\u57fa\u4e8e\u200b go-cqhttp \u200b\u5f00\u53d1\u200b\u4e00\u5957\u200b QQ \u200b\u673a\u5668\u4eba\u200b\u51fa\u6765\u200b\u3002</p> <p>\u200b\u4e00\u4e2a\u6708\u200b\u540e\u200b\uff0c Little-UNIkeEN-Bot \u200b\u5927\u81f4\u200b\u6210\u578b\u200b\u3002\u200b\u6211\u200b\u4f5c\u4e3a\u200b\u540e\u6765\u8005\u200b\uff0c\u200b\u5f00\u53d1\u200b\u51fa\u200b\u7684\u200b\u529f\u80fd\u200b\u6bd4\u200b\u90a3\u200b\u51e0\u4e2a\u200b\u5148\u5230\u200b\u8005\u200b\u7684\u200b\u8fd8\u8981\u200b\u591a\u200b\u3002\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u200b\u4fbf\u200b\u8003\u8651\u200b\u5c06\u200b\u8fd9\u4e2a\u200b\u9879\u76ee\u200b\u7ee7\u7eed\u200b\u505a\u5927\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u4e00\u4e2a\u6708\u200b\uff0c\u200b\u6211\u200b\u6253\u78e8\u200b\u67b6\u6784\u200b\u3001\u200b\u5f15\u8fdb\u6280\u672f\u200b\u3001\u200b\u5f00\u53d1\u65b0\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u987a\u5229\u200b\u5730\u200b\u628a\u200b bot \u200b\u4fee\u200b\u5230\u200b\u66f4\u8fdb\u4e00\u6b65\u200b\u7684\u200b\u9ad8\u5ea6\u200b\u3002\u200b\u540c\u65f6\u200b\uff0c\u200b\u6211\u200b\u4e5f\u200b\u5f00\u59cb\u200b\u601d\u8003\u200b\u4e00\u4e2a\u200b\u54f2\u5b66\u200b\u95ee\u9898\u200b\uff1a</p> <p>onebot \u200b\u662f\u200b\u4e00\u4e2a\u200b\u597d\u200b\u65b9\u6848\u200b\u5417\u200b\uff1f</p> <p>\u200b\u6211\u200b\u601d\u8003\u200b\u4e86\u200b\u597d\u4e45\u200b\uff0c\u200b\u6700\u540e\u200b\u8ba4\u5b9a\u200b\u8fd9\u200b\u5e76\u200b\u4e0d\u662f\u200b\u4e00\u4e2a\u200b\u597d\u200b\u65b9\u6848\u200b\u3002\u200b\u539f\u56e0\u200b\u5982\u4e0b\u200b\uff1a</p> <p>onebot \u200b\u534f\u8bae\u200b\u4e3b\u6253\u200b\u8de8\u5e73\u53f0\u200b\uff0c\u200b\u76ee\u524d\u200b nonebot \u200b\u4e5f\u200b\u786e\u5b9e\u200b\u5b9e\u73b0\u200b\u4e86\u200b\uff0c\u200b\u4f46\u662f\u200b\u5e73\u53f0\u200b\u4e4b\u95f4\u200b\u7684\u200b\u5185\u5bb9\u200b\u5f02\u8d28\u6027\u200b\u662f\u200b\u4e2d\u95f4\u5c42\u200b\u8f6f\u4ef6\u200b\u65e0\u6cd5\u200b\u62b9\u5e73\u200b\u7684\u200b\u3002\u200b\u6bd4\u5982\u200b qq \u200b\u7684\u200b\u8868\u60c5\u200b\u3001at\u3001\u200b\u6233\u200b\u4e00\u200b\u6233\u200b\uff0c\u200b\u5f62\u72b6\u200b\u5982\u200b<code>[cq:xxx,id=xxx]</code>\uff1b\u200b\u9489\u200b\u9489\u200b\u7684\u200b\u5bcc\u200b\u6587\u672c\u200b\uff0c\u200b\u683c\u5f0f\u200b\u66f4\u200b\u4e0d\u597d\u200b\u63cf\u8ff0\u200b\u3002\u200b\u5982\u679c\u200b\u9700\u8981\u200b\u5f00\u53d1\u8005\u200b\u81ea\u5df1\u200b\u62b9\u9664\u200b\u5185\u5bb9\u200b\u5f02\u8d28\u6027\u200b\uff0c\u200b\u90a3\u4e48\u200b\u625b\u8d77\u200b\u8de8\u5e73\u53f0\u200b\u5927\u65d7\u200b\u7684\u200b\u4e2d\u95f4\u5c42\u200b\u4e5f\u200b\u6ca1\u6709\u200b\u751f\u5b58\u200b\u7684\u200b\u7684\u200b\u5fc5\u8981\u200b\u4e86\u200b\uff1b\u200b\u5982\u679c\u200b\u4e2d\u95f4\u5c42\u200b\u62b9\u200b\u9664\u4e86\u200b\u5185\u5bb9\u200b\u5f02\u8d28\u6027\u200b\uff0c\u200b\u90a3\u4e48\u200b\u5c31\u200b\u9700\u8981\u200b\u81ea\u5df1\u200b\u5236\u5b9a\u200b\u5927\u91cf\u200b\u6807\u51c6\u200b\u3001\u200b\u7f16\u5199\u200b\u5927\u91cf\u200b\u51fd\u6570\u200b\u3001\u200b\u9891\u7e41\u200b\u4fee\u6539\u200b\u4ee3\u7801\u200b\u5bf9\u63a5\u200b\u5e95\u5c42\u200b\uff0c\u200b\u8fd9\u6837\u200b\u505a\u200b\u65e2\u200b\u4e27\u5931\u200b\u4e86\u200b\u7248\u672c\u200b\u7a33\u5b9a\u6027\u200b\uff0c\u200b\u66f4\u200b\u9700\u8981\u200b\u6d88\u8017\u200b\u5f00\u53d1\u8005\u200b\u5927\u91cf\u200b\u7cbe\u529b\u200b\u53bb\u200b\u5b66\u4e60\u200b\u4f60\u200b\u81ea\u5df1\u200b\u5236\u5b9a\u200b\u7684\u200b\u63a5\u53e3\u200b\uff0c\u200b\u6709\u79cd\u200b\u201c\u200b\u81ea\u5df1\u200b\u73a9\u200b\u81ea\u5df1\u200b\u7684\u200b\u201d\u200b\u7684\u200b\u611f\u89c9\u200b\u3002\u200b\u66f4\u200b\u5931\u671b\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u963f\u91cc\u200b\u817e\u8baf\u200b\u53ef\u4e0d\u200b\u542c\u200b\u6211\u4eec\u200b\u8fd9\u4e9b\u200bbot\u200b\u5f00\u53d1\u4eba\u5458\u200b\u7684\u200b\u547c\u58f0\u200b\uff0c\u200b\u5f02\u8d28\u6027\u200b\u5185\u5bb9\u200b\u8fd8\u4f1a\u200b\u66f4\u200b\u591a\u200b\u66f4\u200b\u9891\u7e41\u200b\u5730\u200b\u5728\u200b\u672a\u6765\u200b\u51fa\u73b0\u200b\u3002</p> <p>nonebot\u200b\u662f\u200b\u9075\u5b88\u200bonebot\u200b\u534f\u8bae\u200b\u7684\u200b\uff0c\u200b\u81ea\u7136\u200b\u80fd\u200b\u770b\u51fa\u200b\u5176\u200b\u7f3a\u70b9\u200b\uff1a\u200b\u5c01\u88c5\u200b\u6df1\u200b\u8981\u6c42\u200b\u591a\u200b\u3001\u200b\u5f00\u53d1\u6210\u672c\u200b\u8fc7\u9ad8\u200b\u3001\u200b\u7248\u672c\u200b\u4e0d\u200b\u7a33\u5b9a\u200b\u3001QQ\u200b\u72ec\u7279\u200b\u7684\u200b\u5185\u5bb9\u200b\u4e0d\u80fd\u200b\u5b8c\u7f8e\u200b\u8868\u8fbe\u200b(\u200b\u6bd4\u5982\u200b\u7cbe\u534e\u200b\u6d88\u606f\u200b\u7b49\u200b)....</p> <p>\u200b\u56e0\u6b64\u200b\uff0c\u200b\u6211\u200b\u66f4\u52a0\u200b\u575a\u5b9a\u200b\u4e86\u200b\u63a8\u51fa\u200b\u4e00\u5957\u200b\u5b8c\u6574\u200b\u9879\u76ee\u200b\u7684\u200b\u51b3\u5fc3\u200b\u3002\u200b\u6211\u200b\u5f00\u59cb\u200b\u53ec\u96c6\u200b\u5c0f\u4f19\u4f34\u200b\u5199\u200b\u63d2\u4ef6\u200b\u3001\u200b\u5199\u200b\u6587\u6863\u200b\u3001\u200b\u6df1\u5ea6\u200b\u6253\u78e8\u200b\u67b6\u6784\u200b....</p> <p>\u200b\u76f4\u5230\u200b\uff0c\u200b\u6211\u4eec\u200b\u9686\u91cd\u63a8\u51fa\u200b\u672c\u200b\u9879\u76ee\u200b\u7684\u200b<code>1.0.0</code>\u200b\u7248\u672c\u200b\uff01</p>"},{"location":"about/#_3","title":"\u6211\u4eec\u200b\u7684\u200b\u4f18\u52bf\u200b\u548c\u200b\u4e0d\u8db3","text":"<p>nonebot \u200b\u662f\u200b Little-UNIkeEN-Bot \u200b\u7684\u200b\u4e3b\u8981\u200b\u7ade\u54c1\u200b\u4e4b\u4e00\u200b\uff0c\u200b\u76f8\u6bd4\u200b nonebot \uff0c\u200b\u6211\u4eec\u200b\u7684\u200b\u4f18\u52bf\u200b\u6709\u200b\uff1a</p> <ol> <li>\u200b\u6838\u5fc3\u200b\u4ee3\u7801\u200b\u5c0f\u4e8e\u200b 1000 \u200b\u884c\u200b\uff0c\u200b\u67b6\u6784\u200b\u7b80\u5355\u200b\u3001\u200b\u903b\u8f91\u200b\u6e05\u6670\u200b</li> <li>\u200b\u5728\u200b\u7f16\u7a0b\u200b\u5c42\u9762\u200b\u5c4f\u853d\u200b\u591a\u7ebf\u7a0b\u200b\uff0c\u200b\u6781\u5927\u200b\u5730\u200b\u51cf\u5c11\u200b\u5f00\u53d1\u200b\u96be\u5ea6\u200b</li> <li>\u200b\u5efa\u8bae\u200b\u7528\u6237\u200b\u76f4\u63a5\u200b\u4e0e\u200b qq \u200b\u9a71\u52a8\u200b\u5bf9\u8bdd\u200b\uff0c\u200b\u5e95\u5c42\u200b\u4e30\u5bcc\u200b\u529f\u80fd\u200b\u5373\u5b66\u200b\u5373\u200b\u7528\u200b</li> <li>\u200b\u4e0d\u7528\u200b\u8de8\u8fc7\u200b\u4e2d\u95f4\u5c42\u200b\uff0c\u200b\u80fd\u200b\u76f4\u63a5\u200b\u63a5\u53d7\u200b gocq \u200b\u7684\u200b dict \u200b\u683c\u5f0f\u200b\u6d88\u606f\u200b\u3001\u200b\u4f7f\u7528\u200b python \u200b\u5e93\u200b\u5b9a\u65f6\u200b\u7b49\u200b\uff0c\u200b\u51cf\u5c11\u200b\u5b66\u4e60\u200b\u3001\u200b\u5f00\u53d1\u6210\u672c\u200b</li> <li>\u200b\u6d88\u606f\u200b\u5c01\u88c5\u200b\u7b80\u5355\u200b\uff0c\u200b\u63d2\u4ef6\u200b\u793a\u4f8b\u200b\u4e30\u5bcc\u200b\uff0c\u200b\u529f\u80fd\u200b\u8f7b\u677e\u200b\u7f16\u5199\u200b</li> <li>\u200b\u7ed9\u200b\u5185\u5bb9\u200b\u751f\u4ea7\u8005\u200b\u63d0\u4f9b\u200b sql \u200b\u5b58\u50a8\u200b\u3001PIL \u200b\u5149\u6805\u200b\u5316\u200b\u670d\u52a1\u200b\uff0c\u200b\u5927\u5927\u589e\u52a0\u200b\u751f\u4ea7\u200b\u6548\u7387\u200b</li> </ol> <p>\u200b\u6211\u4eec\u200b\u7684\u200b\u4e0d\u8db3\u200b\u6709\u200b\uff1a</p> <ol> <li>\u200b\u975e\u200b\u8de8\u5e73\u53f0\u200b\uff0c\u200b\u76ee\u524d\u200b\u5b98\u65b9\u200b\u5e93\u4ec5\u200b\u652f\u6301\u200b qq (\u200b\u4e0d\u8fc7\u200b\u5df2\u7ecf\u200b\u6709\u200b\u5176\u4ed6\u200b\u4f5c\u8005\u200b\u5f00\u53d1\u200b\u4e86\u200b\u5fae\u4fe1\u200b\u7248\u672c\u200b)</li> <li>\u200b\u5728\u200b\u5f00\u53d1\u200b\u8fdb\u9636\u200b\u63d2\u4ef6\u200b\u65f6\u200b\uff0c\u200b\u9700\u8981\u200b\u5f00\u53d1\u8005\u200b\u989d\u5916\u200b\u5b66\u4e60\u200b mysql \u3001\u200b\u9605\u8bfb\u200b go-cqhttp \u200b\u6587\u6863\u200b</li> <li>\u200b\u6211\u4eec\u200b\u521a\u521a\u200b\u5f00\u6e90\u200b\uff0c\u200b\u793e\u533a\u200b\u5efa\u8bbe\u200b\u5e76\u200b\u4e0d\u200b\u5b8c\u5584\u200b</li> </ol> <p>\u200b\u6211\u4eec\u200b\u548c\u200b nonebot \u200b\u7684\u200b\u5dee\u5f02\u200b\uff1a</p> <ol> <li>\u200b\u6211\u4eec\u200b\u7684\u200b\u5b9a\u4f4d\u200b\u662f\u200b qq \u200b\u673a\u5668\u4eba\u200b\u524d\u7aef\u200b\uff0cnonebot \u200b\u7684\u200b\u5b9a\u4f4d\u200b\u662f\u200b\u591a\u200b\u804a\u5929\u200b\u8f6f\u4ef6\u200b\u4e2d\u95f4\u5c42\u200b&amp;\u200b\u524d\u7aef\u200b</li> </ol> <p>nonebot2 \u200b\u53cb\u60c5\u94fe\u63a5\u200b\uff1a\u200b\u6587\u6863\u200b\uff0c\u200b\u4ee3\u7801\u200b</p>"},{"location":"about/#_4","title":"\u514d\u8d23\u200b\u58f0\u660e","text":""},{"location":"about/#_5","title":"\u5f00\u6e90\u200b\u793e\u533a\u200b\u5efa\u8bbe","text":""},{"location":"license/","title":"\u6388\u6743\u200b\u8bb8\u53ef","text":"<p>MIT\u200b\u8bb8\u53ef\u200b</p> <p>Copyright (C) 2022 UNIkeEN</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>"},{"location":"progressiveness/","title":"BOT\u200b\u7684\u200b\u6280\u672f\u200b\u5148\u8fdb\u6027","text":"<p>\u200b\u672c\u9875\u200b\u5199\u200b\u4e8e\u200b2023\u200b\u5e74\u200b08\u200b\u6708\u200b\uff0c\u200b\u8ddd\u79bb\u200bbot\u200b\u7f16\u5199\u200b\u4e4b\u521d\u200b\u5df2\u8fc7\u200b\u4e00\u5e74\u200b\u6709\u4f59\u200b\u3002\u200b\u5728\u200b\u8fd9\u200b\u4e00\u5e74\u200b\u591a\u200b\u7684\u200b\u7ef4\u62a4\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\uff0cLittle Unicorn Bot\u200b\u6253\u8d25\u200b\u4e86\u200b\u5176\u4f59\u200bbot\uff0c\u200b\u5e02\u573a\u5360\u6709\u7387\u200b\u9065\u9065\u9886\u5148\u200b\uff0c\u200b\u7528\u6237\u200b\u7c98\u6027\u200b\u5341\u8db3\u200b\u3002\u200b\u8fd9\u200b\u9996\u5148\u200b\u8981\u200b\u5f52\u529f\u4e8e\u200bbot\u200b\u6210\u529f\u200b\u7684\u200b\u8fd0\u8425\u200b\u548c\u200b\u4e30\u5bcc\u200b\u800c\u200b\u7cbe\u5f69\u200b\u7684\u200b\u63d2\u4ef6\u200b\u3002\u200b\u5176\u6b21\u200b\uff0c\u200b\u8fd9\u200b\u4e0e\u200bbot\u200b\u6280\u672f\u200b\u4e0a\u200b\u7684\u200b\u5148\u8fdb\u6027\u200b\u662f\u200b\u5206\u4e0d\u5f00\u200b\u7684\u200b\u3002</p>"},{"location":"progressiveness/#1","title":"1. \u200b\u7075\u6d3b\u200b\u7684\u200b\u63d2\u4ef6\u200b\u5f00\u5173","text":"<p>\u200b\u4e3a\u4e86\u200b\u5728\u200b\u4e0d\u540c\u200b\u7fa4\u200b\u5f00\u5173\u200b\u4e0d\u540c\u200b\u7684\u200bbot\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u6211\u4eec\u200b\u8bbe\u8ba1\u200b\u4e86\u200b\u540d\u4e3a\u200b\u201cPluginGroupManager\u201d\u200b\u7684\u200b\u63d2\u4ef6\u200b\u7ba1\u7406\u5668\u200b\uff0c\u200b\u5728\u200b\u521d\u59cb\u5316\u200b\u63d2\u4ef6\u200b\u5217\u8868\u200b\u7684\u200b\u65f6\u5019\u200b\uff0cPluginGroupManager\u200b\u4e0e\u200b\u63d2\u4ef6\u200b\u8fdb\u884c\u200b\u7ec4\u5408\u200b\uff0c\u200b\u8fbe\u5230\u200b\u7edf\u4e00\u200b\u5f00\u5173\u200b\u63d2\u4ef6\u200b\u7ec4\u200b\u7684\u200b\u76ee\u7684\u200b\uff0c\u200b\u65e0\u9700\u200b\u5728\u200b\u63d2\u4ef6\u200b\u5c42\u9762\u200b\u989d\u5916\u200b\u8bb0\u5f55\u200b\u5f00\u5173\u200b\u8981\u6c42\u200b\u3002</p>"},{"location":"progressiveness/#2","title":"2. \u200b\u8d85\u5f3a\u200b\u98ce\u63a7\u200b\u6297\u6027","text":"<p>Bot\u200b\u9762\u4e34\u200b\u7684\u200b\u6700\u5927\u200b\u6311\u6218\u200b\u5c31\u662f\u200btx\u200b\u98ce\u63a7\u200b\uff0c\u200b\u98ce\u63a7\u200b\u539f\u56e0\u200b\u53ef\u80fd\u200b\u662f\u200b\u53d1\u9001\u200b\u9ec4\u8d4c\u6bd2\u200b\u56fe\u7247\u200b\u6587\u5b57\u200b\u3001\u200b\u8bed\u53e5\u200b\u68c0\u6d4b\u200b\u51fa\u200b\u654f\u611f\u200b\u8bcd\u200b\u3001\u200b\u9ad8\u9891\u200b\u53d1\u200b\u4fe1\u606f\u200b\u3001\u200b\u673a\u68b0\u6027\u200b\u53d1\u9001\u200b\u957f\u200b\u6587\u5b57\u200b\u7b49\u200b\u3002\u200b\u9488\u5bf9\u200b\u8fd9\u200b\u51e0\u4e2a\u200b\u98ce\u9669\u200b\u70b9\u200b\uff0c\u200b\u6211\u4eec\u200b\u9010\u4e00\u200b\u8bbe\u8ba1\u200b\u4e86\u200b\u89e3\u51b3\u529e\u6cd5\u200b\u3002</p> <p>\u200b\u9996\u5148\u200b\uff0c\u200b\u4e4b\u524d\u200b\u201c\u200b\u5f69\u7968\u200b\u201d\u200b\u63d2\u4ef6\u200b\u4f1a\u200b\u53d1\u9001\u200b\u5305\u542b\u200b\u201c\u200b\u5f69\u7968\u200b\u201d\u200b\u7684\u200b\u8bed\u53e5\u200b\uff0c\u201c\u200b\u6765\u70b9\u200b\u6da9\u200b\u6da9\u200b\u201d\u200b\u63d2\u4ef6\u200b\u4f1a\u200b\u53d1\u9001\u200b\u4e0d\u200b\u9002\u5b9c\u200b\u7684\u200b\u56fe\u7247\u200b\u3002\u200b\u4e3a\u6b64\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u201c\u200b\u5f69\u7968\u200b\u201d\u200b\u6539\u540d\u200b\u4e3a\u200b\u201c\u200b\u7948\u798f\u200b\u201d\uff0c\u200b\u5c06\u200b\u201c\u200b\u6765\u70b9\u200b\u6da9\u200b\u6da9\u200b\u201d\u200b\u4e0b\u67b6\u200b\uff0c\u200b\u89c4\u907f\u200b\u4e86\u200b\u4e24\u8005\u200b\u5e26\u6765\u200b\u7684\u200b\u98ce\u9669\u200b\u3002</p> <p>\u200b\u5176\u6b21\u200b\uff0c\u200b\u53d1\u9001\u200b\u957f\u200b\u6587\u5b57\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u98ce\u63a7\u200b\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u5c06\u200b\u53ef\u80fd\u200b\u5f15\u53d1\u200b\u6b64\u200b\u98ce\u9669\u200b\u7684\u200b\u5730\u65b9\u200b\u90fd\u200b\u6539\u6210\u200b\u4e86\u200b\u53d1\u9001\u200b\u56fe\u7247\u200b\uff0c\u200b\u4f8b\u5982\u200b\u201c-help\u201d\u3001\u201c-sjmc\u201d\u200b\u7b49\u7b49\u200b\u3002</p> <p>\u200b\u7b2c\u4e09\u200b\uff0c\u200b\u9ad8\u9891\u200b\u53d1\u9001\u4fe1\u606f\u200b\u4f1a\u200b\u5bfc\u81f4\u200b\u98ce\u63a7\u200b\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u5728\u200b\u7fa4\u804a\u200b\u6d88\u606f\u200b\u51fa\u53e3\u200b\u548c\u200bwarning\u200b\u6d88\u606f\u200b\u51fa\u53e3\u200b\u8bbe\u8ba1\u200b\u4e86\u200b\u7f13\u51b2\u200b\u961f\u5217\u200b\uff0c\u200b\u5c06\u200b\u7fa4\u804a\u200b\u6d88\u606f\u200b\u548c\u200b\u79c1\u804a\u200bwarning\u200b\u7684\u200b\u53d1\u9001\u200b\u9891\u7387\u200b\u5927\u4f53\u200b\u9650\u5236\u200b\u5728\u200b\u4e00\u79d2\u200b\u4e00\u6761\u200b\uff0c\u200b\u6709\u6548\u200b\u62b5\u5fa1\u200b\u4e86\u200b\u901a\u77e5\u200b\u5e7f\u64ad\u200b\u3001\u200b\u5927\u9762\u79ef\u200b\u8bcd\u4e91\u200b\u53d1\u9001\u200b\u7b49\u200b\u5e26\u6765\u200b\u7684\u200b\u98ce\u63a7\u200b\u98ce\u9669\u200b\u3002</p>"},{"location":"progressiveness/#3","title":"3. \u200b\u70ed\u63d2\u62d4\u200b\u652f\u6301","text":"<p>\u200b\u5728\u200b\u67d0\u4e9b\u200b\u65f6\u523b\u200b\uff0cbot\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u9ad8\u9891\u200b\u91cd\u542f\u200b\uff0c\u200b\u6d88\u606f\u200b\u4fdd\u5b58\u200b\u5728\u200b\u5185\u5b58\u200b\u4e2d\u662f\u200b\u4e0d\u200b\u53ef\u53d6\u200b\u7684\u200b\uff08\u200b\u4f1a\u200b\u4e22\u5931\u200bgroup config\u200b\u4fe1\u606f\u200b\u3001\u200b\u804a\u5929\u8bb0\u5f55\u200b\u4fe1\u606f\u200b\u7b49\u200b\uff09\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u5f15\u5165\u200b\u4e86\u200b\u6570\u636e\u5e93\u200b\u4f5c\u4e3a\u200b\u4fe1\u606f\u200b\u5b58\u50a8\u200b\u5bb9\u5668\u200b\u3002\u200b\u867d\u7136\u200b\u8fd9\u6837\u200b\u505a\u200b\u9700\u8981\u200b\u540c\u6b65\u200b\u5185\u5b58\u200b\u548c\u200b\u6570\u636e\u5e93\u200b\uff0c\u200b\u589e\u52a0\u200b\u4e86\u200b\u4ee3\u7801\u200b\u5f00\u53d1\u200b\u96be\u5ea6\u200b\uff0c\u200b\u4f46\u662f\u200b\u89e3\u51b3\u200b\u4e86\u200b\u70ed\u63d2\u62d4\u200b\u8fd9\u4e2a\u200b\u5927\u200b\u95ee\u9898\u200b\u3002</p>"},{"location":"progressiveness/#4","title":"4. \u200b\u9ad8\u53ef\u200b\u6269\u5c55\u200b\u3001\u200b\u6613\u8bfb\u200b\u6613\u7528\u200b\u7684\u200b\u67b6\u6784","text":"<p>Bot\u200b\u7684\u200b\u4e3b\u8981\u200b\u67b6\u6784\u200b\u5728\u200butils.standardPlugin\u200b\u91cc\u200b\uff0c\u200b\u4ee3\u7801\u200b\u7b80\u5355\u200b\u3001\u200b\u63a5\u53e3\u200b\u6613\u61c2\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u8d77\u6765\u200b\u975e\u5e38\u7b80\u5355\u200b\uff0c\u200b\u66f4\u200b\u6709\u200b\u5f88\u591a\u200b\u5df2\u200b\u5b9e\u73b0\u200b\u7684\u200b\u63d2\u4ef6\u200b\u53ef\u4ee5\u200b\u7167\u846b\u82a6\u753b\u74e2\u200b\u3002\u200b\u5728\u200b\u9ad8\u200b\u53ef\u200b\u6269\u5c55\u200b\u3001\u200b\u6613\u8bfb\u200b\u6613\u7528\u200b\u7684\u200b\u67b6\u6784\u200b\u52a0\u6301\u200b\u4e0b\u200b\uff0c\u200b\u6211\u4eec\u200b\u4ee5\u200b\u5f88\u200b\u4f4e\u200b\u7684\u200b\u6210\u672c\u200b\u5c31\u200b\u5f00\u53d1\u200b\u51fa\u200b\u4e86\u200b\u4e30\u5bcc\u200b\u7684\u200b\u63d2\u4ef6\u200b\u3002</p>"},{"location":"progressiveness/#5","title":"5. \u200b\u4e30\u5bcc\u200b\u7684\u200b\u5e95\u5c42\u200b\u5de5\u5177\u200b\u652f\u6301","text":"<p>\u200b\u6211\u4eec\u200b\u6709\u200b\u4e30\u5bcc\u200b\u7684\u200b\u5e95\u5c42\u200b\u5de5\u5177\u200b\u652f\u6301\u200bbot\u200b\u7684\u200b\u5e38\u89c4\u200b\u5f00\u53d1\u200b\uff0c\u200b\u6bd4\u5982\u200b\u753b\u56fe\u200b\u51fd\u6570\u5e93\u200butils.responoseImage_beta\uff0cgocqhttp\u200b\u7684\u200b\u5bf9\u63a5\u200b\u63a5\u53e3\u200butils.basicEvent\uff0c\u200b\u57fa\u7840\u67b6\u6784\u200butils.standardPlugin\uff0c\u200b\u7f13\u51b2\u200b\u961f\u5217\u200butils.bufferQueue\u200b\u7b49\u7b49\u200b\u3002</p>"},{"location":"progressiveness/#6","title":"6. \u200b\u5468\u5bc6\u200b\u7684\u200b\u544a\u8b66\u200b\u65b9\u6848","text":"<p>\u200b\u4e3a\u4e86\u200b\u62b5\u5fa1\u200b\u4ee3\u7801\u200bexception\u200b\u5bf9\u200b\u4e1a\u52a1\u200b\u7684\u200b\u5f71\u54cd\u200b\uff0c\u200b\u6211\u4eec\u200b\u8bbe\u8ba1\u200b\u4e86\u200bwarning\u200b\u6d88\u606f\u200b\u62a5\u8b66\u200b\u3002\u200b\u4e3a\u4e86\u200b\u62b5\u5fa1\u200bgocqhttp\u200b\u4e0b\u7ebf\u200b\u5bf9\u200bbot\u200b\u7684\u200b\u5f71\u54cd\u200b\uff0c\u200b\u6211\u4eec\u200b\u8bbe\u8ba1\u200b\u4e86\u200bgocqWatchDog\u200b\u90ae\u4ef6\u200b\u62a5\u8b66\u200b\u3002</p>"},{"location":"update-plan/","title":"\u66f4\u65b0\u200b\u65e5\u5fd7","text":""},{"location":"update-plan/#_1","title":"\u66f4\u65b0\u200b\u8ba1\u5212","text":"<p>\u200b\u76ee\u524d\u200b\u8ba1\u5212\u200b\u4e24\u5468\u200b\u66f4\u65b0\u200b\u4e00\u6b21\u200b\u5c0f\u200b\u7248\u672c\u200b\uff0c\u200b\u5927\u200b\u7248\u672c\u200b\u4e0d\u5b9a\u671f\u200b\u66f4\u65b0\u200b\u3002</p> <p>\u200b\u4e0b\u200b\u7248\u672c\u200b\u66f4\u65b0\u200b\u8ba1\u5212\u200b\uff1a</p> <ul> <li>\u200b\u6682\u65e0\u200b\u660e\u786e\u200b\u8ba1\u5212\u200b</li> </ul>"},{"location":"update-plan/#_2","title":"\u6700\u65b0\u200b\u7248\u672c","text":""},{"location":"update-plan/#120-2023712","title":"1.2.0 -2023/7/12","text":"<p>\u200b\u529f\u80fd\u200b\u66f4\u65b0\u200b\uff1a</p> <ol> <li>\u200b\u652f\u6301\u200b\u5bf9\u200bQQ\u200b\u9891\u9053\u200b\u7684\u200b\u6d88\u606f\u200b\u4e8b\u4ef6\u200b\u8fdb\u884c\u200b\u5904\u7406\u200b\uff0c\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u65b0\u589e\u200b\u9891\u9053\u200b\u64ad\u62a5\u200b</li> <li>\u200b\u65b0\u589e\u200b\u7f13\u51b2\u200b\u6d88\u606f\u200b\u961f\u5217\u200b\uff0c\u200b\u6dfb\u52a0\u200b\u6d88\u606f\u200b\u53d1\u9001\u200b\u95f4\u9694\u200b\uff0c\u200b\u51cf\u5c11\u200b Bot \u200b\u88ab\u200b\u98ce\u63a7\u200b\u98ce\u9669\u200b</li> <li>\u200b\u65b0\u589e\u200b\"APEX LEGENDS\"\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u83b7\u53d6\u200b\u6d3e\u200b\u6d3e\u200b\u5b9e\u65f6\u200b\u5404\u200b\u6a21\u5f0f\u200b\u5730\u56fe\u200b\u8f6e\u6362\u200b\u3001\u200b\u590d\u5236\u5668\u200b\u5236\u9020\u200b\u8f6e\u6362\u200b</li> <li>\u200b\u65b0\u589e\u200b\"\u200b\u4e2d\u56fd\u8c61\u68cb\u200b\"\u200b\u63d2\u4ef6\u200b\uff0c\u300c\u200b\u9694\u6cb3\u200b\u707f\u70c2\u200b\u4e3a\u5948\u5206\u200b\uff0c\u200b\u5c40\u52bf\u200b\u65b9\u5706\u200b\u5217\u9635\u200b\u4e91\u200b\u300d</li> <li>\u200b\u65b0\u589e\u200b\"\u200b\u7b7e\u5230\u200b v2\"\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u4f7f\u7528\u200b responseImage \u200b\u5e93\u200b\u7ed8\u5236\u200b\u7b7e\u5230\u200b\u5361\u7247\u200b</li> <li>\u200b\u65b0\u589e\u200b\"SJTU \u200b\u6559\u5ba4\u200b\u4eba\u6570\u200b\u5386\u53f2\u200b\"\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u83b7\u53d6\u200b\u6559\u5ba4\u200b\u8fd1\u671f\u200b\u4eba\u6570\u200b\u53d8\u5316\u8d8b\u52bf\u200b\u56fe\u200b</li> <li>\u200b\u65b0\u589e\u200b\"zsm \u200b\u8bed\u5f55\u200b\"\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u968f\u673a\u200b\u663e\u793a\u200b zsm \u200b\u7684\u200b\u8bed\u5f55\u200b @supervisoredis / zsm_corpus</li> <li>\u200b\u66f4\u65b0\u200b\"\u200b\u6c34\u7fa4\u200b\u8bb0\u5f55\u200b\"\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u7fa4\u200b\u6210\u5458\u200b\u73b0\u53ef\u200b\u9690\u85cf\u200b\u672c\u4eba\u200b\u7684\u200b\u6c34\u7fa4\u200b\u8bb0\u5f55\u200b\uff08\u200b\u4e0d\u200b\u8ba1\u5165\u200b\u6c34\u7fa4\u200b\u62a5\u544a\u200b\uff09\u3001\u200b\u7ba1\u7406\u5458\u200b\u53ef\u200b\u6062\u590d\u200b\u4e4b\u200b</li> <li>\u200b\u66f4\u65b0\u200b\"\u200b\u7edf\u4e00\u200b\u65e5\u7a0b\u200b\"\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u73b0\u53ef\u4e3a\u200b\u5168\u90e8\u200b\u7528\u6237\u200b\u6dfb\u52a0\u200b\u5171\u540c\u200b\u9876\u7f6e\u200b\u65e5\u7a0b\u200b</li> </ol> <p>\u200b\u4f18\u5316\u200b\u4fee\u590d\u200b\uff1a</p> <ol> <li>\u200b\u4f18\u5316\u200b\u5e76\u200b\u589e\u5220\u200b utils \u200b\u4e2d\u200b\u90e8\u5206\u200b\u6d89\u53ca\u200b\u6d88\u606f\u200b\u6536\u53d1\u200b\u3001\u200b\u6743\u9650\u200b\u7ba1\u7406\u200b\u3001\u200b\u914d\u7f6e\u7ba1\u7406\u200b\u7684\u200b\u57fa\u672c\u200b API \u200b\u51fd\u6570\u200b</li> <li>\u200b\u4f18\u5316\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u4e2d\u200b\u7684\u200b\u5e38\u91cf\u200b\u5b9a\u4e49\u200b\u3001\u200b\u9519\u8bef\u5904\u7406\u200b\u3001\u200b\u591a\u200b\u7fa4\u200b\u64ad\u62a5\u200b\u903b\u8f91\u200b</li> <li>\u200b\u5f03\u7528\u200b\"SJTU \u200b\u6838\u9178\u200b\"\u200b\u7b49\u200b\u8fc7\u65f6\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u56e0\u200b\u6d89\u53ca\u200b\u654f\u611f\u200b\u4fe1\u606f\u200b\u6216\u200b\u654f\u611f\u200b\u7b2c\u4e09\u65b9\u200b API \u200b\u4e0d\u518d\u200b\u5f00\u6e90\u200b</li> <li>\u200b\u4fee\u590d\u200b\"Bilibili \u200b\u8ba2\u9605\u200b\"\u200b\u63d2\u4ef6\u200b\u6240\u200b\u4f7f\u7528\u200b\u7b2c\u4e09\u65b9\u200b\u5e93\u200b\u5199\u5165\u200b\u9519\u8bef\u200b\u7684\u200b\u95ee\u9898\u200b\uff0c\u200b\u5927\u5e45\u200b\u63d0\u5347\u200b Bot \u200b\u8fd0\u884c\u200b\u7a33\u5b9a\u6027\u200b</li> <li>\u200b\u4fee\u590d\u200b responseImage \u200b\u5e93\u200b\u3001\"Canvas \u200b\u65e5\u5386\u200b\u540c\u6b65\u200b\"\u200b\u7b49\u200b\u63d2\u4ef6\u200b\u90e8\u5206\u200b\u753b\u56fe\u200b\u573a\u666f\u200b\u4e0b\u200b\u6587\u5b57\u200b\u5206\u884c\u200b\u5931\u8d25\u200b\u7684\u200b\u95ee\u9898\u200b</li> <li>\u200b\u4fee\u590d\u200b\u5176\u4ed6\u200b\u82e5\u5e72\u200b\u5df2\u77e5\u200b\u95ee\u9898\u200b</li> </ol>"},{"location":"update-plan/#_3","title":"\u5386\u53f2\u200b\u7248\u672c","text":""},{"location":"update-plan/#114-202336","title":"1.1.4 - 2023/3/6","text":"<p>\u200b\u529f\u80fd\u200b\u66f4\u65b0\u200b\uff1a</p> <ol> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u52a0\u7fa4\u200b\u9a8c\u8bc1\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u57fa\u4e8e\u200b SJTU-Plus \u200b\u7b49\u200b\u65b9\u5f0f\u200b\u81ea\u52a8\u200b\u5ba1\u6279\u200b\u52a0\u7fa4\u200b\u7533\u8bf7\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u7edf\u4e00\u200b\u65e5\u7a0b\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u6839\u636e\u200b\u7528\u6237\u200b Canvas \u200b\u4e8b\u4ef6\u200b\u7ed8\u5236\u200b\u65e5\u7a0b\u8868\u200b\uff0c\u200b\u672a\u6765\u200b\u53ef\u200b\u6dfb\u52a0\u200b\u5176\u4ed6\u200b\u63d2\u4ef6\u200b\u7684\u200b\u65e5\u7a0b\u200b\u6570\u636e\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201cSJTU \u200b\u4fdd\u536b\u5904\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u8ba2\u9605\u200b SJTU \u200b\u4fdd\u536b\u5904\u200b\u5404\u9879\u200b\u901a\u77e5\u200b\u5e76\u200b\u5728\u200b\u7fa4\u5185\u200b\u63d0\u9192\u200b</li> </ol> <p>\u200b\u4f18\u5316\u200b\u4fee\u590d\u200b\uff1a</p> <ol> <li>\u200b\u4f18\u5316\u200b\u9a71\u52a8\u5668\u200b\u5bf9\u63a5\u200b\u5e93\u200b\uff0c\u200b\u589e\u52a0\u200b\u5bf9\u200b\u8fdb\u7fa4\u200b\u7533\u8bf7\u200b\u3001\u200b\u9080\u8bf7\u200b\u52a0\u7fa4\u200b\u4fe1\u606f\u200b\u7684\u200b\u652f\u6301\u200b\u4e0e\u200b\u8bb0\u5f55\u200b</li> <li>\u200b\u4f18\u5316\u200b\"Bilibili \u200b\u8ba2\u9605\u200b\u201c\u3001\u201dSJMC \u200b\u5f00\u64ad\u200b\u63d0\u9192\u200b\u201c\u200b\u7b49\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5b9e\u73b0\u200b\u903b\u8f91\u200b</li> <li>ROOT \u200b\u7ba1\u7406\u5458\u200b\u73b0\u53ef\u200b\u901a\u8fc7\u200b\u79c1\u804a\u200b Bot \u200b\u5173\u95ed\u200b\u5176\u200b\u5728\u200b\u6307\u5b9a\u200b\u7fa4\u200b\u7684\u200b\u6307\u5b9a\u200b\u529f\u80fd\u200b\uff0c\u200b\u4fbf\u4e8e\u7ba1\u7406\u200b\u548c\u200b\u5f00\u53d1\u8005\u200b\u6d4b\u8bd5\u200b</li> <li>\u200b\u5f03\u7528\u200b\u90e8\u5206\u200b\u4f7f\u7528\u200b\u5931\u6548\u200b API \u200b\u6216\u200b\u5df2\u200b\u65e0\u200b\u4f7f\u7528\u200b\u4ef7\u503c\u200b\u7684\u200b\u63d2\u4ef6\u200b</li> <li>\u200b\u4fee\u590d\u200b\u5176\u4ed6\u200b\u82e5\u5e72\u200b\u5df2\u77e5\u200b\u95ee\u9898\u200b</li> </ol>"},{"location":"update-plan/#113-2023220","title":"1.1.3 - 2023/2/20","text":"<p>\u200b\u529f\u80fd\u200b\u66f4\u65b0\u200b\uff1a</p> <ol> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u6559\u5ba4\u200b\u67e5\u8be2\u200b/\u200b\u6559\u5ba4\u200b\u4eba\u6570\u200b/\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u67e5\u8be2\u200b\u6559\u5ba4\u200b\u5b9e\u65f6\u200b\u8bfe\u8868\u200b\u3001\u200b\u4eba\u6570\u200b\u3001\u200b\u73af\u5883\u53c2\u6570\u200b\u5e76\u200b\u63a8\u8350\u200b\u5408\u9002\u200b\u7684\u200b\u81ea\u4e60\u200b\u6559\u5ba4\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u9a71\u52a8\u5668\u200b\u544a\u8b66\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u5f53\u200b\u7b2c\u4e09\u65b9\u200b\u9a71\u52a8\u5668\u200b\uff08go-cqhttp\uff09\u200b\u79bb\u7ebf\u200b\u65f6\u5411\u200b\u7ba1\u7406\u5458\u200b\u90ae\u7bb1\u200b\u53d1\u9001\u200b\u8b66\u62a5\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u4f2a\u88c5\u200b\u901a\u77e5\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u4f2a\u88c5\u200b QQ \u200b\u5b98\u65b9\u200b\u901a\u77e5\u200b\u4fe1\u606f\u200b\u53d1\u9001\u200b\u73a9\u7b11\u200b\u6807\u8bed\u200b</li> </ol> <p>\u200b\u4f18\u5316\u200b\u4fee\u590d\u200b\uff1a</p> <ol> <li>\u200b\u5168\u9762\u200b\u6d4b\u8bd5\u200b\u4f18\u5316\u200b git clone \u200b\u5f00\u7bb1\u200b\u5373\u7528\u200b \u200b\u8fc7\u7a0b\u200b\uff0c\u200b\u66f4\u65b0\u200b\u4f9d\u8d56\u200b\u5217\u8868\u200b\u4e0e\u200b\u90e8\u7f72\u200b\u6587\u6863\u200b\uff0c\u200b\u5b8c\u5584\u200b\u6570\u636e\u5e93\u200b\u521d\u59cb\u5316\u200b\u7b49\u200b\u51fd\u6570\u200b</li> <li>\u200b\u4f18\u5316\u200b\u5f03\u7528\u200b\u903b\u8f91\u200b\uff0c\u200b\u5c06\u200b\u7fa4\u200b\u79fb\u51fa\u200b\u542f\u7528\u200b\u5217\u8868\u200b\u540e\u200b\u6743\u9650\u200b\u6570\u636e\u5e93\u200b\u540c\u6b65\u200b\u66f4\u65b0\u200b</li> <li>\u200b\u4f18\u5316\u200b\u6d88\u606f\u200b\u5206\u7c7b\u200b\u903b\u8f91\u200b\uff0c\u200b\u589e\u52a0\u200b\u5bf9\u200b heartbelt \u200b\u7c7b\u200b\u4fe1\u606f\u200b\u7684\u200b\u5206\u7c7b\u200b</li> <li>\u200b\u4fee\u590d\u200b Bot \u200b\u8fd0\u884c\u200b\u5728\u200b Windows \u200b\u5e73\u53f0\u200b\u4e0b\u56e0\u200b\u8def\u5f84\u200b\u9519\u8bef\u200b\u65e0\u6cd5\u200b\u53d1\u9001\u200b\u5404\u7c7b\u200b\u56fe\u7247\u200b\u7684\u200b\u95ee\u9898\u200b</li> <li>\u200b\u4fee\u590d\u200b\u5176\u4ed6\u200b\u82e5\u5e72\u200b\u5df2\u77e5\u200b\u95ee\u9898\u200b</li> </ol>"},{"location":"update-plan/#112-202329","title":"1.1.2 - 2023/2/9","text":"<p>\u200b\u529f\u80fd\u200b\u66f4\u65b0\u200b\uff1a</p> <ol> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u6c34\u7fa4\u200b\u6392\u884c\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u7edf\u8ba1\u200b\u5c55\u793a\u200b\u7fa4\u5185\u200b\u7528\u6237\u200b\u53d1\u9001\u200b\u6d88\u606f\u200b\u6570\u200b\u6392\u884c\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201cBilibili\u200b\u8ba2\u9605\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u8ba2\u9605\u200b\u5e76\u200b\u83b7\u53d6\u200bB\u200b\u7ad9\u200bup\u200b\u4e3b\u200b\u66f4\u65b0\u200b\u63d0\u9192\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u70ed\u200b\u641c\u200b\u805a\u5408\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u83b7\u53d6\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b\u3001\u200b\u767e\u5ea6\u200b\u70ed\u200b\u641c\u200b\u4e0e\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b</li> <li>\u200b\u66f4\u65b0\u200b\u201c\u200b\u6bcf\u65e5\u200b\u65b0\u95fb\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u83b7\u5f97\u200b\u6628\u65e5\u200b\u65b0\u95fb\u200b\u3001\u200b\u5e76\u200b\u5728\u200b\u5f53\u65e5\u200b\u65b0\u95fb\u200b\u6e90\u200b\u66f4\u65b0\u200b\u65f6\u4e8e\u200b\u7fa4\u5185\u200b\u64ad\u62a5\u200b</li> </ol> <p>\u200b\u4f18\u5316\u200b\u4fee\u590d\u200b\uff1a</p> <ol> <li>\u200b\u4f18\u5316\u200b\u201c\u200b\u62cd\u4e00\u200b\u62cd\u56de\u200b\u62cd\u200b\u201d\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5b9e\u73b0\u200b\u903b\u8f91\u200b</li> <li>\u200b\u4f18\u5316\u200b\u5b9a\u65f6\u200b\u7c7b\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5e95\u5c42\u200b\u903b\u8f91\u200b</li> <li>\u200b\u4f18\u5316\u200b\u5e2e\u52a9\u200b\u63d2\u4ef6\u200b\u7684\u200b\u663e\u793a\u65b9\u5f0f\u200b\uff0c\u200b\u5c06\u200b\u7fa4\u4e3b\u200b\u3001ROOT\u200b\u4e0e\u200b\u7fa4\u200bBot\u200b\u7ba1\u7406\u5458\u200b\u4ee5\u200b\u7b26\u53f7\u200b\u8868\u793a\u200b</li> <li>\u200b\u4fee\u590d\u200b\u5176\u4ed6\u200b\u82e5\u5e72\u200b\u5df2\u77e5\u200b\u95ee\u9898\u200b</li> </ol>"},{"location":"update-plan/#111-2023126","title":"1.1.1 - 2023/1/26","text":"<p>\u200b\u529f\u80fd\u200b\u66f4\u65b0\u200b\uff1a</p> <ol> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u6c34\u7fa4\u200b\u62a5\u544a\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u7edf\u8ba1\u200b\u5e76\u200b\u5c55\u793a\u200b\u7fa4\u5185\u200b\u6210\u5458\u200b\u7684\u200b\u6d3b\u8dc3\u200b\u7a0b\u5ea6\u200b\u3001\u200b\u4e0e\u200b Bot \u200b\u7684\u200b\u4e92\u52a8\u200b\u6b21\u6570\u200b\u7b49\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u6628\u65e5\u200b\u8bcd\u4e91\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u603b\u7ed3\u200b\u6628\u65e5\u200b\u7fa4\u804a\u200b\u4e2d\u200b\u7684\u200b\u9ad8\u9891\u200b\u70ed\u8bcd\u200b\u5e76\u200b\u751f\u6210\u200b\u8bcd\u4e91\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201cSJTU \u200b\u6559\u5ba4\u200b\u67e5\u8be2\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200b\u4e3b\u8981\u200b\u6559\u5b66\u697c\u200b\u7684\u200b\u5b9e\u65f6\u200b\u4eba\u6570\u200b\u3001\u200b\u73af\u5883\u53c2\u6570\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u201c\u200b\u968f\u673a\u200b\u52a9\u624b\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u63d0\u4f9b\u200b\u9ab0\u5b50\u200b\u3001\u200b\u4e09\u56fd\u200b\u6740\u200b\u5224\u5b9a\u200b\u3001\u200b\u5854\u7f57\u724c\u200b\u5360\u535c\u200b\u7b49\u200b\u529f\u80fd\u200b</li> <li>\u200b\u66f4\u65b0\u200b\u201c\u200b\u7fa4\u200b\u529f\u80fd\u200b\u8bbe\u7f6e\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u4f18\u5316\u200b\u7fa4\u200b\u7ba1\u7406\u5458\u200b\u5f00\u5173\u200b\u529f\u80fd\u200b\u7684\u200b\u64cd\u4f5c\u200b</li> </ol> <p>\u200b\u4f18\u5316\u200b\u4fee\u590d\u200b\uff1a</p> <ol> <li>\u200b\u5168\u5c40\u200b\u4f18\u5316\u200b\u5b9a\u65f6\u200b\u4efb\u52a1\u200b\u7684\u200b\u5b9e\u73b0\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u7f16\u5199\u200b\u7edf\u4e00\u200b\u7684\u200b\u5b9a\u65f6\u200b\u89e6\u53d1\u200b\u51fd\u6570\u200b</li> <li>\u200b\u4f18\u5316\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u7684\u200b\u6b63\u5219\u8868\u8fbe\u5f0f\u200b\u89e6\u53d1\u200b\u903b\u8f91\u200b</li> <li>\u200b\u4f18\u5316\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5e2e\u52a9\u200b\u63d0\u793a\u200b\u6587\u672c\u200b\u3001\u200b\u63d2\u4ef6\u200b\u4f7f\u7528\u200b\u7684\u200b\u8bed\u6599\u5e93\u200b</li> <li>\u200b\u4f18\u5316\u200b responseImage \u200b\u5e93\u200b\u5bf9\u4e8e\u200b\u4e0d\u540c\u200b\u683c\u5f0f\u200b\u7684\u200b\u53c2\u6570\u200b\u4f20\u5165\u200b\u65b9\u5f0f\u200b\u4e0e\u200b\u5b9e\u73b0\u200b\u65b9\u5f0f\u200b</li> <li>\u200b\u5f03\u7528\u200b\u5982\u200b\u201c\u200b\u539f\u795e\u200b\u5b9e\u65f6\u200b\u4fbf\u7b3a\u200b\u201d\u200b\u63d2\u4ef6\u200b\u4e2d\u7c73\u200b\u6e38\u793e\u200b\u63a5\u53e3\u200b\u7b49\u200b\u5df2\u200b\u5931\u6548\u200b\u7684\u200b API \u200b\u53ca\u200b\u63d2\u4ef6\u200b</li> </ol> <p>\u200b\u4fee\u590d\u200b\u5176\u4ed6\u200b\u82e5\u5e72\u200b\u5df2\u77e5\u200b\u95ee\u9898\u200b</p>"},{"location":"update-plan/#110-20221217","title":"1.1.0 - 2022/12/17","text":"<p>\u200b\u529f\u80fd\u200b\u66f4\u65b0\u200b\uff1a</p> <ol> <li>\u200b\u66f4\u65b0\u200b\u201c\u200b\u5e2e\u52a9\u200b v2\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u652f\u6301\u200b\u5d4c\u5957\u200b\u63d2\u4ef6\u200b\u7ec4\u200b\u673a\u5236\u200b</li> <li>\u200b\u66f4\u65b0\u200b\u201cMinecraft\u200b\u793e\u200b\u670d\u52a1\u5668\u200b\u72b6\u6001\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u652f\u6301\u200b\u6caa\u200b\u4e0a\u200b\u53cb\u6821\u200b\u793e\u56e2\u200b\u670d\u52a1\u5668\u200b\u3001\u200b\u5f02\u6b65\u200b\u8bfb\u53d6\u200b\u670d\u52a1\u5668\u200b\u4fe1\u606f\u200b</li> <li>\u200b\u66f4\u65b0\u200b\u201c\u200b\u7fa4\u200b\u529f\u80fd\u200b\u8bbe\u7f6e\u200b\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u652f\u6301\u200b\u5355\u4e00\u200b\u547d\u4ee4\u200b\u6253\u5f00\u200b\u591a\u200b\u63d2\u4ef6\u200b\u7ec4\u200b\u3001\u200b\u4e00\u952e\u200b\u6dfb\u52a0\u200b\u7fa4\u200b\u7ba1\u7406\u5458\u200b\u4e3a\u200b Bot \u200b\u7ba1\u7406\u5458\u200b\u7b49\u200b</li> <li>\u200b\u6dfb\u52a0\u200b\u79c1\u804a\u200b\u8ba2\u9605\u200b\u673a\u5236\u200b\u3001\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\uff08\u201d\u200b\u6559\u52a1\u5904\u200b\u66f4\u65b0\u200b\u8ba2\u9605\u200b\u201c\u201d\u200b\u9ea6\u5f53\u52b3\u200b\u72b6\u6001\u200b\u201c\u200b\u7b49\u200b\uff09\u200b\u9002\u7528\u200b</li> <li>\u200b\u66f4\u65b0\u200b\u201dbasicEvent\u201c\u200b\u5e93\u200b\uff0c\u200b\u589e\u52a0\u200b\u66f4\u200b\u591a\u200b\u4e0e\u200b go-cqhttp \u200b\u5bf9\u63a5\u200b\u7684\u200b\u529f\u80fd\u200b\u63a5\u53e3\u200b</li> </ol> <p>\u200b\u4f18\u5316\u200b\u4fee\u590d\u200b\uff1a</p> <ol> <li>\u200b\u4f18\u5316\u200b\u5305\u200b\u7684\u200b\u5bfc\u5165\u200b\u4e0e\u200b\u4f9d\u8d56\u200b\u5173\u7cfb\u200b\uff0c<code>git clone</code> \u200b\u5f00\u7bb1\u200b\u5373\u7528\u200b</li> <li>\u200b\u4f18\u5316\u200b\u201cFAQ v2\u201d\u200b\u63d2\u4ef6\u200b\u7684\u200b\u51fd\u6570\u200b\u903b\u8f91\u200b\u3001\u200b\u89c4\u8303\u5316\u200b\u4ee3\u7801\u200b\u6ce8\u91ca\u200b</li> <li>\u200b\u4f18\u5316\u200b\u201d\u200b\u5f69\u7968\u200b\u201c\u200b\u63d2\u4ef6\u200b\u7684\u200b\u90e8\u5206\u200b\u6587\u6848\u200b\u5e76\u200b\u6539\u540d\u200b\u4e3a\u200b\u201d\u200b\u7948\u613f\u200b\u201c</li> <li>\u200b\u4f18\u5316\u200b\u201d\u200b\u4fc4\u7f57\u65af\u200b\u8f6e\u76d8\u200b\u201c\u200b\u63d2\u4ef6\u200b\u4e2d\u200b\u7684\u200b\u90e8\u5206\u200b\u6587\u6848\u200b\uff0c\u200b\u4fee\u590d\u200b\u4e86\u200b\u82e5\u5e72\u200b\u95ee\u9898\u200b</li> <li>\u200b\u4fee\u590d\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u5bf9\u4e8e\u200b\u4e34\u65f6\u6587\u4ef6\u200b\u5b58\u50a8\u200b\u8def\u5f84\u200b\u9519\u8bef\u200b\u7684\u200b\u95ee\u9898\u200b</li> <li>\u200b\u4fee\u590d\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u5bf9\u4e8e\u200b\u64a4\u56de\u200b\u6d88\u606f\u200b\u3001\u200b\u533f\u540d\u200b\u6d88\u606f\u200b\u7684\u200b\u5931\u6548\u200b\u95ee\u9898\u200b</li> <li>\u200b\u4fee\u590d\u200b\u201c\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u66f4\u65b0\u200b\u63d0\u9192\u200b\u201d\u200b\u4e2d\u56e0\u200b\u7f51\u7ad9\u200b\u8fd4\u56de\u503c\u200b\u4e0d\u5f53\u200b\u5bfc\u81f4\u200b\u7684\u200b\u5d29\u6e83\u200b\u95ee\u9898\u200b</li> <li>\u200b\u4fee\u590d\u200b\u5176\u4ed6\u200b\u82e5\u5e72\u200b\u5df2\u77e5\u200b\u95ee\u9898\u200b</li> </ol>"},{"location":"update-plan/#103-20221119","title":"1.0.3 - 2022/11/19","text":"<p>\u200b\u529f\u80fd\u200b\u66f4\u65b0\u200b\uff1a</p> <ol> <li>\u200b\u65b0\u589e\u200b\u201cMinecraft \u200b\u793e\u200b\u76f4\u64ad\u200b\u5f00\u64ad\u200b\u63d0\u9192\u200b\u201d\u200b\u63d2\u4ef6\u200b</li> <li>\u200b\u65b0\u589e\u200b\u201c\u200b\u6821\u5185\u200b\u6838\u9178\u200b\u70b9\u4f4d\u200b\u67e5\u8be2\u200b\u201d\u200b\u548c\u200b\u201c\u200b\u9ea6\u5f53\u52b3\u200b\u8425\u4e1a\u200b\u72b6\u6001\u200b\u67e5\u8be2\u200b\u201d\u200b\u63d2\u4ef6\u200b</li> <li>\u200b\u65b0\u589e\u200b\u201c\u200b\u6211\u200b\u7231\u200b\u7535\u8def\u200b\u5b9e\u9a8c\u200b\u201d\u200b\u63d2\u4ef6\u200b</li> <li>\u200b\u65b0\u589e\u200b\u201cFAQ v2\u201d\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u57fa\u4e8e\u200b MySql \u200b\u5b9e\u73b0\u200b\u53ef\u200b\u56de\u6eaf\u200b\u8bb0\u5f55\u200b\u7684\u200b\u65b0\u7248\u200b\u95ee\u7b54\u200b\u5e93\u200b\u529f\u80fd\u200b</li> </ol> <p>\u200b\u4f18\u5316\u200b\u4fee\u590d\u200b\uff1a</p> <ol> <li>\u200b\u4f18\u5316\u200b\u201cMinecraft \u200b\u793e\u200b\u670d\u52a1\u5668\u200b\u67e5\u8be2\u200b\u201d\u200b\u529f\u80fd\u200b\u67e5\u8be2\u200b\u903b\u8f91\u200b\uff0c\u200b\u4f7f\u7528\u200b\u5f02\u6b65\u200b\u673a\u5236\u200b</li> <li>\u200b\u4f18\u5316\u200b\u5b9a\u65f6\u200b\u76d1\u63a7\u200b\u7c7b\u200b\u529f\u80fd\u200b\uff0c\u200b\u5f15\u5165\u200b Semaphre \uff0c\u200b\u652f\u6301\u200b\u79c1\u804a\u200b\u4e0e\u200b\u7fa4\u804a\u200b\u540c\u65f6\u200b\u5f00\u542f\u200b</li> <li>\u200b\u4f18\u5316\u200b utils \u200b\u4e2d\u200b\u91d1\u5e01\u200b\u64cd\u4f5c\u200b\u7684\u200b API \u200b\u7684\u200b\u5b9e\u73b0\u200b\u903b\u8f91\u200b</li> <li>\u200b\u4fee\u590d\u200b\u201c\u200b\u4fc4\u7f57\u65af\u200b\u51b3\u6597\u200b\u201d\u200b\u529f\u80fd\u200b\u4e2d\u200b\uff0c\u200b\u54cd\u5e94\u200b\u8d85\u65f6\u200b\u8ba1\u6570\u5668\u200b\u5931\u6548\u200b\u7b49\u200b\u591a\u4e2a\u200b\u95ee\u9898\u200b</li> <li>\u200b\u4fee\u590d\u200b responseImage \u200b\u5e93\u4e2d\u200b\u5b57\u4f53\u200b\u663e\u793a\u200b\u9519\u8bef\u200b\u7684\u200b\u95ee\u9898\u200b</li> <li>\u200b\u4fee\u590d\u200b\u4e86\u200b\u82e5\u5e72\u200b\u5176\u4ed6\u200b\u5df2\u77e5\u200b\u95ee\u9898\u200b</li> </ol>"},{"location":"update-plan/#102-20221030","title":"1.0.2 - 2022/10/30","text":"<ol> <li>\u200b\u91cd\u5199\u200b\u4e86\u200bfaq\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u652f\u6301\u200b\u95ee\u9898\u200b\u5217\u8868\u200b\u56fe\u50cf\u200b\u5316\u200b</li> <li>\u200b\u65b0\u589e\u200b\u201c\u200b\u4e00\u4ef6\u200b\u9000\u5b66\u200b\u201d\u200b\u63d2\u4ef6\u200b</li> <li>\u200b\u65b0\u589e\u200b\u201c\u200b\u7fa4\u200b\u6587\u4ef6\u200b\u8bb0\u5f55\u200b\u201d\u200b\u63d2\u4ef6\u200b</li> <li>\u200b\u4f18\u5316\u200b\u90e8\u5206\u200b\u903b\u8f91\u200b</li> </ol>"},{"location":"update-plan/#101-20221022","title":"1.0.1 - 2022/10/22","text":"<ul> <li>\u200b\u4f18\u5316\u200b\u6559\u52a1\u200b\u901a\u77e5\u200b\u63d2\u4ef6\u200b\u7684\u200b Url \u200b\u5904\u7406\u200b\u903b\u8f91\u200b</li> <li>\u200b\u4f18\u5316\u200b responseImage \u200b\u5e93\u53cc\u680f\u200b\u7684\u200b\u6392\u5217\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u4fee\u590d\u200b\u63d2\u56fe\u200b\u5c3a\u5bf8\u200b\u9519\u8bef\u200b\u7684\u200b bug</li> <li>\u200b\u589e\u52a0\u200b\u8fdb\u5ea6\u6761\u200b\u6837\u5f0f\u200b</li> <li>\u200b\u5f03\u7528\u200b\u8fc7\u671f\u200b API</li> </ul>"},{"location":"update-plan/#100-20221014","title":"1.0.0 2022/10/14","text":"<ul> <li>\u200b\u7b2c\u4e00\u7248\u200b</li> </ul>"},{"location":"api/account-operation/","title":"\u91d1\u5e01\u200b\u7cfb\u7edf","text":""},{"location":"api/account-operation/#_1","title":"\u7b80\u4ecb","text":"<p>\u200b\u7531\u4e8e\u200b bot \u200b\u7684\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u9700\u8981\u200b\u6784\u5efa\u200b\u4e00\u5957\u200b\u5956\u52b1\u200b\u673a\u5236\u200b\uff0c\u200b\u56e0\u6b64\u200b\u6211\u4eec\u200b\u8003\u8651\u200b\u5f15\u5165\u200b\u91d1\u5e01\u200b\u7cfb\u7edf\u200b\uff0c\u200b\u56e0\u6b64\u200b\u5199\u200b\u4e86\u200b\u4e00\u6574\u5957\u200b API \u200b\u8c28\u4f9b\u200b\u63d2\u4ef6\u200b\u7a0b\u5e8f\u5458\u200b\u4f7f\u7528\u200b\u3002</p> <p><code>1.0.0</code> \u200b\u7248\u672c\u200b\u7684\u200b\u91d1\u5e01\u200b\u7cfb\u7edf\u200b\u6709\u200b\u4ee5\u4e0b\u200b\u51e0\u4e2a\u200b\u51fd\u6570\u200b\u548c\u200b\u529f\u80fd\u200b\uff1a</p> \u200b\u51fd\u6570\u200b\u540d\u200b \u200b\u529f\u80fd\u200b create_account_sql \u200b\u521b\u5efa\u200b\u91d1\u5e01\u200b\u7cfb\u7edf\u200b\u7684\u200b sql get_user_coins \u200b\u67e5\u8be2\u200b\u7528\u6237\u200b\u91d1\u5e01\u200b update_user_coins \u200b\u66f4\u65b0\u200b\u7528\u6237\u200b\u91d1\u5e01\u200b get_user_transactions \u200b\u67e5\u8be2\u200b\u7528\u6237\u200b\u6d88\u8d39\u200b\u8bb0\u5f55\u200b <p>\u200b\u8be6\u7ec6\u200b\u4f7f\u7528\u200b\u65b9\u6cd5\u200b\u53ef\u200b\u53c2\u8003\u200b\u4e0b\u9762\u200b\u7684\u200b\u4ee3\u7801\u200b\uff1a</p>"},{"location":"api/account-operation/#_2","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>from utils.basicEvent import warning\nimport mysql.connector\nfrom datetime import datetime\nfrom utils.basicConfigs import sqlConfig\nfrom pymysql.converters import escape_string\nfrom typing import Union\n'''\nBOT_DATA.accounts \u200b\u8d26\u6237\u200b\n+----------+------------------+------+-----+---------+-------+\n| Field    | Type             | Null | Key | Default | Extra |\n+----------+------------------+------+-----+---------+-------+\n| id       | bigint           | NO   | PRI | NULL    |       |\n| coin     | bigint           | YES  |     | NULL    |       |\n| lastSign | date             | YES  |     | NULL    |       |\n| fortune  | tinyint unsigned | YES  |     | NULL    |       |\n+----------+------------------+------+-----+---------+-------+\nBOT_DATA.transactions \u200b\u4ea4\u6613\u200b\u8bb0\u5f55\u200b\n+-------------+-----------------+------+-----+---------+----------------+\n| Field       | Type            | Null | Key | Default | Extra          |\n+-------------+-----------------+------+-----+---------+----------------+\n| seq         | bigint unsigned | NO   | PRI | NULL    | auto_increment |\n| timestp     | timestamp       | YES  |     | NULL    |                |\n| qq          | bigint          | YES  |     | NULL    |                |\n| changes     | bigint          | YES  |     | NULL    |                |\n| balance     | bigint          | YES  |     | NULL    |                |\n| description | varchar(255)    | YES  |     | NULL    |                |\n+-------------+-----------------+------+-----+---------+----------------+\n'''\ndef create_account_sql():\n\"\"\"\u200b\u521b\u5efa\u200b\u91d1\u5e01\u200b\u7cfb\u7edf\u200bsql\u200b\u7684\u200b\u51fd\u6570\u200b\"\"\"\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\nmycursor.execute(\"\"\"\n            create table if not exists `BOT_DATA`.`accounts` (\n                `id` bigint not null,\n                `coin` bigint,\n                `lastSign` date,\n                `fortune` tinyint unsigned,\n                primary key (`id`)\n            );\n        \"\"\")\nmycursor.execute(\"\"\"\n            create table if not exists `BOT_DATA`.`transactions` (\n                `seq` bigint unsigned not null auto_increment,\n                `timestp` timestamp,\n                `qq` bigint,\n                `changes` bigint,\n                `balance` bigint,\n                `description` varchar(255),\n                primary key (`seq`)\n            );\"\"\")\nexcept mysql.connector.Error as e:\nwarning(\"mysql error in create_account_sql: {}\".format(e))\nexcept BaseException as e:\nwarning(\"error in create_account_sql: {}\".format(e))\ndef get_user_coins(id:int, format=True):\n\"\"\"\u200b\u67e5\u8be2\u200b\u7528\u6237\u200b\u91d1\u5e01\u200b\u7684\u200b\u51fd\u6570\u200b\n    @id:     \u200b\u7528\u6237\u200bQQ\u200b\u53f7\u200b\n    @format: \u200b\u662f\u5426\u200b\u5bf9\u200bresult/100\u200b\u5904\u7406\u200b (\u200b\u9ed8\u8ba4\u200b\u4e3a\u200btrue, \u200b\u8868\u793a\u200b\u8f93\u51fa\u200b\u4e3a\u200b\u5904\u7406\u200b\u540e\u503c\u200b, \u200b\u4e3a\u200b\u5c0f\u6570\u200b\u4e14\u200b\u7cbe\u786e\u200b\u5230\u200b\u5206\u200b)\n    @return:\n        if format: \u200b\u8fd4\u56de\u200b0.01\u200b\u6574\u6570\u500d\u200b\u7684\u200bfloat, \u200b\u5355\u4f4d\u200b\u662f\u200b\u5143\u200b\n        else:      \u200b\u8fd4\u56de\u200bint, \u200b\u5355\u4f4d\u200b\u662f\u200b\u5206\u200b\n    \"\"\"\nif isinstance(id, str):\ntry:\nid = int(id)\nexcept BaseException as e:\nwarning(\"meet exception in get_user_coins: id should be int, but got {}\".format(id))\nreturn \ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\nmycursor.execute(\"SELECT coin FROM `BOT_DATA`.`accounts` where id=%d\"%id)\nresult=list(mycursor)\nif len(result)==0:\nmycursor.execute(\n\"INSERT INTO `BOT_DATA`.`accounts` (id, coin, lastSign) VALUES (%d, '0', '1980-01-01')\"%id)\nreturn 0\nelse:\nreturn int(result[0][0])/(100 if format else 1)\nexcept mysql.connector.Error as e:\nwarning(\"mysql error in get_user_coins: {}\".format(e))\nexcept BaseException as e:\nwarning(\"error in get_user_coins: {}\".format(e))\nreturn 0\ndef update_user_coins(id:int, append: Union[int, float], description:str, format:bool=True)-&gt;bool:\n\"\"\"\u200b\u66f4\u65b0\u200b\u7528\u6237\u200b\u91d1\u5e01\u200b\u7684\u200b\u51fd\u6570\u200b\n    @id: \u200b\u7528\u6237\u200b\u53f7\u7801\u200b, \u200b\u5fc5\u987b\u200b\u4e3a\u200bint\n    @append: \n        \u200b\u589e\u52a0\u200b\u91d1\u5e01\u200b\u6570\u91cf\u200b\n        if format: \u200b\u5355\u4f4d\u200b\u662f\u200b\u5143\u200b\n        else:      \u200b\u5355\u4f4d\u200b\u662f\u200b\u5206\u200b\n    @format:\n        \u200b\u662f\u5426\u200b\u5bf9\u200bappend x 100\u200b\u5904\u7406\u200b (\u200b\u9ed8\u8ba4\u200b\u4e3a\u200bTrue, \u200b\u8868\u793a\u200b\u8f93\u5165\u200b\u4e3a\u200b\u539f\u59cb\u200b\u91d1\u200b\u5e01\u503c\u200b, \u200b\u4e3a\u200b\u5c0f\u6570\u200b\u4e14\u200b\u7cbe\u786e\u200b\u5230\u200b\u5206\u200b)\n    @description:\n        \u200b\u6539\u53d8\u200b\u539f\u56e0\u200b\u63cf\u8ff0\u200b\n    @return: \u200b\u662f\u5426\u200b\u66f4\u6539\u200b\u6210\u529f\u200b\n    \"\"\"\nif isinstance(id, str):\ntry:\nid = int(id)\nexcept BaseException as e:\nwarning(\"meet exception in update_user_coins: id should be int, but got {}\".format(id))\nreturn False\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\nmycursor.execute(\"SELECT coin FROM BOT_DATA.accounts where id=%d\"%id)\nexcept mysql.connector.Error as e:\nwarning(\"sql error in update_user_coins: {}\".format(e))\nreturn False\nresult=list(mycursor)\nnum_append=int((append)*(100 if format else 1))\nif len(result)==0:\ntry:\nmycursor.execute(\"\"\"INSERT INTO BOT_DATA.accounts (id, coin, lastSign)\n                VALUES (%d, %d, '1980-01-01');\"\"\"%(id, num_append))\nreturn True\nexcept mysql.connector.errors.DatabaseError as e:\nwarning(\"sql error in update_user_coins: {}\".format(e))\nreturn False\nelse:\ntry:\nresult=int(result[0][0])\nmycursor.execute(\"\"\"UPDATE BOT_DATA.accounts SET coin=%d\n                 WHERE id=%d;\"\"\"%(result+num_append, id))\nnow = datetime.now()\nnow = now.strftime(\"%Y-%m-%d %H:%M:%S\")\nmycursor.execute(\"\"\"\n                INSERT INTO BOT_DATA.transactions (timestp, qq, changes, balance, description)\n                VALUES ('%s', %d, %d, %d, '%s');\n                \"\"\"%(escape_string(now), id, num_append, result+num_append, escape_string(description)))\nreturn True\nexcept mysql.connector.errors.DatabaseError as e:\nwarning(\"sql error in update_user_coins: {}\".format(e))\nreturn False # \u200b\u66f4\u65b0\u200b\u5931\u8d25\u200b\ndef get_user_transactions(id: int)-&gt;list:\n\"\"\"\u200b\u67e5\u8be2\u200b\u7528\u6237\u200b\u6d88\u8d39\u200b\u8bb0\u5f55\u200b\u51fd\u6570\u200b\n    @id: \u200b\u7528\u6237\u200bQQ\n    @return: \u200b\u7528\u6237\u200b\u6d88\u8d39\u200b\u8bb0\u5f55\u200b\n    \"\"\"\nif isinstance(id, str):\ntry:\nid = int(id)\nexcept BaseException as e:\nwarning(\"meet exception in get_user_transactions: id should be int, but got {}\".format(id))\nreturn []\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"SELECT * FROM BOT_DATA.transactions where qq=%d ORDER BY `seq` desc limit 20;\"%id)\nresult=list(mycursor)\nreturn result\nexcept mysql.connector.Error as e:\nwarning(\"sql error in get_user_transactions: {}\".format(e))\nreturn []\n</code></pre>"},{"location":"api/account-operation/#_3","title":"\u5e94\u7528\u200b\u573a\u666f","text":"<ol> <li> <p>\u200b\u8f6e\u76d8\u200b\u8d4c\u200b</p> <p></p> </li> <li> <p>\u200b\u6d88\u8d39\u200b\u8bb0\u5f55\u200b\u67e5\u8be2\u200b</p> <p></p> </li> </ol>"},{"location":"api/auth-config/","title":"\u9274\u6743\u200b\u4e0e\u200b\u63d2\u4ef6\u200b\u914d\u7f6e","text":""},{"location":"api/auth-config/#_1","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>def createGlobalConfig():\n\"\"\"\u200b\u521b\u5efa\u200bglobal config\u200b\u7684\u200bsql table\"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmydb.autocommit = True\nmycursor.execute(\"\"\"\n    create table if not exists `BOT_DATA`.`globalConfig` (\n        `groupId` bigint not null,\n        `groupConfig` json,\n        `groupAdmins` json,\n        primary key (`groupId`)\n    );\"\"\")\ndef readGlobalConfig(groupId: Union[None, int], pluginName: str)-&gt;Union[dict, Any, None]:\n\"\"\"\u200b\u8bfb\u200bglobal config\n    @groupId\n        if None, then read add groups config\n        elif int, read the specific group config\n        else: warning\n    @pluginName\n        like 'test1.enable' or 'test1'\n    \"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\npluginName = escape_string(pluginName)\nif groupId == None:\nresult = {}\ntry:\nmycursor.execute(\"SELECT groupId, json_extract(groupConfig,'$.%s') from BOT_DATA.globalConfig\"%pluginName)\nexcept mysql.connector.Error as e:\nwarning(\"error in readGlobalConfig: {}\".format(e))\nreturn None\nfor grpId, groupConfig in list(mycursor):\nif groupConfig != None:\nresult[grpId] = json.loads(groupConfig)\nreturn result\nelif isinstance(groupId, int):\nresult = {}\ntry:\nmycursor.execute(\"SELECT groupId, json_extract(groupConfig, '$.%s') from BOT_DATA.globalConfig where groupId = %d\"%(pluginName, groupId))\nexcept mysql.connector.Error as e:\nwarning(\"error in readGlobalConfig: {}\".format(e))\nreturn None\nfor grpId, groupConfig in list(mycursor):\nif groupConfig != None:\nresult[grpId] = json.loads(groupConfig)\nif len(result) == 0:\nreturn None\nelse:\nreturn result[groupId]\nelse:\nwarning(\"unknow groupId type in readGlobalConfig: groupId = {}\".format(groupId))\nreturn None\n# update BOT_DATA.test set groupConfig=json_set(groupConfig, '$.test1.enable', False) where groupId=1234;\ndef writeGlobalConfig(groupId: Union[None, int], pluginName: str, value: Any):\n\"\"\"\u200b\u5199\u200bglobal config\n    @groupId\n        if None, then read all groups' config\n        elif int, read the specific group config\n        else: warning\n    @pluginName\n        like 'test1.enable' or 'test1'\n    @value\n    \"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\npluginName = escape_string(pluginName)\nif groupId == None:\ntry:\nmycursor.execute(\"update BOT_DATA.globalConfig set groupConfig=json_set(groupConfig, '$.%s', cast('%s' as json))\"%(pluginName, json.dumps(value)))\nexcept mysql.connector.Error as e:\nwarning(\"error in writeGlobalConfig: {}\".format(e))\nelif isinstance(groupId, int):\ntry:\nmycursor.execute(\"insert ignore into BOT_DATA.globalConfig(groupId, groupConfig, groupAdmins) values (%d, '{}', '[]')\"%groupId)\nmycursor.execute(\"update BOT_DATA.globalConfig set groupConfig=json_set(groupConfig, '$.%s', cast('%s' as json)) where groupId=%d\"%(pluginName, json.dumps(value), groupId))\nexcept mysql.connector.Error as e:\nwarning(\"error in writeGlobalConfig: {}\".format(e))\nelse:\nwarning(\"unknow groupId type in writeGlobalConfig: groupId = {}\".format(groupId))\nmydb.commit()\ndef getGroupAdmins(groupId: int)-&gt;List[int]:\n\"\"\"\u200b\u83b7\u53d6\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u5217\u8868\u200b\n    @groupId: \u200b\u7fa4\u53f7\u200b\n    @return:  \u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200bQQ\u200b\u53f7\u200b\u5217\u8868\u200b\n    \"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"select groupAdmins from BOT_DATA.globalConfig where groupId = %s\"%(groupId))\nresult = list(mycursor)\nif len(result) &lt;= 0:\nmycursor.execute(\"insert ignore into BOT_DATA.globalConfig(groupId, groupConfig, groupAdmins) values (%d, '{}', '[]')\"%groupId)\nmydb.commit()\nreturn []\nelse:\nresult = json.loads(result[0][0])\nif not isinstance(result, list) or any([not isinstance(x, int) for x in result]):\nwarning('error admin type, groupId = %d'%groupId)\nreturn []\nreturn result\nexcept mysql.connector.Error as e:\nwarning(\"error in getGroupAdmins: {}\".format(e))\nreturn []\ndef addGroupAdmin(groupId: int, adminId: int):\n\"\"\"\u200b\u6dfb\u52a0\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\n    @groupId: \u200b\u7fa4\u53f7\u200b\n    @adminId: \u200b\u65b0\u200b\u6dfb\u52a0\u200b\u7684\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200bQQ\u200b\u53f7\u200b\n    \"\"\"\nif not isinstance(groupId, int) or not isinstance(adminId, int):\nwarning(\"error groupId type or adminId type in addGroupAdmin: groupId = {}, adminId = {}\".format(groupId, adminId))\nreturn\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"insert ignore into BOT_DATA.globalConfig(groupId, groupConfig, groupAdmins) values (%d, '{}', '[]')\"%groupId)\nmycursor.execute(\"update BOT_DATA.globalConfig set groupAdmins=json_array_append(groupAdmins,'$', %d) where groupId=%d;\"%(adminId, groupId))\nmydb.commit()\nexcept mysql.connector.Error as e:\nwarning(\"error in addGroupAdmin: {}\".format(e))\ndef setGroupAdmin(groupId: int, adminIds: List[int]):\n\"\"\"\u200b\u8bbe\u7f6e\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u4e3a\u200b\u67d0\u4e2a\u200blist\n    @groupId: \u200b\u7fa4\u53f7\u200b\n    @adminIds: \u200b\u66f4\u6539\u200b\u540e\u200b\u7684\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200bQQ\u200b\u53f7\u200b\u5217\u8868\u200b\n    \"\"\"\nif not isinstance(adminIds, list) or any([not isinstance(x, int) for x in adminIds]):\nwarning('error admin type, groupId = %d'%groupId)\nreturn\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"insert ignore into BOT_DATA.globalConfig(groupId, groupConfig, groupAdmins) values (%d, '{}', '[]')\"%groupId)\nmycursor.execute(\"update BOT_DATA.globalConfig set groupAdmins='%s' where groupId=%d;\"%(json.dumps(adminIds), groupId))\nmydb.commit()\nexcept mysql.connector.Error as e:\nwarning(\"error in setGroupAdmin: {}\".format(e))\ndef delGroupAdmin(groupId: int, adminId: int):\n\"\"\"\u200b\u5220\u9664\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200b\n    @groupId: \u200b\u7fa4\u53f7\u200b\n    @adminId: \u200b\u8981\u200b\u5220\u9664\u200b\u7684\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200bQQ\u200b\u53f7\u200b\n    \"\"\"\nif not isinstance(groupId, int) or not isinstance(adminId, int):\nwarning(\"error groupId type or adminId type in delGroupAdmin: groupId = {}, adminId = {}\".format(groupId, adminId))\nreturn\ngroupAdmins = getGroupAdmins(groupId)\nif groupAdmins == None:\nwarning(\"groupAdmins is None at delGroupAdmin\")\nreturn\ngroupAdmins = set(groupAdmins)\nif adminId not in groupAdmins:\nwarning(\"id = '%d' not in admins at delGroupAdmin\"%adminId)\nreturn\ngroupAdmins.remove(adminId)\nsetGroupAdmin(groupId, list(groupAdmins))\n</code></pre>"},{"location":"api/botAdminApi/","title":"bot \u200b\u7ba1\u7406\u200b API","text":""},{"location":"api/botAdminApi/#1","title":"1. \u200b\u4ecb\u7ecd","text":"\u51fd\u6570\u200b\u540d\u200b \u200b\u53c2\u6570\u200b \u200b\u8fd4\u56de\u503c\u200b \u200b\u529f\u80fd\u200b \u200b\u4ee3\u7801\u200b\u4f4d\u7f6e\u200b createGlobalConfig - <code>None</code> \u200b\u521b\u5efa\u200b\u7528\u4e8e\u200b\u8bb0\u5f55\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u548c\u200b\u63d2\u4ef6\u200b\u5f00\u5173\u200b\u60c5\u51b5\u200b\u7684\u200bsql\u200b\u8868\u200b <code>utils.basicEvent</code> readGlobalConfig <code>@groupId</code>: \u200b\u7fa4\u53f7\u200b, <code>int</code>\u200b\u6216\u200b<code>None</code>\u200b\u7c7b\u578b\u200b<code>@pluginName</code>: \u200b\u63d2\u4ef6\u200b\u540d\u79f0\u200b, <code>str</code>\u200b\u7c7b\u578b\u200b config\u200b\u503c\u200b, <code>Union[dict,Any,None]</code>\u200b\u7c7b\u578b\u200b \u200b\u8bfb\u53d6\u200b<code>BOT_DATA.globalConfig</code>:\u200b\u5982\u679c\u200b<code>@groupId</code>\u200b\u662f\u200b<code>None</code>, \u200b\u90a3\u4e48\u200b\u8bfb\u53d6\u200b\u6240\u6709\u200b\u7fa4\u200b\u7684\u200bconfig, \u200b\u5e76\u200b\u8fd4\u56de\u200b<code>Dict[\u200b\u7fa4\u53f7\u200b, config]</code>\u200b\u5982\u679c\u200b<code>@groupId</code>\u200b\u662f\u200b<code>int</code>, \u200b\u90a3\u4e48\u200b\u8bfb\u53d6\u200b\u5bf9\u5e94\u200b\u7fa4\u200b\u7684\u200bconfig, \u200b\u5e76\u200b\u8fd4\u56de\u200b<code>Any</code>\u200b\u5176\u4f59\u200b\u60c5\u51b5\u200bwarning\u200b\u5e76\u200b\u8fd4\u56de\u200b<code>None</code> <code>utils.basicEvent</code> writeGlobalConfig <code>@groupId</code>: \u200b\u7fa4\u53f7\u200b, <code>int</code>\u200b\u6216\u200b<code>None</code>\u200b\u7c7b\u578b\u200b<code>@pluginName</code>: \u200b\u63d2\u4ef6\u200b\u540d\u79f0\u200b, <code>str</code>\u200b\u7c7b\u578b\u200b<code>@value</code>: \u200b\u8981\u200b\u5199\u5165\u200b\u7684\u200b\u503c\u200b, \u200b\u53ef\u200bjson\u200b\u5316\u200b\u7684\u200b<code>Any</code>\u200b\u7c7b\u578b\u200b <code>None</code> \u200b\u5199\u5165\u200b<code>BOT_DATA.globalConfig</code>:\u200b\u5982\u679c\u200b<code>@groupId</code>\u200b\u662f\u200b<code>None</code>, \u200b\u90a3\u4e48\u200b\u5199\u200b\u6240\u6709\u200b\u7fa4\u200b\u7684\u200bconfig\u200b\u5982\u679c\u200b<code>@groupId</code>\u200b\u662f\u200b<code>int</code>, \u200b\u90a3\u4e48\u200b\u5199\u200b\u5bf9\u5e94\u200b\u7fa4\u200b\u7684\u200bconfig\u200b\u5176\u4f59\u200b\u60c5\u51b5\u200bwarning <code>utils.basicEvent</code> getPluginEnabledGroups <code>@pluginName</code>: \u200b\u63d2\u4ef6\u200b\u540d\u79f0\u200b, <code>str</code>\u200b\u7c7b\u578b\u200b \u200b\u5f00\u542f\u200b\u63d2\u4ef6\u200b\u7684\u200b\u7fa4\u200b\u5217\u8868\u200b, <code>List[int]</code>\u200b\u7c7b\u578b\u200b \u200b\u83b7\u53d6\u200b\u5f00\u542f\u200b\u63d2\u4ef6\u200b\u7684\u200b\u7fa4\u804a\u200bid\u200b\u5217\u8868\u200b <code>utils.basicEvent</code> getGroupAdmins <code>@groupId</code>: \u200b\u7fa4\u53f7\u200b, <code>int</code>\u200b\u7c7b\u578b\u200b \u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u7684\u200bqq\u200b\u53f7\u200b\u5217\u8868\u200b, <code>List[int]</code>\u200b\u7c7b\u578b\u200b \u200b\u83b7\u53d6\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u5217\u8868\u200b <code>utils.basicEvent</code> addGroupAdmin <code>@groupId</code>: \u200b\u7fa4\u53f7\u200b, <code>int</code>\u200b\u7c7b\u578b\u200b<code>@adminId</code>: \u200b\u5f85\u200b\u6dfb\u52a0\u200b\u7684\u200bqq\u200b\u53f7\u200b, <code>int</code>\u200b\u7c7b\u578b\u200b <code>None</code> \u200b\u628a\u200b\u67d0\u4e2a\u200bqq\u200b\u6dfb\u52a0\u200b\u5230\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b <code>utils.basicEvent</code> setGroupAdmin <code>@groupId</code>: \u200b\u7fa4\u53f7\u200b, <code>int</code>\u200b\u7c7b\u578b\u200b<code>@adminIds</code>: \u200b\u8bbe\u5b9a\u200b\u7684\u200bqq\u200b\u53f7\u200b\u5217\u8868\u200b, <code>List[int]</code>\u200b\u7c7b\u578b\u200b \u200b\u8bbe\u7f6e\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u5217\u8868\u200b\u8bbe\u200b\u4e3a\u200b\u7ed9\u5b9a\u200blist <code>utils.basicEvent</code> delGroupAdmin <code>@groupId</code>: \u200b\u7fa4\u53f7\u200b, <code>int</code>\u200b\u7c7b\u578b\u200b<code>@adminId</code>: \u200b\u5f85\u200b\u5220\u9664\u200b\u7684\u200bqq\u200b\u53f7\u200b, <code>int</code>\u200b\u7c7b\u578b\u200b <code>None</code> \u200b\u628a\u200b\u67d0\u200bqq\u200b\u53f7\u200b\u4ece\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u5217\u8868\u200b\u4e2d\u200b\u5220\u9664\u200b <code>utils.basicEvent</code>"},{"location":"api/botAdminApi/#2","title":"2. \u200b\u6837\u4f8b\u200b\u5206\u6790","text":"<pre><code># 1. \u200b\u521d\u59cb\u5316\u200b\u503c\u200b\ngroupId = 12345\n# 2. \u200b\u628a\u200b\u7fa4\u200bgroupId\u200b\u7684\u200bsuperemoji\u200b\u63d2\u4ef6\u200b\u6253\u5f00\u200b\nwriteGlobalConfig(groupId, 'superemoji.enable', True)\n</code></pre>"},{"location":"api/botAdminApi/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>utils.basicEvent</code></p> <pre><code>def createGlobalConfig():\n\"\"\"\u200b\u521b\u5efa\u200bglobal config\u200b\u7684\u200bsql table, \u200b\u79fb\u9664\u200b\u4e0d\u200b\u5728\u200bAPPLY_GROUP_ID\u200b\u4e2d\u200b\u7684\u200b\u7fa4\u53f7\u200b\"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmydb.autocommit = True\nmycursor.execute(\"\"\"\n    create database if not exists `BOT_DATA`\n    \"\"\")\nmycursor.execute(\"\"\"\n    create table if not exists `BOT_DATA`.`globalConfig` (\n        `groupId` bigint not null,\n        `groupConfig` json,\n        `groupAdmins` json,\n        primary key (`groupId`)\n    );\"\"\")\nmycursor.execute(\"select groupId from BOT_DATA.globalConfig\")\ngroupNeedToBeRemoved = set([x for x, in list(mycursor)]) - set(APPLY_GROUP_ID)\nfor groupId in groupNeedToBeRemoved:\nmycursor.execute(\"delete from BOT_DATA.globalConfig where groupId = %d\"%groupId)\ndef readGlobalConfig(groupId: Union[None, int], pluginName: str)-&gt;Union[dict, Any, None]:\n\"\"\"\u200b\u8bfb\u200bglobal config\n    @groupId\n        if None, then read add groups config\n        elif int, read the specific group config\n        else: warning\n    @pluginName\n        like 'test1.enable' or 'test1'\n    \"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\npluginName = escape_string(pluginName)\nif groupId == None:\nresult = {}\ntry:\nmycursor.execute(\"SELECT groupId, json_extract(groupConfig,'$.%s') from BOT_DATA.globalConfig\"%pluginName)\nexcept mysql.connector.Error as e:\nwarning(\"error in readGlobalConfig: {}\".format(e))\nreturn None\nfor grpId, groupConfig in list(mycursor):\nif groupConfig != None:\nresult[grpId] = json.loads(groupConfig)\nreturn result\nelif isinstance(groupId, int):\nresult = {}\ntry:\nmycursor.execute(\"SELECT groupId, json_extract(groupConfig, '$.%s') from BOT_DATA.globalConfig where groupId = %d\"%(pluginName, groupId))\nexcept mysql.connector.Error as e:\nwarning(\"error in readGlobalConfig: {}\".format(e))\nreturn None\nfor grpId, groupConfig in list(mycursor):\nif groupConfig != None:\nresult[grpId] = json.loads(groupConfig)\nif len(result) == 0:\nreturn None\nelse:\nreturn result[groupId]\nelse:\nwarning(\"unknow groupId type in readGlobalConfig: groupId = {}\".format(groupId))\nreturn None\n# update BOT_DATA.test set groupConfig=json_set(groupConfig, '$.test1.enable', False) where groupId=1234;\ndef writeGlobalConfig(groupId: Union[None, int], pluginName: str, value: Any):\n\"\"\"\u200b\u5199\u200bglobal config\n    @groupId\n        if None, then write all groups' config\n        elif int, write the specific group config\n        else: warning\n    @pluginName\n        like 'test1.enable' or 'test1'\n    @value\n    \"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\npluginName = escape_string(pluginName)\nif groupId == None:\ntry:\nmycursor.execute(\"update BOT_DATA.globalConfig set groupConfig=json_set(groupConfig, '$.%s', cast('%s' as json))\"%(pluginName, json.dumps(value)))\nexcept mysql.connector.Error as e:\nwarning(\"error in writeGlobalConfig: {}\".format(e))\nelif isinstance(groupId, int):\ntry:\nmycursor.execute(\"insert ignore into BOT_DATA.globalConfig(groupId, groupConfig, groupAdmins) values (%d, '{}', '[]')\"%groupId)\nmycursor.execute(\"update BOT_DATA.globalConfig set groupConfig=json_set(groupConfig, '$.%s', cast('%s' as json)) where groupId=%d\"%(pluginName, json.dumps(value), groupId))\nexcept mysql.connector.Error as e:\nwarning(\"mysql error in writeGlobalConfig: {}\".format(e))\nelse:\nwarning(\"unknow groupId type in writeGlobalConfig: groupId = {}\".format(groupId))\nmydb.commit()\ndef getPluginEnabledGroups(pluginName: str)-&gt;List[int]:\n\"\"\"\u200b\u83b7\u53d6\u200b\u5f00\u542f\u200b\u63d2\u4ef6\u200b\u7684\u200b\u7fa4\u804a\u200bid\u200b\u5217\u8868\u200b\n    @pluginName: \u200b\u88ab\u200bpluginGroupManager\u200b\u7ba1\u7406\u200b\u7684\u200b\u63d2\u4ef6\u200b\u7ec4\u200b\u540d\u79f0\u200b\n        eg: \"faq\", \"superemoji\"\n    @return: \u200b\u5f00\u542f\u200b\u63d2\u4ef6\u200b\u7684\u200b\u7fa4\u200bid\u200b\u5217\u8868\u200b\n    \"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\npluginName = escape_string(pluginName)\ntry:\nmycursor.execute(\"select groupId from BOT_DATA.globalConfig \\\n            where json_extract(groupConfig, '$.%s.enable') = true\"%escape_string(pluginName))\nreturn [x[0] for x in list(mycursor)]\nexcept mysql.connector.Error as e:\nwarning(\"mysql error in getPluginEnabledGroups: {}\".format(e))\ndef getGroupAdmins(groupId: int)-&gt;List[int]:\n\"\"\"\u200b\u83b7\u53d6\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u5217\u8868\u200b\n    @groupId: \u200b\u7fa4\u53f7\u200b\n    @return:  \u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200bQQ\u200b\u53f7\u200b\u5217\u8868\u200b\n    \"\"\"\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"select groupAdmins from BOT_DATA.globalConfig where groupId = %s\"%(groupId))\nresult = list(mycursor)\nif len(result) &lt;= 0:\nmycursor.execute(\"insert ignore into BOT_DATA.globalConfig(groupId, groupConfig, groupAdmins) values (%d, '{}', '[]')\"%groupId)\nmydb.commit()\nreturn []\nelse:\nresult = json.loads(result[0][0])\nif not isinstance(result, list) or any([not isinstance(x, int) for x in result]):\nwarning('error admin type, groupId = %d'%groupId)\nreturn []\nreturn result\nexcept mysql.connector.Error as e:\nwarning(\"error in getGroupAdmins: {}\".format(e))\nreturn []\ndef addGroupAdmin(groupId: int, adminId: int):\n\"\"\"\u200b\u6dfb\u52a0\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\n    @groupId: \u200b\u7fa4\u53f7\u200b\n    @adminId: \u200b\u65b0\u200b\u6dfb\u52a0\u200b\u7684\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200bQQ\u200b\u53f7\u200b\n    \"\"\"\nif not isinstance(groupId, int) or not isinstance(adminId, int):\nwarning(\"error groupId type or adminId type in addGroupAdmin: groupId = {}, adminId = {}\".format(groupId, adminId))\nreturn\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"insert ignore into BOT_DATA.globalConfig(groupId, groupConfig, groupAdmins) values (%d, '{}', '[]')\"%groupId)\nmycursor.execute(\"update BOT_DATA.globalConfig set groupAdmins=json_array_append(groupAdmins,'$', %d) where groupId=%d;\"%(adminId, groupId))\nmydb.commit()\nexcept mysql.connector.Error as e:\nwarning(\"error in addGroupAdmin: {}\".format(e))\ndef setGroupAdmin(groupId: int, adminIds: List[int]):\n\"\"\"\u200b\u8bbe\u7f6e\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b\u4e3a\u200b\u67d0\u4e2a\u200blist\n    @groupId: \u200b\u7fa4\u53f7\u200b\n    @adminIds: \u200b\u66f4\u6539\u200b\u540e\u200b\u7684\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200bQQ\u200b\u53f7\u200b\u5217\u8868\u200b\n    \"\"\"\nif not isinstance(adminIds, list) or any([not isinstance(x, int) for x in adminIds]):\nwarning('error admin type, groupId = %d'%groupId)\nreturn\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"insert ignore into BOT_DATA.globalConfig(groupId, groupConfig, groupAdmins) values (%d, '{}', '[]')\"%groupId)\nmycursor.execute(\"update BOT_DATA.globalConfig set groupAdmins='%s' where groupId=%d;\"%(json.dumps(adminIds), groupId))\nmydb.commit()\nexcept mysql.connector.Error as e:\nwarning(\"error in setGroupAdmin: {}\".format(e))\ndef delGroupAdmin(groupId: int, adminId: int):\n\"\"\"\u200b\u5220\u9664\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200b\n    @groupId: \u200b\u7fa4\u53f7\u200b\n    @adminId: \u200b\u8981\u200b\u5220\u9664\u200b\u7684\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200bQQ\u200b\u53f7\u200b\n    \"\"\"\nif not isinstance(groupId, int) or not isinstance(adminId, int):\nwarning(\"error groupId type or adminId type in delGroupAdmin: groupId = {}, adminId = {}\".format(groupId, adminId))\nreturn\ngroupAdmins = getGroupAdmins(groupId)\nif groupAdmins == None:\nwarning(\"groupAdmins is None at delGroupAdmin\")\nreturn\ngroupAdmins = set(groupAdmins)\nif adminId not in groupAdmins:\nwarning(\"id = '%d' not in admins at delGroupAdmin\"%adminId)\nreturn\ngroupAdmins.remove(adminId)\nsetGroupAdmin(groupId, list(groupAdmins))\n</code></pre>"},{"location":"api/bufferQueue/","title":"\u7f13\u51b2\u200b\u961f\u5217","text":""},{"location":"api/bufferQueue/#_1","title":"\u7f13\u51b2\u200b\u961f\u5217\u200b\u7b80\u4ecb","text":"<p>Little Unicorn Bot\u200b\u7684\u200b\u7f13\u51b2\u200b\u961f\u5217\u200b\u57fa\u4e8e\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u7a0b\u200b\u4e2d\u200b\u7684\u200b\u201c\u200b\u751f\u4ea7\u8005\u200b-\u200b\u6d88\u8d39\u8005\u200b\u201d\u200b\u6a21\u578b\u200b\u3002\u200b\u5728\u200b\u8be5\u200b\u6a21\u578b\u200b\u4e2d\u200b\uff0c\u200b\u6709\u6ee1\u200b\u548c\u200b\u7a7a\u200b\u4e24\u79cd\u200b\u8d44\u6e90\u200b\uff0c\u200b\u6bcf\u79cd\u200b\u8d44\u6e90\u200b\u4f7f\u7528\u200b\u5bf9\u5e94\u200b\u7684\u200b\u4fe1\u53f7\u91cf\u200b\u8fdb\u884c\u200b\u4fdd\u62a4\u200b\u3002\u200b\u751f\u4ea7\u8005\u200b\u6d88\u8017\u200b\u7a7a\u200b\u8d44\u6e90\u200b\u751f\u4ea7\u200b\u6ee1\u200b\u8d44\u6e90\u200b\uff0c\u200b\u6d88\u8d39\u8005\u200b\u6d88\u8017\u200b\u6ee1\u200b\u8d44\u6e90\u200b\u751f\u4ea7\u200b\u7a7a\u200b\u8d44\u6e90\u200b\uff0c\u200b\u6ee1\u200b\u8d44\u6e90\u200b\u548c\u200b\u7a7a\u200b\u8d44\u6e90\u200b\u4e4b\u200b\u548c\u200b\u4e3a\u200b\u5b9a\u503c\u200b\uff08\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u8bfe\u4e0a\u200b\u79f0\u4e4b\u4e3a\u200b\u76d8\u5b50\u200b\u4e2a\u6570\u200b\uff09\u3002\u200b\u4e3a\u4e86\u200b\u5b9e\u73b0\u200b\u7f13\u51b2\u200b\uff0c\u200b\u6211\u4eec\u200b\u53ea\u200b\u9700\u200b\u5c06\u200b\u5916\u90e8\u200b\u8f93\u5165\u200b\u89c6\u4e3a\u200b\u6d88\u8d39\u8005\u200b\uff0c\u200b\u7136\u540e\u200b\u6a21\u62df\u200b\u751f\u4ea7\u8005\u200b\u5b9a\u65f6\u200b\u751f\u4ea7\u200b\u6ee1\u200b\u8d44\u6e90\u200b\uff0c\u200b\u5373\u53ef\u200b\u505a\u5230\u200b\u7f13\u51b2\u200b\u6267\u884c\u200b\u5916\u90e8\u200b\u8f93\u5165\u200b\u3002</p> \u200b\u51fd\u6570\u200b\u540d\u200b \u200b\u53c2\u6570\u200b \u200b\u8fd4\u56de\u503c\u200b \u200b\u529f\u80fd\u200b __init__ <code>@feedInterval</code>: \u200b\u751f\u4ea7\u8005\u200b\u751f\u4ea7\u200b\u95f4\u9694\u200b\uff08\u200b\u5355\u4f4d\u200b\u79d2\u200b\uff09\uff0c<code>int</code>\u200b\u6216\u200b<code>float</code>\u200b\u7c7b\u578b\u200b<code>@maxCapa</code>: \u200b\u6ee1\u200b\u8d44\u6e90\u200b\u548c\u200b\u7a7a\u200b\u8d44\u6e90\u200b\u4e4b\u200b\u548c\u200b\uff08\u200b\u987b\u200b\u4e3a\u200b\u6b63\u200b\uff09\uff0c<code>int</code>\u200b\u7c7b\u578b\u200b <code>None</code> \u200b\u521d\u59cb\u5316\u200b<code>bufferQueue</code>\u200b\u7c7b\u200b put <code>@func</code>: \u200b\u5f85\u200b\u6267\u884c\u200b\u51fd\u6570\u200b\uff0c<code>Callable</code>\u200b\u7c7b\u578b\u200b<code>@args</code>: \u200b\u5f85\u200b\u6267\u884c\u200b\u51fd\u6570\u200b\u7684\u200bargs\u200b\u53c2\u6570\u200b\uff0c<code>Tuple</code>\u200b\u7c7b\u578b\u200b<code>@kwagrs</code>: \u200b\u5f85\u200b\u6267\u884c\u200b\u51fd\u6570\u200b\u7684\u200bkwargs\u200b\u53c2\u6570\u200b\uff0c<code>Dict</code>\u200b\u7c7b\u578b\u200b <code>None</code> \u200b\u8bbe\u7f6e\u200b\u7f13\u51b2\u200b\u961f\u5217\u200b\u6267\u884c\u200b\u5bf9\u8c61\u200b start - <code>None</code> \u200b\u542f\u52a8\u200b\u7f13\u51b2\u200b\u961f\u5217"},{"location":"api/bufferQueue/#_2","title":"\u5e94\u7528\u200b\u573a\u666f\u200b\u5206\u6790","text":"<p>\u200b\u6d88\u606f\u200b\u7f13\u51b2\u200b\u961f\u5217\u200b\u662f\u200b\u7f13\u51b2\u200b\u961f\u5217\u200b\u6700\u5927\u200b\u7684\u200b\u5e94\u7528\u200b\u573a\u666f\u200b\uff08\u200b\u6b64\u5916\u200b\u8fd8\u6709\u200b\u62cd\u200b\u4e00\u200b\u62cd\u200b\u7f13\u51b2\u200b\uff09\uff0c\u200b\u4ee3\u7801\u200b\u5982\u4e0b\u200b\uff08\u200b\u4f4d\u4e8e\u200butils/basicEvent.py\uff09\uff1a</p> <pre><code>groupSendBufferQueue = BufferQueue(1, 1)\ngroupSendBufferQueue.start()\ndef send(id: int, message: str, type:str='group')-&gt;None:\n\"\"\"\u200b\u53d1\u9001\u200b\u6d88\u606f\u200b\n    id: \u200b\u7fa4\u53f7\u200b\u6216\u8005\u200b\u79c1\u804a\u200b\u5bf9\u8c61\u200bqq\u200b\u53f7\u200b\n    message: \u200b\u6d88\u606f\u200b\n    type: Union['group', 'private'], \u200b\u9ed8\u8ba4\u200b 'group'\n    \"\"\"\nurl = HTTP_URL+\"/send_msg\"\nif type=='group':\nparams = {\n\"message_type\": type,\n\"group_id\": id,\n\"message\": message\n}\ngroupSendBufferQueue.put(requests.get, (url,), {'params':params})\n# requests.get(url, params=params)\nelif type=='private':\nparams = {\n\"message_type\": type,\n\"user_id\": id,\n\"message\": message\n}\nrequests.get(url, params=params)\n</code></pre>"},{"location":"api/bufferQueue/#_3","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b utils/bufferQueue.py</p> <pre><code>class BufferQueue():\ndef __init__(self, feedInterval:float, maxCapa:int) -&gt; None:\nassert maxCapa &gt; 0\nself.emptyResource = Semaphore(maxCapa)\nself.fullResource = Semaphore(0)\nself.queue = Queue()\nself.feedInterval = feedInterval\nself.feeder = Thread(target=self._feedThread)\nself.worker = Thread(target=self._workThread)\ndef _acquire(self):\nself.emptyResource.acquire(blocking=True)\nfunc, args, kwargs = self.queue.get(block=True)\nfunc(*args, **kwargs)\nself.fullResource.release()\ndef _release(self):\nself.fullResource.acquire(blocking=True)\nself.emptyResource.release()\ndef _feedThread(self):\nwhile True:\nself._release()\ntime.sleep(self.feedInterval)\ndef _workThread(self):\nwhile True:\nself._acquire()\ndef put(self, func:Callable, args:Tuple=(), kwargs:Dict[str, Any]={}):\nself.queue.put((func, args, kwargs), block=False)\ndef start(self):\nself.feeder.start()\nself.worker.start()\n</code></pre>"},{"location":"api/draw-card/","title":"\u54cd\u5e94\u200b\u5361\u7247\u200b\u7ed8\u5236","text":"<p>\u200b\u90e8\u5206\u200b\u529f\u80fd\u200b\u573a\u666f\u200b\u4e0b\u200b\uff0cBot\u200b\u7684\u200b\u56de\u7b54\u200b\u5305\u542b\u200b\u8f83\u200b\u591a\u200b\u6587\u5b57\u200b\u548c\u200b\u63d2\u56fe\u200b\uff08\u200b\u5982\u200b\"\u200b\u6bcf\u65e5\u200b\u65b0\u95fb\u200b\"\uff0c\"\u200b\u529f\u80fd\u200b\u5217\u8868\u200b\"\uff09\uff0c\u200b\u4e3a\u200b\u907f\u514d\u200b\u53d1\u9001\u200b\u5927\u91cf\u200b\u6587\u5b57\u200b\u7684\u200b\u98ce\u63a7\u200b\u98ce\u9669\u200b\u3001\u200b\u7f8e\u5316\u200b\u56de\u590d\u200b\u4fe1\u606f\u200b\u7684\u200b\u5c55\u793a\u200b\u5f62\u5f0f\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u8fd9\u4e9b\u200b\u5185\u5bb9\u200b\u8f6c\u5316\u200b\u4e3a\u200b\u4e00\u5f20\u200b\u56fe\u7247\u200b\u53d1\u9001\u200b\u3002Little-UNIkeEN-Bot \u200b\u57fa\u4e8e\u200b pillow \u200b\u5c01\u88c5\u200b\u4e86\u200b responseImage \u200b\u5e93\u200b\uff0c\u200b\u65b9\u4fbf\u200b\u5f00\u53d1\u8005\u200b\u5feb\u901f\u200b\u6784\u5efa\u200b\u6b64\u7c7b\u200b\u56fe\u7247\u200b\uff0c\u200b\u4ee5\u4e0b\u200b\u662f\u200b\u4e24\u4e2a\u200b\u793a\u4f8b\u200b\u3002</p> <p> </p>"},{"location":"api/draw-card/#responseimage","title":"\u5bfc\u5165\u200b responseImage \u200b\u5e93","text":"<p>responseImage \u200b\u5e93\u200b\u4f4d\u4e8e\u200b <code>./utils/</code> \u200b\u76ee\u5f55\u200b\u4e0b\u200b\u3002\u200b\u5728\u200b\u63d2\u4ef6\u200b\u4ee3\u7801\u200b\u4e2d\u200b\u4f7f\u7528\u200b\u5982\u4e0b\u200b\u4ee3\u7801\u200b\u5bfc\u5165\u200b\u6b64\u5e93\u200b\uff1a</p> <pre><code>from utils.responseImage import *\n</code></pre> <p>\u200b\u63d0\u793a\u200b</p> <p>\u200b\u5728\u200b\u4f7f\u7528\u200b\u672c\u5e93\u200b\u524d\u200b\uff0c\u200b\u8bf7\u200b\u786e\u4fdd\u200b <code>./resources/fonts/</code> \u200b\u76ee\u5f55\u200b\u4e0b\u200b <code>\u200b\u6c49\u200b\u4eea\u6587\u200b\u9ed1\u200b.ttf</code> \u200b\u548c\u200b <code>SourceHanSansCN-Medium.otf</code> \u200b\u5b57\u4f53\u200b\u6587\u4ef6\u200b\u5b58\u653e\u200b\u5b8c\u6574\u200b\uff0c\u200b\u5426\u5219\u200b\u60a8\u200b\u5c06\u200b\u65e0\u6cd5\u200b\u4f7f\u7528\u200b\u9ed8\u8ba4\u200b\u5b57\u4f53\u200b\u3002 \u200b\u5982\u200b\u8981\u200b\u66f4\u6362\u200b\u9ed8\u8ba4\u200b\u5b57\u4f53\u200b\u6216\u200b\u5b57\u4f53\u200b\u5b58\u653e\u200b\u5730\u5740\u200b\uff0c\u200b\u8bf7\u200b\u4fee\u6539\u200b\u5e93\u4e2d\u200b\u5168\u5c40\u200b\u5e38\u91cf\u200b\u4ee3\u7801\u200b\u3002</p>"},{"location":"api/draw-card/#_1","title":"\u521b\u5efa\u200b\u56fe\u7247","text":"<p>\u200b\u672c\u5e93\u200b\u7684\u200b\u6240\u6709\u200b\u64cd\u4f5c\u200b\u5747\u200b\u57fa\u4e8e\u200b ResponseImage \u200b\u7c7b\u200b\u5b8c\u6210\u200b\uff0c\u200b\u65b0\u5efa\u200b\u4e00\u4e2a\u200b ResponseImage \u200b\u7c7b\u200b\u7684\u200b\u5b9e\u4f8b\u200b\u4ee5\u200b\u521b\u5efa\u200b\u4e00\u5f20\u200b\u56fe\u7247\u200b\u3002</p> <p>\u200b\u793a\u4f8b\u200b\u4ee3\u7801\u200b\uff1a</p> <pre><code>img = ResponseImage(\ntheme = 'unicorn',\ntitle = '\u200b\u5e2e\u52a9\u200b\u5217\u8868\u200b', \ntitleColor = (165, 255, 255, 255), \nprimaryColor = PALETTE_SJTU_RED, \nfooter = '\u200b\u66f4\u65b0\u200b\u65e5\u671f\u200b 2022/08/30',\nlayout = 'two-column')\n</code></pre> <p>\u200b\u53ef\u9009\u200b\u7684\u200b\u53c2\u6570\u200b\u5982\u4e0b\u200b\uff1a</p> \u200b\u5c5e\u6027\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u53d6\u503c\u200b\u8bf4\u660e\u200b \u200b\u5907\u6ce8\u200b theme \u200b\u4e3b\u9898\u200b unicorn \u200b\u8868\u793a\u200b\u4f7f\u7528\u200b\u9ed8\u8ba4\u200b\u4e3b\u9898\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b'unicorn' autoSize \u200b\u81ea\u52a8\u200b\u8c03\u6574\u200b\u5927\u5c0f\u200b bool\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u662f\u5426\u200b\u6839\u636e\u200b\u4fe1\u606f\u5185\u5bb9\u200b\u8c03\u6574\u200b\u5927\u5c0f\u200b \u200b\u53ef\u200b\u9009\u200b\u9ed8\u8ba4\u200b\u4e3a\u200bTrue layout \u200b\u5e03\u5c40\u200b\u65b9\u5f0f\u200b normal \u200b\u8868\u793a\u200b\u5355\u680f\u200b\u5e03\u5c40\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u5355\u680f\u200b two-column \u200b\u8868\u793a\u200b\u53cc\u680f\u200b\u5e03\u5c40\u200b height \u200b\u56fe\u7247\u200b\u9ad8\u5ea6\u200b int\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u56fe\u7247\u200b\u9ad8\u5ea6\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b800\uff0cautoSize\u200b\u4e3a\u200bTrue\u200b\u65f6\u200b\u65e0\u6548\u200b width \u200b\u56fe\u7247\u200b\u5bbd\u5ea6\u200b int\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u56fe\u7247\u200b\u5bbd\u5ea6\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b880\uff0cautoSize\u200b\u4e3a\u200bTrue\u200b\u65f6\u200b\uff0c\u200b\u5c06\u200b\u56fa\u5b9a\u200bwidth\u200b\u81ea\u52a8\u200b\u8c03\u6574\u200b\u9ad8\u5ea6\u200b title \u200b\u6807\u9898\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u663e\u793a\u200b\u5728\u200b\u56fe\u7247\u200b\u9876\u90e8\u200b\u7684\u200b\u6807\u9898\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u4e0d\u200b\u652f\u6301\u200b\u6362\u884c\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b'\u200b\u54cd\u5e94\u200b\u5361\u7247\u200b' titleColor \u200b\u6807\u9898\u200b\u6846\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u6807\u9898\u200b\u6846\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u82e5\u200b\u7f3a\u7701\u200b\uff0c\u200b\u5219\u200b\u4e0e\u200bprimaryColor\u200b\u4e00\u81f4\u200b primaryColor \u200b\u4e3b\u9898\u200b\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u4e3b\u9898\u200b\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b\uff0c\u200b\u5c06\u200b\u5e94\u7528\u200b\u4e8e\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u5173\u952e\u200b\u53e5\u200b\u989c\u8272\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u84dd\u8272\u200b backColor \u200b\u80cc\u666f\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u56fe\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b(240,240,240,255) footer \u200b\u9875\u811a\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u663e\u793a\u200b\u5728\u200b\u56fe\u7247\u200b\u5e95\u90e8\u200b\u7684\u200b\u9875\u811a\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u4e0d\u200b\u652f\u6301\u200b\u6362\u884c\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u7a7a\u200b cardTitleFont \u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6807\u9898\u200b\u5b57\u4f53\u200b ImageFont.FreeTypeFont\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6807\u9898\u200b\u4f7f\u7528\u200b\u7684\u200b\u5b57\u4f53\u200b\u53ca\u200b\u5927\u5c0f\u200b \u200b\u53ef\u200b\u9009\u200b cardSubtitleFont \u200b\u524d\u666f\u200b\u5361\u7247\u200b\u526f\u6807\u9898\u200b\u5b57\u4f53\u200b ImageFont.FreeTypeFont\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u526f\u6807\u9898\u200b\u548c\u200b\u5173\u952e\u200b\u53e5\u200b\u4f7f\u7528\u200b\u7684\u200b\u5b57\u4f53\u200b\u53ca\u200b\u5927\u5c0f\u200b \u200b\u53ef\u200b\u9009\u200b cardBodyFont \u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6b63\u6587\u200b\u5b57\u4f53\u200b ImageFont.FreeTypeFont\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6b63\u6587\u200b\u4f7f\u7528\u200b\u7684\u200b\u5b57\u4f53\u200b\u53ca\u200b\u5927\u5c0f\u200b \u200b\u53ef\u200b\u9009"},{"location":"api/draw-card/#_2","title":"\u6dfb\u52a0\u200b\u524d\u666f\u200b\u5361\u7247","text":"<p>ResponseImage \u200b\u5b9e\u4f8b\u200b\u76f8\u5f53\u4e8e\u200b\u4e00\u4e2a\u200b\u5bb9\u5668\u200b\u3002\u200b\u5982\u8981\u200b\u8ba9\u200b\u56fe\u7247\u200b\u5c55\u793a\u200b\u5404\u7c7b\u200b\u4fe1\u606f\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u5411\u200b\u5b9e\u4f8b\u200b\u6dfb\u52a0\u200b\u4e00\u4e2a\u200b\u6216\u200b\u591a\u4e2a\u200b\"\u200b\u524d\u666f\u200b\u5361\u7247\u200b\"\u3002</p> <p>\"\u200b\u524d\u666f\u200b\u5361\u7247\u200b\"\u200b\u673a\u5236\u200b\u53ef\u4ee5\u200b\u5e2e\u52a9\u200b\u4f60\u200b\u5c06\u200b\u5404\u7c7b\u200b\u4fe1\u606f\u200b\u5206\u7ec4\u200b\u5c55\u793a\u200b\u3002</p>"},{"location":"api/draw-card/#addcard","title":"addCard() \u200b\u6dfb\u52a0\u200b\u5361\u7247","text":"<p>\u200b\u4f7f\u7528\u200b <code>ResponseImage.addCard()</code> \u200b\u51fd\u6570\u200b\uff0c\u200b\u5411\u200b ResponseImage \u200b\u5b9e\u4f8b\u200b\u6dfb\u52a0\u200b\u5355\u4e2a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u3002\u200b\u5361\u7247\u200b\u5728\u200b\u56fe\u7247\u200b\u4e2d\u200b\u6309\u200b\u6dfb\u52a0\u200b\u5361\u7247\u200b\u7684\u200b\u987a\u5e8f\u200b\u663e\u793a\u200b\u3002</p> <p>\u200b\u793a\u4f8b\u200b\u4ee3\u7801\u200b\uff1a</p> <pre><code>img.addCard(\nResponseImage.NormalCard(\ntitle ='\u200b\u539f\u795e\u200b2.1\u200b\u7248\u672c\u200b',\nsubtitle = '\u300c\u200b\u97f6\u5149\u200b\u629a\u6708\u200b\uff0c\u200b\u5929\u4e0b\u200b\u4eba\u95f4\u200b\u300dPV\u200b\u53f0\u8bcd\u200b',\nbody = \"\"\"\u200b\u98ce\u96e8\u200b\u72b9\u795d\u200b\uff0c\u200b\u5c71\u6d77\u200b\u540c\u6b22\u200b\uff0c\u200b\u662f\u200b\u627f\u200b\u5929\u5730\u200b\u4e4b\u4f51\u200b\uff1b\n\u200b\u661f\u79fb\u6597\u8f6c\u200b\uff0c\u200b\u6ca7\u6d77\u6851\u7530\u200b\uff0c\u200b\u70df\u706b\u200b\u4eba\u95f4\u200b\u4f9d\u65e7\u200b\uff1b\n\u200b\u529f\u540d\u200b\u5728\u200b\u6211\u200b\uff0c\u200b\u767e\u5c81\u5343\u79cb\u200b\uff0c\u200b\u6bcb\u5fd8\u200b\u79c9\u70db\u591c\u6e38\u200b\uff1b\n\u200b\u53e4\u4eca\u200b\u8bf8\u4e8b\u200b\uff0c\u200b\u6fc0\u8361\u200b\u4e2d\u6d41\u200b\uff0c\u200b\u5b8f\u56fe\u200b\u5f85\u200b\u770b\u200b\u65b0\u79c0\u200b\u3002\"\"\",\nicon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAA...',\nsubtitleFontColor=PALETTE_GREEN,\nbackColor=PALETTE_LIGHTGREEN\n)\n)\n</code></pre> <p>\u200b\u5e93\u200b\u9884\u8bbe\u200b\u4e86\u200b\u591a\u79cd\u200b\u5361\u7247\u200b\u7c7b\u578b\u200b\u53ef\u200b\u4f9b\u200b\u6dfb\u52a0\u200b\uff1a</p>"},{"location":"api/draw-card/#normalcard","title":"NormalCard","text":"<p>\u200b\u6807\u51c6\u200b\u7c7b\u578b\u200b\u524d\u666f\u200b\u5361\u7247\u200b\uff0c\u200b\u5185\u5bb9\u200b\u5de6\u200b\u5bf9\u9f50\u200b\u3002</p> <p>\u200b\u53ef\u200b\u4f9b\u200b\u7f16\u8f91\u200b\u7684\u200b\u53c2\u6570\u200b\u5982\u4e0b\u200b\uff1a</p> \u200b\u5c5e\u6027\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u53d6\u503c\u200b\u8bf4\u660e\u200b \u200b\u5907\u6ce8\u200b title \u200b\u6807\u9898\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u6807\u9898\u200b \u200b\u53ef\u200b\u9009\u200b subtitle \u200b\u526f\u6807\u9898\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u526f\u6807\u9898\u200b \u200b\u53ef\u200b\u9009\u200b keyword \u200b\u5173\u952e\u200b\u53e5\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u5173\u952e\u200b\u53e5\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u5173\u952e\u200b\u53e5\u200b\u5b57\u4f53\u200b\u540c\u200b\u526f\u6807\u9898\u200b\uff0c\u200b\u989c\u8272\u200b\u540c\u200b\u56fe\u7247\u200b\u4e3b\u9898\u200b\u8272\u200b body \u200b\u6b63\u6587\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u6b63\u6587\u200b \u200b\u53ef\u200b\u9009\u200b icon \u200b\u56fe\u6807\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b\u6216\u200bImage\u200b\u5bf9\u8c61\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u9760\u5de6\u200b\u663e\u793a\u200b\u7684\u200b\u56fe\u6807\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u672c\u5730\u200b\u56fe\u7247\u200b/\u200b\u7f51\u7edc\u200b\u56fe\u7247\u200b\u5730\u5740\u200b\uff0cbase64\u200b\u7f16\u7801\u200b\u4e32\u200b\u6216\u200bPIL.Image\u200b\u5bf9\u8c61\u200b\u3002\u200b\u5c06\u200b\u81ea\u52a8\u200b\u7f29\u653e\u200b\u4e3a\u200b90x90\u200b\u5927\u5c0f\u200b\u663e\u793a\u200b titleFontColor \u200b\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u9ed1\u8272\u200b subtitleFontColor \u200b\u526f\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u526f\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u6df1\u7070\u200b bodyFontColor \u200b\u6b63\u6587\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6b63\u6587\u200b\u90e8\u5206\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u6d45\u7070\u200b backColor \u200b\u5361\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u767d\u8272\u200b <p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u7a7a\u884c\u200b</p> <p>\u200b\u5728\u200b\u540c\u200b\u4e00\u9879\u200b\u4e2d\u200b\u8bd5\u56fe\u200b\u6dfb\u52a0\u200b\u7a7a\u884c\u200b\u65f6\u200b\uff0c\u200b\u8bf7\u200b\u5c3d\u91cf\u200b\u786e\u4fdd\u200b\u7a7a\u884c\u200b\u81f3\u5c11\u200b\u542b\u6709\u200b\u4e00\u4e2a\u200b\u7a7a\u683c\u200b</p> <p>\u200b\u793a\u4f8b\u200b\u4ee3\u7801\u200b\u53ca\u200b\u6548\u679c\u200b\uff1a</p> <pre><code>img.addCard(\nResponseImage.NormalCard(\ntitle ='[title \u200b\u6807\u9898\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b',\nsubtitle = '[subtitle \u200b\u526f\u6807\u9898\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b',\nkeyword = '[keyword \u200b\u5173\u952e\u200b\u53e5\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b\uff0c\u200b\u5b57\u4f53\u200b\u540c\u200b\u526f\u6807\u9898\u200b\uff0c\u200b\u989c\u8272\u200b\u540c\u200b\u5173\u952e\u200b\u8272\u200b',\nbody = '[body \u200b\u6b63\u6587\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b\uff0c\\n\u200b\u5de6\u200b\u5bf9\u9f50\u200b\u663e\u793a\u200b',\nicon = '...',\n)\n)\n</code></pre> <p> </p>"},{"location":"api/draw-card/#noticecard","title":"NoticeCard","text":"<p>\u200b\u901a\u77e5\u200b\u7c7b\u578b\u200b\u524d\u666f\u200b\u5361\u7247\u200b\uff0c\u200b\u5185\u5bb9\u200b\u5c45\u4e2d\u200b\u663e\u793a\u200b\u3002</p> <p>\u200b\u53ef\u200b\u4f9b\u200b\u7f16\u8f91\u200b\u7684\u200b\u53c2\u6570\u200b\u5982\u4e0b\u200b\uff1a</p> \u200b\u5c5e\u6027\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u53d6\u503c\u200b\u8bf4\u660e\u200b \u200b\u5907\u6ce8\u200b title \u200b\u6807\u9898\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u6807\u9898\u200b \u200b\u53ef\u200b\u9009\u200b subtitle \u200b\u526f\u6807\u9898\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u526f\u6807\u9898\u200b \u200b\u53ef\u200b\u9009\u200b keyword \u200b\u5173\u952e\u200b\u53e5\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u5173\u952e\u200b\u53e5\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u5173\u952e\u200b\u53e5\u200b\u5b57\u4f53\u200b\u540c\u200b\u526f\u6807\u9898\u200b\uff0c\u200b\u989c\u8272\u200b\u540c\u200b\u56fe\u7247\u200b\u4e3b\u9898\u200b\u8272\u200b body \u200b\u6b63\u6587\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u6b63\u6587\u200b \u200b\u53ef\u200b\u9009\u200b illustration \u200b\u914d\u56fe\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b\u6216\u200bImage\u200b\u5bf9\u8c61\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u5e95\u90e8\u200b\u663e\u793a\u200b\u7684\u200b\u914d\u56fe\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u672c\u5730\u200b\u56fe\u7247\u200b/\u200b\u7f51\u7edc\u200b\u56fe\u7247\u200b\u5730\u5740\u200b\uff0cbase64\u200b\u7f16\u7801\u200b\u4e32\u200b\u6216\u200bPIL.Image\u200b\u5bf9\u8c61\u200b\u3002\u200b\u82e5\u200b\u56fe\u7247\u200b\u8fc7\u5927\u200b\uff0c\u200b\u5c06\u200b\u81ea\u52a8\u200b\u7f29\u653e\u200b\u4ee5\u200b\u9002\u914d\u5361\u200b\u7247\u200b\u5bbd\u5ea6\u200b titleFontColor \u200b\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u9ed1\u8272\u200b subtitleFontColor \u200b\u526f\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u526f\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u6df1\u7070\u200b bodyFontColor \u200b\u6b63\u6587\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6b63\u6587\u200b\u90e8\u5206\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u6d45\u7070\u200b backColor \u200b\u5361\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u767d\u8272\u200b <p>\u200b\u793a\u4f8b\u200b\u4ee3\u7801\u200b\u53ca\u200b\u6548\u679c\u200b\uff1a</p> <pre><code>img.addCard(\nResponseImage.NoticeCard(\ntitle ='NoticeCard\\n[title \u200b\u6807\u9898\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b',\nsubtitle = '[subtitle \u200b\u526f\u6807\u9898\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b',\nkeyword = '[keyword \u200b\u5173\u952e\u200b\u53e5\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b\uff0c\u200b\u5b57\u4f53\u200b\u540c\u200b\u526f\u6807\u9898\u200b\uff0c\u200b\u989c\u8272\u200b\u540c\u200b\u5173\u952e\u200b\u8272\u200b',\nbody = '[body \u200b\u6b63\u6587\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b\uff0c\\n\u200b\u5c45\u4e2d\u200b\u663e\u793a\u200b',\nicon = 'https://picx.zhimg.com/v2-7d1069f8beeeae09f0d26812941cebe0_1440w.jpg?source=172ae18b',\n)\n)\n</code></pre> <p> </p>"},{"location":"api/draw-card/#richcontentcard","title":"RichContentCard","text":"<p>\u200b\u5bcc\u200b\u5185\u5bb9\u200b\u590d\u5408\u200b\u7c7b\u578b\u200b\u5361\u7247\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u5728\u200b\u4e00\u4e2a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u4e2d\u200b\u663e\u793a\u200b\u590d\u5408\u200b\u683c\u5f0f\u200b\u7684\u200b\u591a\u884c\u200b\u6587\u672c\u200b\u3002</p> \u200b\u5c5e\u6027\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u53d6\u503c\u200b\u8bf4\u660e\u200b \u200b\u5907\u6ce8\u200b raw_content \u200b\u5185\u5bb9\u200b list\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u663e\u793a\u200b\u7684\u200b\u5185\u5bb9\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u4ee5\u200b\u5217\u8868\u200b\u5d4c\u5957\u200b\u5143\u7ec4\u200b\u5f62\u5f0f\u200b\u8f93\u5165\u200b\uff0c\u200b\u5143\u7ec4\u200b\u793a\u4f8b\u200b\uff1a\uff08\u200b\u683c\u5f0f\u200b\uff0c\u200b\u5185\u5bb9\u200b\uff09 icon \u200b\u56fe\u6807\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b\u6216\u200bImage\u200b\u5bf9\u8c61\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u9760\u5de6\u200b\u663e\u793a\u200b\u7684\u200b\u56fe\u6807\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u672c\u5730\u200b\u56fe\u7247\u200b/\u200b\u7f51\u7edc\u200b\u56fe\u7247\u200b\u5730\u5740\u200b\uff0cbase64\u200b\u7f16\u7801\u200b\u4e32\u200b\u6216\u200bPIL.Image\u200b\u5bf9\u8c61\u200b\u3002\u200b\u5c06\u200b\u81ea\u52a8\u200b\u7f29\u653e\u200b\u4e3a\u200b90x90\u200b\u5927\u5c0f\u200b\u663e\u793a\u200b titleFontColor \u200b\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u9ed1\u8272\u200b subtitleFontColor \u200b\u526f\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u526f\u6807\u9898\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u6df1\u7070\u200b bodyFontColor \u200b\u6b63\u6587\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u6b63\u6587\u200b\u90e8\u5206\u200b\u5b57\u4f53\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u6d45\u7070\u200b backColor \u200b\u5361\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u767d\u8272\u200b <p>\u200b\u5185\u5bb9\u200b\u4ee5\u200b\u5217\u8868\u200b\u7684\u200b\u5f62\u5f0f\u200b\u8f93\u5165\u200b'raw_content'\u200b\u53c2\u6570\u200b\uff0c\u200b\u5217\u8868\u200b\u4e2d\u200b\u6bcf\u9879\u200b\u4e3a\u200b\u4e00\u4e2a\u200b\u5f62\u200b\u5982\u200b <code>(\u200b\u7c7b\u578b\u200b\uff0c\u200b\u5185\u5bb9\u200b)</code> \u200b\u7684\u200b\u5143\u7ec4\u200b\uff0c\u200b\u5176\u4e2d\u200b\u53ef\u9009\u9879\u200b\u5982\u4e0b\u200b\u3002</p> \u200b\u7c7b\u578b\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u5185\u5bb9\u200b\u7c7b\u578b\u200b \u200b\u5907\u6ce8\u200b title \u200b\u6807\u9898\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b keyword \u200b\u5173\u952e\u200b\u53e5\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b subtitle \u200b\u526f\u6807\u9898\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b body \u200b\u6b63\u6587\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b separator \u200b\u5206\u5272\u7ebf\u200b \u200b\u5206\u5272\u7ebf\u200b\u7c7b\u578b\u200b\u65e0\u9700\u200b\u63d0\u4f9b\u200b\u5185\u5bb9\u200b\u9879\u200b progressBar \u200b\u8fdb\u5ea6\u6761\u200b float\u200b\u578b\u200b\u53d8\u91cf\u200b(0-1) \u200b\u5185\u5bb9\u200b\u9879\u200b\u7b2c\u4e00\u9879\u200b\u5373\u200b\u8fdb\u5ea6\u6761\u200b\u8fdb\u5ea6\u200b\uff0c\u200b\u5982\u200b\u5728\u200b\u8fdb\u5ea6\u200b\u9879\u540e\u200b\u52a0\u200b'auto'\u200b\u9879\u200b\uff0c\u200b\u5219\u200b\u4f1a\u200b\u81ea\u52a8\u200b\u6839\u636e\u200b\u8fdb\u5ea6\u200b\u66f4\u6539\u200b\u989c\u8272\u200b\uff1b\u200b\u5982\u200b\u5728\u200b\u8fdb\u5ea6\u200b\u9879\u540e\u200b\u52a0\u200b\u4e24\u9879\u200b\u989c\u8272\u200b\u53d8\u91cf\u200b\uff0c\u200b\u5219\u200b\u53ef\u200b\u5206\u522b\u200b\u6307\u5b9a\u200b\u8fdb\u5ea6\u6761\u200b\u524d\u666f\u8272\u200b\u548c\u200b\u80cc\u666f\u8272\u200b <p>\u200b\u793a\u4f8b\u200b\u4ee3\u7801\u200b\u53ca\u200b\u6548\u679c\u200b\uff1a</p> <pre><code>img.addCard(\nResponseImage.RichContentCard(\nraw_content=[\n('title', 'RichContentCard'),\n('keyword', '\u200b\u5f26\u6708\u200b\u821e\u6b65\u200b'),\n('body', '\u200b\u666e\u901a\u653b\u51fb\u200b\uff1a\u200b\u53ef\u4ee5\u200b\u8fdb\u884c\u200b\u81f3\u591a\u200b\u4e09\u6bb5\u200b\u7684\u200b\u8fde\u7eed\u200b\u5251\u51fb\u200b\uff1b\u200b\u91cd\u51fb\u200b\u6d88\u8017\u200b\u4e00\u5b9a\u200b\u4f53\u529b\u200b\u8fdb\u884c\u200b\u4e00\u6b21\u200b\u65cb\u8f6c\u200b\u65a9\u51fb\u200b\uff1b\u200b\u4e0b\u843d\u200b\u653b\u51fb\u200b\uff0c\u200b\u4ece\u200b\u7a7a\u4e2d\u200b\u4e0b\u5760\u200b\u51b2\u51fb\u200b\u5730\u9762\u200b\uff0c\u200b\u653b\u51fb\u200b\u4e0b\u843d\u200b\u8def\u5f84\u200b\u4e0a\u200b\u7684\u200b\u654c\u4eba\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u843d\u5730\u200b\u65f6\u200b\u9020\u6210\u200b\u8303\u56f4\u200b\u4f24\u5bb3\u200b\u3002'),\n('separator',),\n('keyword', '\u200b\u4e03\u57df\u200b\u821e\u6b65\u200b'),\n('subtitle', 'E\u200b\u6280\u80fd\u200b'),\n('body', '\u200b\u5c55\u5f00\u200b\u201d\u200b\u7fe9\u8f6c\u200b\u201d\u200b\u72b6\u6001\u200b\uff0c\u200b\u57fa\u4e8e\u200b\u59ae\u9732\u200b\u7684\u200b\u751f\u547d\u200b\u503c\u200b\u4e0a\u9650\u200b\u5bf9\u200b\u8eab\u8fb9\u200b\u7684\u200b\u654c\u4eba\u200b\u9020\u6210\u200b\u6c34\u200b\u5143\u7d20\u200b\u4f24\u5bb3\u200b\u3002'),\n('separator',),\n('keyword', '\u200b\u6d6e\u83b2\u200b\u821e\u6b65\u200b \u200b\u8fdc\u68a6\u200b\u8046\u6cc9\u200b'),\n('subtitle', 'Q\u200b\u6280\u80fd\u200b'),\n('body', '\u200b\u57fa\u4e8e\u200b\u59ae\u9732\u200b\u7684\u200b\u751f\u547d\u200b\u503c\u200b\u4e0a\u9650\u200b\uff0c\u200b\u9020\u6210\u200b\u6c34\u200b\u5143\u7d20\u200b\u8303\u56f4\u200b\u4f24\u5bb3\u200b\uff0c\u200b\u5e76\u200b\u4e3a\u200b\u547d\u4e2d\u200b\u7684\u200b\u654c\u4eba\u200b\u65bd\u52a0\u200b\u201c\u200b\u6c34\u4e16\u6d41\u200b\u6c94\u200b\u201d\u200b\u72b6\u6001\u200b\uff0c\u200b\u77ed\u6682\u200b\u95f4\u9694\u200b\u540e\u200b\uff0c\u200b\u5904\u4e8e\u200b\u201c\u200b\u6c38\u4e16\u200b\u6ce8\u200b\u6c94\u200b\u201d\u200b\u72b6\u6001\u200b\u4e0b\u200b\u7684\u200b\u654c\u4eba\u200b\u5c06\u200b\u53d7\u5230\u200b\u6c34\u200b\u5143\u7d20\u200b\u4f24\u5bb3\u200b\u3002'),\n],\nicon = 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimgo.hackhome.com%2Fimg2022%2F7%2F5%2F11%2F23040603.jpg&amp;refer=http%3A%2F%2Fimgo.hackhome.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1667132746&amp;t=a133591be6a3a16de33e20c8989f424c'\n)\n)\n</code></pre> <p> </p>"},{"location":"api/draw-card/#blankcard","title":"BlankCard","text":"<p>\u200b\u7a7a\u767d\u200b\u5361\u7247\u200b\uff0c\u200b\u53c2\u6570\u200b\u5982\u4e0b\u200b\uff1a</p> \u200b\u5c5e\u6027\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u53d6\u503c\u200b\u8bf4\u660e\u200b \u200b\u5907\u6ce8\u200b size \u200b\u9ad8\u5ea6\u200b int\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u7684\u200b\u9ad8\u5ea6\u200b (\u200b\u4e0d\u200b\u542b\u200b\u8fb9\u6846\u200b\u548c\u200b\u95f4\u8ddd\u200b) \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b0 backColor \u200b\u5361\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b tuple\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\u80cc\u666f\u200b\u989c\u8272\u200b\u7684\u200bRGBA\u200b\u503c\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u200b\u767d\u8272"},{"location":"api/draw-card/#addcardlist","title":"addCardList() \u200b\u6dfb\u52a0\u200b\u5361\u7247\u200b\u5217\u8868","text":"<p>\u200b\u4f7f\u7528\u200b <code>ResponseImage.addCardList()</code> \u200b\u51fd\u6570\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u4ee5\u200b\u5217\u8868\u200b\u5f62\u5f0f\u200b\u4e00\u6b21\u200b\u6dfb\u52a0\u200b\u591a\u4e2a\u200b\u524d\u666f\u200b\u5361\u7247\u200b\uff0c\u200b\u5361\u7247\u200b\u7c7b\u578b\u200b\u540c\u200b\u4e0a\u200b\u3002</p>"},{"location":"api/draw-card/#_3","title":"\u4f7f\u7528\u200b\u5b57\u5178\u200b\u7c7b\u578b\u200b\u6dfb\u52a0\u200b\u5361\u7247","text":"<p>\u200b\u9664\u200b\u4f7f\u7528\u200b\u5f62\u200b\u5982\u200b <code>NormalCard</code> \u200b\u7b49\u200b\u7c7b\u5916\u200b\uff0c\u200b\u4f60\u200b\u4e5f\u200b\u53ef\u4ee5\u200b\u4f7f\u7528\u200b\u5b57\u5178\u200b\u5f62\u5f0f\u200b\u6dfb\u52a0\u200b\u5361\u7247\u200b\u6570\u636e\u200b\uff0c\u200b\u5b57\u5178\u200b\u7684\u200b style \u200b\u952e\u503c\u200b\u5fc5\u9009\u200b\uff0c\u200b\u8868\u793a\u200b\u5361\u7247\u200b\u7c7b\u578b\u200b\u3002\u200b\u4ee5\u4e0b\u200b\u4e24\u6bb5\u200b\u4ee3\u7801\u200b\u7684\u200b\u6548\u679c\u200b\u76f8\u540c\u200b\uff1a</p> <pre><code>img.addCard(\nResponseImage.NormalCard(\ntitle ='[title \u200b\u6807\u9898\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b',\nsubtitle = '[subtitle \u200b\u526f\u6807\u9898\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b',\nkeyword = '[keyword \u200b\u5173\u952e\u200b\u53e5\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b\uff0c\u200b\u5b57\u4f53\u200b\u540c\u200b\u526f\u6807\u9898\u200b\uff0c\u200b\u989c\u8272\u200b\u540c\u200b\u5173\u952e\u200b\u8272\u200b',\nbody = '[body \u200b\u6b63\u6587\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b\uff0c\\n\u200b\u5de6\u200b\u5bf9\u9f50\u200b\u663e\u793a\u200b',\nicon = '...',\n)\n)\n</code></pre> <pre><code>img.addCard(\n{\n'style':'normal',\n'title': '[title \u200b\u6807\u9898\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b',\n'subtitle': '[subtitle \u200b\u526f\u6807\u9898\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b',\n'keyword': '[keyword \u200b\u5173\u952e\u200b\u53e5\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b\uff0c\u200b\u5b57\u4f53\u200b\u540c\u200b\u526f\u6807\u9898\u200b\uff0c\u200b\u989c\u8272\u200b\u540c\u200b\u5173\u952e\u200b\u8272\u200b',\n'body': '''[body \u200b\u6b63\u6587\u200b] \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u652f\u6301\u200b\u81ea\u52a8\u200b\u6362\u884c\u200b/\u200b\u591a\u884c\u200b\u6587\u672c\u200b\uff0c\n\u200b\u5de6\u200b\u5bf9\u9f50\u200b\u663e\u793a\u200b''',\n'icon': '...'\n}\n)\n</code></pre> <p>\u200b\u6ce8\u610f\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u5b57\u5178\u200b\u7c7b\u578b\u200b\u4f5c\u4e3a\u200b\u53c2\u6570\u200b\u6dfb\u52a0\u200b\u5361\u7247\u200b\uff0c\u200b\u597d\u5904\u200b\u662f\u200b\u65b9\u4fbf\u200b\u4fee\u6539\u200b\u5361\u7247\u200b\u7c7b\u578b\u200b\uff0c\u200b\u7f3a\u70b9\u200b\u662f\u200b\u6ca1\u6709\u200b\u4ee3\u7801\u200b\u63d0\u793a\u200b\u3001\u200b\u5bb9\u6613\u200b\u6253\u9519\u5b57\u200b\u6bb5\u200b\u540d\u79f0\u200b\uff0c\u200b\u6240\u4ee5\u200b\uff0c\u200b\u8bf7\u200b\u5c0f\u5fc3\u200b\u68c0\u67e5\u200b\u5b57\u5178\u200b\u4e2d\u200b\u7684\u200b\u952e\u200b\uff01</p>"},{"location":"api/draw-card/#generateimage","title":"generateImage() \u200b\u751f\u6210\u200b\u5e76\u200b\u4fdd\u5b58","text":"<p>\u200b\u4f7f\u7528\u200b <code>ResponseImage.generateImage(savePath)</code> \u200b\u51fd\u6570\u200b\u751f\u6210\u200b\u56fe\u7247\u200b\u5e76\u200b\u4fdd\u5b58\u200b\u56fe\u7247\u200b\u5230\u200b\u786c\u76d8\u200b\u3002</p> <p>\u200b\u51fd\u6570\u200b\u8fd4\u56de\u503c\u200b\u662f\u200b\u4e00\u4e2a\u200b PIL.Image \u200b\u5bf9\u8c61\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5bf9\u6b64\u200b\u5bf9\u8c61\u200b\u4f7f\u7528\u200b pillow \u200b\u5e93\u200b\u7ee7\u7eed\u200b\u7f16\u8f91\u200b\u3002</p> <p>\u200b\u51fd\u6570\u53c2\u6570\u200b\u5982\u4e0b\u200b\uff1a</p> \u200b\u53c2\u6570\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u53d6\u503c\u200b\u8bf4\u660e\u200b \u200b\u5907\u6ce8\u200b savePath \u200b\u4fdd\u5b58\u200b\u5730\u5740\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u56fe\u7247\u200b\u7684\u200b\u4fdd\u5b58\u200b\u5730\u5740\u200b \u200b\u53ef\u200b\u9009\u200b\uff0c\u200b\u9ed8\u8ba4\u200b\u4e3a\u7a7a\u200b (\u200b\u4e0d\u200b\u4fdd\u5b58\u200b)"},{"location":"api/draw-card/#getblankcoord","title":"getBlankCoord() \u200b\u83b7\u53d6\u200b\u7a7a\u767d\u200b\u5361\u7247\u200b\u5750\u6807","text":"<p>\u200b\u4f7f\u7528\u200b <code>ResponseImage.getBlankCoord()</code> \u200b\u83b7\u5f97\u200b BlankCard \u200b\u7c7b\u578b\u200b\u5361\u7247\u200b\u7684\u200b\u4f4d\u7f6e\u200b\u3002</p> <p>\u200b\u51fd\u6570\u200b\u8fd4\u56de\u503c\u200b\u662f\u200b\u4e00\u4e2a\u200b\u5217\u8868\u200b\uff0c\u200b\u5217\u8868\u200b\u6bcf\u9879\u200b\u662f\u200b\u4e00\u200b BlankCard \u200b\u7c7b\u578b\u200b\u5361\u7247\u200b\u56db\u89d2\u200b\u7684\u200b\u5750\u6807\u200b\u3002\u200b\u4f7f\u7528\u200b\u6b64\u200b\u5750\u6807\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200b\u6dfb\u52a0\u200b\u7684\u200b\u7a7a\u767d\u200b\u5361\u7247\u200b\u5904\u200b\u7ed8\u5236\u200b\u3002</p>"},{"location":"api/draw-card/#_4","title":"\u5e38\u91cf\u200b\u5217\u8868","text":"<p>\u200b\u5e93\u4e2d\u200b\u9884\u8bbe\u200b\u4e86\u200b\u4e00\u4e9b\u200b\u989c\u8272\u200b\u5e38\u91cf\u200b\uff0c\u200b\u65b9\u4fbf\u200b\u5f00\u53d1\u8005\u200b\u7edf\u4e00\u200b\u989c\u8272\u200b</p>"},{"location":"api/draw-card/#_5","title":"\u6807\u51c6\u200b\u989c\u8272\u200b\u5e38\u91cf","text":"\u5e38\u91cf\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u793a\u4f8b\u200b PALETTE_BLACK \u200b\u9ed1\u8272\u200b (0, 0, 0, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_WHITE \u200b\u767d\u8272\u200b (255, 255, 255, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_GERY \u200b\u7070\u8272\u200b (158, 158, 158, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_GREY_SUBTITLE \u200b\u7070\u8272\u200b(\u200b\u526f\u6807\u9898\u200b) (95, 95, 95, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_GREY_CONTENT \u200b\u7070\u8272\u200b(\u200b\u6b63\u6587\u200b) (125, 125, 125, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_GERY_BORDER \u200b\u7070\u8272\u200b(\u200b\u8fb9\u6846\u200b) (213, 213, 213, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_GERY_BACK \u200b\u7070\u8272\u200b(\u200b\u80cc\u666f\u200b) (240, 240, 240, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_RED \u200b\u7ea2\u8272\u200b (221, 0, 38, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_LIGHTRED \u200b\u6d45\u200b\u7ea2\u8272\u200b (255, 232, 236, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_GREEN \u200b\u7eff\u8272\u200b (0, 191, 48, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_LIGHTGREEN \u200b\u6d45\u7eff\u8272\u200b (219, 255, 228, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_ORANGE \u200b\u6a59\u8272\u200b (244, 149, 4, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_LIGHTORANGE \u200b\u6d45\u200b\u6a59\u8272\u200b (254, 232, 199, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_BLUE \u200b\u84dd\u8272\u200b (32, 131, 197, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_LIGHTBLUE \u200b\u6d45\u84dd\u8272\u200b (9, 188, 211, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_CYAN \u200b\u9752\u8272\u200b (0, 150, 136, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_INDIGO \u200b\u975b\u84dd\u8272\u200b (69, 84, 164, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57"},{"location":"api/draw-card/#sjtu","title":"SJTU \u200b\u89c6\u89c9\u200b\u6807\u51c6\u200b\u8272\u200b\u5e38\u91cf","text":"<p>\u200b\u4ee5\u4e0b\u200b\u989c\u8272\u200b\u6ee1\u8db3\u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b\u89c6\u89c9\u200b\u8bc6\u522b\u7cfb\u7edf\u200b\u7684\u200b\u989c\u8272\u200b\u6807\u51c6\u200b</p> \u200b\u5e38\u91cf\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u793a\u4f8b\u200b PALETTE_SJTU_RED \u200b\u4ea4\u200b\u5927\u7ea2\u200b (200, 22, 30, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_SJTU_DARKRED \u200b\u4ea4\u5927\u200b\u6697\u7ea2\u200b (167, 32, 56, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_SJTU_ORANGE \u200b\u4ea4\u5927\u200b\u6a59\u200b (240, 131, 0, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_SJTU_YELLOW \u200b\u4ea4\u5927\u200b\u9ec4\u200b (253, 208, 0, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_SJTU_BLUE \u200b\u4ea4\u5927\u200b\u84dd\u200b (0, 134, 209, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_SJTU_DARKBLUE \u200b\u4ea4\u5927\u200b\u6697\u84dd\u200b (0, 64, 152, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_SJTU_GREEN \u200b\u4ea4\u5927\u200b\u7eff\u200b (51, 141, 39, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57\u200b PALETTE_SJTU_CYAN \u200b\u4ea4\u5927\u200b\u9752\u200b (0, 81, 78, 255) \u200b\u793a\u4f8b\u200b\u6587\u5b57"},{"location":"api/send/","title":"\u9a71\u52a8\u5668\u200b\u5bf9\u63a5","text":"<p>\u200b\u9a71\u52a8\u5668\u200b\u5bf9\u63a5\u200b\u5305\u542b\u200b\u5404\u7c7b\u200b\u4e0e\u200bgo-cqhttp\u200b\u4ea4\u4e92\u200b\u7684\u200b\u51fd\u6570\u200b\u3002</p> <p>\u200b\u5176\u4e2d\u200b\u6700\u200b\u91cd\u8981\u200b\u7684\u200b\u5373\u200b\u53d1\u9001\u4fe1\u606f\u200b\u7684\u200b\u51fd\u6570\u200b <code>send</code> \uff0c\u200b\u53c2\u6570\u4fe1\u606f\u200b\u5982\u4e0b\u200b\uff1a</p> \u200b\u53c2\u6570\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u53d6\u503c\u200b\u8bf4\u660e\u200b \u200b\u5907\u6ce8\u200b id \u200b\u4fdd\u5b58\u200b\u5730\u5740\u200b int\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u8981\u200b\u53d1\u9001\u200b\u7684\u200b\u7fa4\u53f7\u200b\u6216\u8005\u200b\u5bf9\u8c61\u200bqq\u200b\u53f7\u200b message \u200b\u6d88\u606f\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u8981\u200b\u53d1\u9001\u200b\u7684\u200b\u6d88\u606f\u200b \u200b\u5982\u200b\u8981\u200b\u53d1\u9001\u200b\u56fe\u7247\u200b\u3001\u200b\u97f3\u9891\u200b\u3001\u200b\u8868\u60c5\u200b\u3001\u200b\u6587\u4ef6\u200b\u7b49\u200b\uff0c\u200b\u8bf7\u200b\u4f7f\u7528\u200b cq\u200b\u7801\u200b\u8f6c\u4e49\u200b type \u200b\u7c7b\u578b\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u8981\u200b\u53d1\u9001\u200b\u7684\u200b\u6d88\u606f\u200b\u7c7b\u578b\u200b \u200b\u7fa4\u804a\u200b\uff1a'group'\uff1b\u200b\u79c1\u804a\u200b\uff1a'private' <p>\u200b\u5173\u4e8e\u200b\u5176\u4ed6\u200b\u5bf9\u63a5\u200b\u51fd\u6570\u200b\u5373\u200b\u529f\u80fd\u200b\uff08\u200b\u5982\u200b\u83b7\u53d6\u200b\u7fa4\u804a\u200b\u5217\u8868\u200b\uff0c\u200b\u83b7\u53d6\u200b\u7fa4\u804a\u200b\u5386\u53f2\u8bb0\u5f55\u200b\uff09\uff0c\u200b\u8bf7\u200b\u53c2\u89c1\u200b\u4e0b\u65b9\u200b\u4ee3\u7801\u200b\u5206\u6790\u200b\uff1a</p>"},{"location":"api/send/#_1","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>def get_avatar_pic(id: int)-&gt;Union[None, bytes]:\n\"\"\"\u200b\u83b7\u53d6\u200bQQ\u200b\u5934\u50cf\u200b\n    @id: qq\u200b\u53f7\u200b\n    @return:\n        None if QQ\u200b\u5934\u50cf\u200b\u83b7\u53d6\u200b\u5931\u8d25\u200b\n        bytes if QQ\u200b\u5934\u50cf\u200b\u83b7\u53d6\u200b\u6210\u529f\u200b\n    \"\"\"\nurl_avatar = requests.get(f'http://q2.qlogo.cn/headimg_dl?dst_uin={id}&amp;spec=100')\nif url_avatar.status_code != requests.codes.ok:\nreturn None\nelse:\nreturn url_avatar.content\ndef send(id: int, message: str, type:str='group')-&gt;None:\n\"\"\"\u200b\u53d1\u9001\u200b\u6d88\u606f\u200b\n    id: \u200b\u7fa4\u53f7\u200b\u6216\u8005\u200b\u79c1\u804a\u200b\u5bf9\u8c61\u200bqq\u200b\u53f7\u200b\n    message: \u200b\u6d88\u606f\u200b\n    type: Union['group', 'private'], \u200b\u9ed8\u8ba4\u200b 'group'\n    \"\"\"\nurl = HTTP_URL+\"/send_msg\"\nif type=='group':\nparams = {\n\"message_type\": type,\n\"group_id\": id,\n\"message\": message\n}\nprint(params)\nrequests.get(url, params=params)\nelif type=='private':\nparams = {\n\"message_type\": type,\n\"user_id\": id,\n\"message\": message\n}\nprint(params)\nrequests.get(url, params=params)\ndef get_group_list()-&gt;list:\n\"\"\"\u200b\u83b7\u53d6\u200b\u7fa4\u804a\u200b\u5217\u8868\u200b\n    @return:\n        [\n            {\n                'group_create_time': int,\n                'group_id': int,\n                'group_name': str,\n                'group_level': int,\n                'max_member_count': int,\n                'member_count': int,\n            },\n            ....\n        ]\n    \u200b\u53c2\u8003\u200b\u94fe\u63a5\u200b\uff1a https://docs.go-cqhttp.org/api/#%E8%8E%B7%E5%8F%96%E7%BE%A4%E5%88%97%E8%A1%A8\n    \"\"\"\nurl = HTTP_URL+\"/get_group_list\"\ntry:\ngroupList = json.loads(requests.get(url).text)\nif groupList['status'] != 'ok':\nwarning(\"get_group_list requests not return ok\")\nreturn []\nreturn groupList['data']\nexcept BaseException as e:\nwarning(\"error in get_group_list, error: {}\".format(e))\nreturn []\ndef get_group_msg_history(group_id: int, message_seq: Union[int, None]=None)-&gt;list:\n\"\"\"\u200b\u83b7\u53d6\u200b\u7fa4\u200b\u6d88\u606f\u200b\u5386\u53f2\u8bb0\u5f55\u200b\n    @message_seq:\n        \u200b\u8d77\u59cb\u200b\u6d88\u606f\u200b\u5e8f\u53f7\u200b, \u200b\u53ef\u200b\u901a\u8fc7\u200b get_msg \u200b\u83b7\u5f97\u200b\n        \u200b\u5982\u679c\u200b\u662f\u200bNone\u200b\u5c06\u200b\u9ed8\u8ba4\u200b\u83b7\u53d6\u200b\u6700\u65b0\u200b\u7684\u200b\u6d88\u606f\u200b\n    @group_id: \u200b\u7fa4\u53f7\u200b\n    @return: \u200b\u4ece\u200b\u8d77\u59cb\u200b\u5e8f\u53f7\u200b\u5f00\u59cb\u200b\u7684\u200b\u524d\u200b19\u200b\u6761\u200b\u6d88\u606f\u200b\n    \u200b\u53c2\u8003\u200b\u94fe\u63a5\u200b\uff1a https://docs.go-cqhttp.org/api/#%E8%8E%B7%E5%8F%96%E7%BE%A4%E6%B6%88%E6%81%AF%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95\n    \"\"\"\nurl = HTTP_URL+\"/get_group_msg_history\"\ntry:\nparams = {\n\"group_id\": group_id\n}\nif message_seq != None:\nparams[\"message_seq\"] = message_seq\nmessageHistory = json.loads(requests.get(url, params=params).text)\nif messageHistory['status'] != 'ok':\nif messageHistory['msg'] == 'MESSAGES_API_ERROR':\nprint(\"group {} meet message API error\".format(group_id))\nelse:\nwarning(\"get_group_msg_history requests not return ok\\nmessages = {}\\ngroup_id={}\\nmessage_seq={}\".format(\nmessageHistory, group_id, message_seq))\nreturn []\nreturn messageHistory['data']['messages']\nexcept BaseException as e:\nwarning('error in get_group_msg_history, error: [}'.format(e))\nreturn []\ndef get_essence_msg_list(group_id: int)-&gt;list:\n\"\"\"\u200b\u83b7\u53d6\u200b\u7cbe\u534e\u200b\u6d88\u606f\u200b\u5217\u8868\u200b\n    @group_id:  \u200b\u7fa4\u53f7\u200b\n    @return:    \u200b\u7cbe\u534e\u200b\u6d88\u606f\u200b\u5217\u8868\u200b\n    \"\"\"\nurl = HTTP_URL+\"/get_essence_msg_list\"\ntry:\nparams = {\n\"group_id\": group_id\n}\nessenceMsgs = json.loads(requests.get(url, params=params).text)\nif essenceMsgs['status'] != 'ok':\nwarning(\"get_essence_msg_list requests not return ok\")\nreturn []\nreturn essenceMsgs['data']\nexcept BaseException as e:\nwarning(\"error in get_essence_msg_list, error: {}\".format(e))\nreturn []\ndef set_friend_add_request(flag, approve=True)-&gt;None:\n\"\"\"\u200b\u5904\u7406\u200b\u52a0\u200b\u597d\u53cb\u200b\"\"\"\nurl = HTTP_URL+\"/set_friend_add_request\"\nparams = {\n\"flag\": flag,\n\"approve\": approve\n}\nprint(params)\nrequests.get(url, params=params)\n</code></pre>"},{"location":"api/warning/","title":"\u8fd0\u884c\u200b\u65f6\u200b\u8b66\u544a","text":""},{"location":"api/warning/#warning-api","title":"warning API \u200b\u7b80\u4ecb","text":"<p>\u200b\u63d2\u4ef6\u200b\u5728\u200b\u5de5\u4f5c\u200b\u65f6\u200b\u96be\u514d\u200b\u9047\u5230\u200b\u8fd0\u884c\u200b\u65f6\u200b\u9519\u8bef\u200b\uff0c\u200b\u6bcf\u6b21\u200b\u767b\u5f55\u200b\u670d\u52a1\u5668\u200b\u7ffb\u627e\u200b\u7ec8\u7aef\u200b log \u200b\u4ee5\u200b\u5b9a\u4f4d\u200b\u9519\u8bef\u200b\u65e0\u7591\u200b\u662f\u200b\u4e00\u4e2a\u200b\u7e41\u7410\u200b\u7684\u200b\u8fc7\u7a0b\u200b\u3002</p> <p>\u200b\u5229\u7528\u200b <code>try-except</code> \u200b\u673a\u5236\u200b\u4e0e\u200b Bot \u200b\u63d0\u4f9b\u200b\u7684\u200b <code>warning()</code> \u200b\u51fd\u6570\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5c06\u200b\u8fd0\u884c\u200b\u4e2d\u200b\u7684\u200b\u9519\u8bef\u4fe1\u606f\u200b\u901a\u8fc7\u200b QQ \u200b\u53d1\u9001\u7ed9\u200b\u8d85\u7ea7\u200b\u7ba1\u7406\u5458\u200b\uff08\u200b\u5373\u200b <code>utils/basicConfig.py</code> \u200b\u4e2d\u200b ROOT_ADMIN_ID \u200b\u5217\u8868\u200b\u4e2d\u200b\u7684\u200b\u8d26\u53f7\u200b\uff09</p>"},{"location":"api/warning/#_1","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>def warning(what:str)-&gt;None:\n\"\"\"warning to admins\"\"\"\nstack = traceback.format_exc()\nwhat = '[warning]\\n' + what \nwhat += '\\n\\n[location]\\n' + stack\nadmin_users = ROOT_ADMIN_ID\nadmin_groups = []\nfor admin in admin_users:\nsend(admin, what, 'private')\nfor admin in admin_groups:\nsend(admin, what, 'group')\n</code></pre>"},{"location":"get-start/deployment/","title":"\u90e8\u7f72\u200b Bot","text":"<p>\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u7684\u200b\u4e00\u7cfb\u5217\u200b\u73af\u5883\u200b\u5b89\u88c5\u200b\uff0c\u200b\u7ec8\u4e8e\u200b\u5230\u200b\u4e86\u200b Bot \u200b\u7684\u200b\u90e8\u7f72\u200b\u73af\u8282\u200b\uff01</p>"},{"location":"get-start/deployment/#_1","title":"\u5bf9\u63a5\u200b\u9a71\u52a8\u5668","text":"<p>\u200b\u9996\u5148\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u4ee3\u7801\u200b\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200b\u7aef\u53e3\u53f7\u200b\uff0c\u200b\u4f7f\u200b Bot \u200b\u4e0e\u200b\u4e4b\u524d\u200b\u6240\u200b\u914d\u7f6e\u200b\u7684\u200b\u9a71\u52a8\u5668\u200b\uff08go-cqhttp\uff09\u200b\u76f8\u5bf9\u200b\u63a5\u200b\u3002</p> <p>\u200b\u5047\u8bbe\u200b\u5728\u200b go-cqhttp \u200b\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b config.yml \u200b\u4e2d\u200b\u914d\u7f6e\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>- http:\naddress: 127.0.0.1:5700\n...\npost:  - url: http://127.0.0.1:5701/ </code></pre> <p>\u200b\u63a5\u6536\u200b\u7aef\u53e3\u53f7\u200b\u4e3a\u200b 5700 \uff0c\u200b\u53cd\u5411\u200b POST \u200b\u7aef\u53e3\u53f7\u200b\u4e3a\u200b 5701 \u3002\u200b\u5bf9\u5e94\u200b\u4fee\u6539\u200b <code>utils/basicConfig.py</code> \u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>HTTP_URL = \"http://127.0.0.1:5700\"\n</code></pre> <p>\u200b\u4fee\u6539\u200b <code>main.py</code> \u200b\u4e2d\u200b\u6700\u540e\u200b\u4e00\u884c\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>if __name__ == '__main__':\napp.run(host=\"127.0.0.1\", port=5701)\n</code></pre>"},{"location":"get-start/deployment/#_2","title":"\u8d26\u53f7\u200b\u76f8\u5173\u200b\u914d\u7f6e","text":"<p>\u200b\u5b8c\u6210\u200b\u5bf9\u63a5\u200b\u540e\u200b\uff0c\u200b\u8bf7\u200b\u7ee7\u7eed\u200b\u4fee\u6539\u200b <code>utils/basicConfig.py</code> \u3002\u200b\u793a\u4f8b\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>APPLY_GROUP_ID = [111, 222]\nROOT_ADMIN_ID = [333, 444]\nBOT_SELF_QQ = 555\nVERSION_TXT = '\u200b\u7248\u672c\u53f7\u200b1.0'\nsqlConfig = {\n'host': '127.0.0.1',\n'user': 'root',\n'passwd': {YOUR_SQL_PASSWORD}\n}\nTXT_PERMISSION_DENIED = \"\u200b\u8be5\u200b\u529f\u80fd\u200b\u5c1a\u672a\u200b\u6253\u5f00\u200b\u54e6\u200b\"\n</code></pre> <p>\u200b\u4ee5\u4e0a\u200b\u5404\u200b\u5e38\u91cf\u200b\u7684\u200b\u5177\u4f53\u200b\u89e3\u91ca\u200b\u5982\u4e0b\u200b\uff1a</p> \u200b\u5e38\u91cf\u200b\u540d\u79f0\u200b \u200b\u63cf\u8ff0\u200b \u200b\u53d6\u503c\u200b \u200b\u53d6\u503c\u200b\u8bf4\u660e\u200b \u200b\u5907\u6ce8\u200b APPLY_GROUP_ID \u200b\u54cd\u5e94\u200b\u7fa4\u200b\u5217\u8868\u200b list\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u6307\u5b9a\u200b Bot \u200b\u54cd\u5e94\u200b\u7684\u200b\u7fa4\u804a\u200b\u53f7\u7801\u200b \u200b\u5982\u200b Bot \u200b\u52a0\u5165\u200b\u67d0\u7fa4\u200b\u4f46\u200b\u5217\u8868\u200b\u4e2d\u65e0\u6b64\u200b\u7fa4\u7fa4\u200b\u53f7\u200b\uff0c\u200b\u5219\u200b Bot \u200b\u5bf9\u200b\u8be5\u200b\u7fa4\u200b\u6240\u6709\u200b\u4fe1\u606f\u200b\u5747\u200b\u4e0d\u200b\u505a\u200b\u54cd\u5e94\u200b ROOT_ADMIN_ID \u200b\u8d85\u7ea7\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b list\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u8d85\u7ea7\u200b\u7ba1\u7406\u5458\u200b\u7684\u200b QQ \u200b\u53f7\u7801\u200b \u200b\u8d85\u7ea7\u200b\u7ba1\u7406\u5458\u200b\u53ef\u4ee5\u200b\u63a5\u6536\u200b\u8fd0\u884c\u200b\u65f6\u200b\u8b66\u544a\u200b\uff0c\u200b\u5e76\u200b\u901a\u8fc7\u200b\u547d\u4ee4\u200b\u914d\u7f6e\u200b\u5404\u4e2a\u200b\u7fa4\u804a\u200b\u7684\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\u3001\u200b\u4e3a\u200b\u5404\u4e2a\u200b\u7fa4\u804a\u200b\u6dfb\u52a0\u200b Bot \u200b\u7ba1\u7406\u5458\u200b BOT_SELF_QQ Bot \u200b\u81ea\u8eab\u200b\u8d26\u53f7\u200b int\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b Bot \u200b\u81ea\u8eab\u200b QQ \u200b\u53f7\u200b VERSION_TXT \u200b\u7248\u672c\u4fe1\u606f\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u5f53\u524d\u200b Bot \u200b\u7684\u200b\u7248\u672c\u53f7\u200b\u548c\u200b\u66f4\u65b0\u200b\u63cf\u8ff0\u200b\u7b49\u200b \u200b\u8be5\u200b\u4fe1\u606f\u200b\u5c06\u200b\u5728\u200b\u6536\u5230\u200b -test status \u200b\u4fe1\u606f\u200b\u65f6\u200b\u56de\u590d\u200b sqlConfig SQL \u200b\u51ed\u8bc1\u200b dict\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b\u8fde\u63a5\u200b MySQL \u200b\u7684\u200b\u51ed\u8bc1\u200b \u200b\u8fde\u63a5\u200b MySQL \u200b\u6240\u200b\u9700\u200b\u7684\u200b\u5730\u5740\u200b\u3001\u200b\u8d26\u53f7\u200b\uff08\u200b\u901a\u5e38\u200b\u662f\u200broot\uff09\u3001\u200b\u5bc6\u7801\u200b TXT_PERMISSION_DENIED \u200b\u65e0\u200b\u6743\u9650\u200b\u4fe1\u606f\u200b str\u200b\u578b\u200b\u53d8\u91cf\u200b \u200b\u8868\u793a\u200b Bot \u200b\u529f\u80fd\u200b\u672a\u200b\u5f00\u542f\u200b\u65f6\u200b\u7684\u200b\u56de\u590d\u200b \u200b\u8be5\u200b\u4fe1\u606f\u200b\u5c06\u200b\u5728\u200b\u7528\u6237\u200b\u8bd5\u56fe\u200b\u4f7f\u7528\u200b Bot \u200b\u672a\u200b\u5f00\u542f\u200b\u529f\u80fd\u200b\u65f6\u200b\u56de\u590d\u200b\uff08\u200b\u8bbe\u7f6e\u200b\u4e3a\u7a7a\u200b\uff0c\u200b\u53ef\u200b\u9002\u5f53\u200b\u51cf\u5c11\u200b\u5237\u5c4f\u200b\uff09"},{"location":"get-start/deployment/#bot_1","title":"\u542f\u52a8\u200b Bot","text":"<p>\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u914d\u7f6e\u200b\u540e\u200b\uff0c\u200b\u606d\u559c\u200b\u4f60\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u542f\u52a8\u200b Bot \u200b\u4e86\u200b\uff01\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\u542f\u52a8\u200b Bot \uff1a</p> <pre><code>python main.py\n</code></pre> <p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u540e\u53f0\u200b\u8fd0\u884c\u200b\u4e0e\u200b\u591a\u200b\u7ec8\u7aef\u200b\u7ba1\u7406\u200b</p> <p>Linux\u200b\u73af\u5883\u200b\u4e0b\u200b\uff0c\u200b\u63a8\u8350\u200b\u4f7f\u7528\u200b tmux \u200b\u7ba1\u7406\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b tmux \u200b\u4e2d\u200b\u65b0\u5efa\u200b\u4e00\u4e2a\u200b session \u200b\u4ee5\u540e\u200b\u53f0\u200b\u8fd0\u884c\u200b bot</p> <p>\u200b\u82e5\u200b <code>main.py</code> \u200b\u6240\u5728\u200b\u7ec8\u7aef\u200b\u5728\u200b\u542f\u7528\u200b Bot \u200b\u7684\u200b\u7fa4\u6709\u200b\u65b0\u200b\u4fe1\u606f\u200b\u65f6\u6709\u200b\u8f93\u51fa\u200b\u4e14\u200b\u5207\u6362\u200b\u81f3\u200b go-cqhttp \u200b\u6240\u5728\u200b\u7ec8\u7aef\u200b\u4e0d\u518d\u200b\u8f93\u51fa\u200b\u201c\u200b\u4e0a\u62a5\u200b\u9519\u8bef\u200b\u201d\uff0c\u200b\u5219\u200b\u8bf4\u660e\u200b Bot \u200b\u4e0e\u200b\u9a71\u52a8\u5668\u200b\u8fde\u63a5\u200b\u6210\u529f\u200b\u3002\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200b\u542f\u7528\u200b Bot \u200b\u7684\u200b\u7fa4\u200b\u53d1\u9001\u200b <code>-test status</code> \u200b\u547d\u4ee4\u200b\uff0c\u200b\u89c2\u5bdf\u200b Bot \u200b\u662f\u5426\u200b\u56de\u5e94\u200b\u4ee5\u200b\u8fdb\u4e00\u6b65\u200b\u6d4b\u8bd5\u200b\u3002</p>"},{"location":"get-start/installation/","title":"\u5b89\u88c5\u200b\u5411\u5bfc","text":"<p>\u200b\u6b22\u8fce\u200b\u6765\u5230\u200b Little-UNIkeEN-Bot \u200b\u7684\u200b\u5b89\u88c5\u200b\u5411\u5bfc\u200b\uff01</p>"},{"location":"get-start/installation/#1-bot","title":"1. \u200b\u5b89\u88c5\u200b Bot","text":"<p>\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u4ece\u200b Github \u200b\u4e0b\u8f7d\u200b Little-UNIkeEN-Bot \u200b\u9879\u76ee\u200b\u3002\u200b\u76f4\u63a5\u200b\u514b\u9686\u200b\u6211\u4eec\u200b\u7684\u200b Git \u200b\u4ed3\u5e93\u200b\u5373\u53ef\u200b\u5b8c\u6210\u200b\u5b89\u88c5\u200b\uff1a <pre><code>git clone git@github.com:UNIkeEN/Little-UNIkeEN-Bot.git\n</code></pre></p>"},{"location":"get-start/installation/#2","title":"2. \u200b\u8fd0\u884c\u200b\u5e73\u53f0","text":""},{"location":"get-start/installation/#21","title":"2.1 \u200b\u63a8\u8350\u200b\u5e73\u53f0","text":"<ul> <li>Linux (Ubuntu 20.04 LTS)</li> <li>python &gt;= 3.7</li> <li>mysql &gt;= 8.0</li> </ul> <p>\u200b\u4f5c\u8005\u200b\u662f\u200b\u5728\u200bLinux\u200b\u5e73\u53f0\u200b\u90e8\u7f72\u200b\u5f00\u53d1\u200b\u7684\u200b\uff0c\u200b\u6709\u200b\u6781\u5c11\u200b\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u7684\u200b\u547d\u4ee4\u200b\u662f\u200b shell \u200b\u683c\u5f0f\u200b\u3002\u200b\u7531\u4e8e\u200b\u65f6\u95f4\u200b\u7cbe\u529b\u6709\u9650\u200b\uff0c <code>1.0</code> \u200b\u7248\u672c\u200b\u5e76\u672a\u200b\u5728\u200b\u5176\u4ed6\u200b\u5e73\u53f0\u200b\u5f00\u53d1\u200b\u6d4b\u8bd5\u200b\uff0c\u200b\u56e0\u6b64\u200b\u63a8\u8350\u200b\u5728\u200b Linux \u200b\u90e8\u7f72\u200b\u3002Windows \u200b\u5e73\u53f0\u200b\u4e0b\u200b\u4ea6\u200b\u53ef\u4ee5\u200b\u8fd0\u884c\u200b\u5927\u90e8\u5206\u200b\u63d2\u4ef6\u200b\u3002</p> <p>\u200b\u4f5c\u8005\u200b\u9009\u7528\u200b\u7684\u200b\u662f\u200b\u817e\u8baf\u200b\u4e91\u200b\u65b0\u4eba\u200b\u4f18\u60e0\u200b\u670d\u52a1\u5668\u200b ( 4\u200b\u6838\u200b/8G/10M/\u200b\u4e00\u5e74\u200b )\uff0c\u200b\u7cfb\u7edf\u200b\u9009\u7528\u200b ubuntu 20.04 LTS\u3002</p> <p>\u200b\u62ff\u5230\u200b\u670d\u52a1\u5668\u200b\u9996\u5148\u200b\u8fdb\u884c\u200b\u6362\u6e90\u200b\uff0c\u200b\u7f51\u4e0a\u200b\u80fd\u200b\u641c\u5230\u200b\u5f88\u591a\u200b\u6559\u7a0b\u200b eg\u3002</p> <p>\u200b\u7136\u540e\u200b\u5c31\u662f\u200b\u5e38\u89c1\u200b\u7f16\u8bd1\u200b\u5de5\u5177\u200b\u7684\u200b\u5b89\u88c5\u200b (make/cmake) \uff0c\u200b\u6b64\u200b\u6b65\u9aa4\u200b\u53ef\u200b\u8df3\u200b\u8fc7\u200b\u3002</p>"},{"location":"get-start/installation/#22-windows","title":"2.2 Windows\u200b\u5e73\u53f0","text":"<p>\u200b\u7531\u4e8e\u200b\u4f5c\u8005\u200b\u61d2\u5f97\u200b\u5199\u200b\u8de8\u5e73\u53f0\u200b\u7684\u200b\u4ee3\u7801\u200b\uff0c\u200b\u6240\u4ee5\u200bbot\u200b\u6709\u200b\u6781\u5c11\u6570\u200b\u529f\u80fd\u200b\u5728\u200bwindows\u200b\u5e73\u53f0\u200b\u4e0a\u200b\u65e0\u6cd5\u200b\u4f7f\u7528\u200b\uff1a</p> <ul> <li>monitor</li> <li>kill browsermob in sjtuDekt plugin</li> </ul>"},{"location":"get-start/installation/#3","title":"3. \u200b\u57fa\u7840\u200b\u4f9d\u8d56","text":"<p>Little-Unicorn-Bot\u200b\u6709\u200b\u4ee5\u4e0b\u200b\u4e09\u5927\u200b\u57fa\u7840\u200b\u4f9d\u8d56\u200b\uff0c\u200b\u5fc5\u987b\u200b\u5b89\u88c5\u200b\u4ed6\u4eec\u200b\u4ee8\u200b\u624d\u80fd\u200b\u8fd0\u884c\u200bbot\uff1a</p> <ul> <li>python</li> <li>go-cqhttp</li> <li>mysql</li> </ul> <p>\u200b\u63a5\u4e0b\u6765\u200b\u4e09\u7ae0\u200b\u5c06\u200b\u4ecb\u7ecd\u200b\u5982\u4f55\u200b\u5b89\u88c5\u200b\u8fd9\u200b\u4e09\u4e2a\u200b\u57fa\u7840\u200b\u4f9d\u8d56\u200b</p>"},{"location":"get-start/question/","title":"\u9047\u5230\u200b\u95ee\u9898","text":"<p>\u200b\u5982\u679c\u200b\u4f60\u200b\u5728\u200b\u90e8\u7f72\u200b\u4e0e\u200b\u5f00\u53d1\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u9047\u5230\u200b\u95ee\u9898\u200b\u6216\u200b\u6709\u6240\u200b\u5efa\u8bae\u200b\uff0c\u200b\u6b22\u8fce\u200b\u70b9\u51fb\u200b\u4e0b\u65b9\u200b\u94fe\u63a5\u200b\u5411\u200b\u6211\u4eec\u200b\u63d0\u51fa\u200b issue</p> <p>Github | Little-UNIkeEN-Bot</p> <p>\u200b\u95ee\u9898\u200b\u8bf7\u200b\u4f7f\u7528\u200b Question \u200b\u6a21\u677f\u200b~</p>"},{"location":"get-start/question/#_2","title":"\u5e38\u89c1\u95ee\u9898","text":"<ol> <li> <p>QQ\u200b\u7fa4\u4e2d\u200b\u53d1\u9001\u200b\u547d\u4ee4\u200b\u65f6\u200b\u56fe\u7247\u200b\u89e3\u6790\u200b\u51fa\u73b0\u200b\u9519\u8bef\u200b</p> <p>\u200b\u89e3\u51b3\u200b\u65b9\u6cd5\u200b\uff1a\u200b\u6253\u5f00\u200bplugins/help_v2.py\uff0c\u200b\u7b2c\u200b46\u200b\u884c\u4e2d\u200b\u6539\u4e3a\u200b[CQ:image,file=files:///%s]\uff08\u200b\u6ce8\u610f\u200b\u4e09\u200b\u659c\u6760\u200b\uff09 ps\uff1a\u200b\u8be5\u200b\u9519\u8bef\u200b\u76ee\u524d\u200b\u51fa\u73b0\u200b\u5728\u200bWindows\u200b\u7cfb\u7edf\u200b\u4e2d\u200b\uff0cLinux\u200b\u672a\u77e5\u200b</p> </li> <li> <p>\u200b\u8fd0\u884c\u200bmain.py\u200b\u65f6\u62a5\u200b\u9519\u200b\uff0c\u200b\u6d89\u53ca\u200bbilibili_api\u200b\u7684\u200b\u63d2\u4ef6\u200b\u5168\u90e8\u200b\u62a5\u9519\u200b</p> <p>\u200b\u89e3\u51b3\u200b\u65b9\u6cd5\u200b\uff1a\u200b\u6ce8\u610f\u200b\u5b89\u88c5\u200b\u7684\u200b\u662f\u200b<code>bilibili-api-python</code>\u200b\u5305\u800c\u200b\u4e0d\u662f\u200b<code>bilibili_api</code>\u200b\u5305\u200b\uff0c\u200b\u4e24\u4e2a\u200b\u4e0d\u200b\u4e00\u6837\u200b <code>bilibili-api-python</code> \u200b\u9879\u76ee\u200b\u94fe\u63a5\u200b</p> </li> <li> <p>mysql_connector\u200b\u7248\u672c\u200b\u9519\u8bef\u200b</p> <p>\u200b\u62a5\u9519\u200b\uff0cpip\u200b\u91cd\u88c5\u200b\u975e\u200bunpackaged\u200b\u7684\u200b\u5305\u540e\u200b\u62a5\u9519\u200b\u6d88\u5931\u200b\uff0c\u200b\u4e5f\u200b\u53ef\u80fd\u200b\u662f\u200b\u6ca1\u88c5\u200bsql\u200b\u7684\u200b\u95ee\u9898\u200b\u3002Windows\u200b\u4e0a\u88c5\u200bmysql\u200b\u53ef\u200b\u53c2\u8003\u200bhttps://blog.csdn.net/qq_52232736/article/details/123407099</p> </li> <li> <p>config.yml\u200b\u4e2d\u200b\uff0c\u200b\u7b2c\u200b108-111\u200b\u884c\u200b\u53d6\u6d88\u200b\u6ce8\u91ca\u200b\u8fdb\u884c\u200b\u7f16\u8f91\u200b\u540e\u200b\u6ce8\u610f\u200b\u7f29\u8fdb\u200b\u95ee\u9898\u200b\uff08VSCode\u200b\u4e2d\u200b\uff09</p> </li> </ol>"},{"location":"get-start/set-driver/","title":"\u914d\u7f6e\u200b go-cqhttp","text":"<p>Little-UNIkeEN-Bot \u200b\u662f\u200b QQ \u200b\u673a\u5668\u4eba\u200b\u524d\u7aef\u200b\uff0c\u200b\u53ea\u80fd\u200b\u5904\u7406\u200b\u4ea4\u4e92\u200b\u903b\u8f91\u200b\uff0c\u200b\u4e0d\u80fd\u200b\u76f4\u63a5\u200b\u5b9e\u73b0\u200b QQ \u200b\u673a\u5668\u4eba\u200b\u7684\u200b\u6240\u6709\u200b\u529f\u80fd\u200b\u3002\u200b\u6211\u4eec\u200b\u9700\u8981\u200b\u989d\u5916\u200b\u5b89\u88c5\u200b\u9a71\u52a8\u5668\u200b\u6765\u200b\u5b9e\u73b0\u200b\u4e0e\u200bQQ\u200b\u670d\u52a1\u5668\u200b\u7684\u200b\u4fe1\u606f\u200b\u6536\u53d1\u200b\u4e0e\u200b\u4ea4\u4e92\u200b\u3002</p>"},{"location":"get-start/set-driver/#1-go-cqhttp","title":"1. \u200b\u5b89\u88c5\u200b go-cqhttp","text":"<p>\u200b\u672c\u200b Bot \u200b\u9ed8\u8ba4\u200b\u4f7f\u7528\u200b go-cqhttp \u200b\u4f5c\u4e3a\u200b\u9a71\u52a8\u5668\u200b\uff0c\u200b\u8fd9\u662f\u200b\u4e00\u4e2a\u200b\u4f18\u79c0\u200b\u7684\u200b\u65e0\u5934\u200b QQ \u200b\u5ba2\u6237\u7aef\u200b\uff0c\u200b\u5173\u4e8e\u200b\u5176\u200b\u5b89\u88c5\u200b\u8bf7\u200b\u89c1\u200b go-cqhttp\u200b\u5b98\u7f51\u200b - \u200b\u5b89\u88c5\u200b \u3002</p>"},{"location":"get-start/set-driver/#2-go-cqhttp","title":"2. \u200b\u914d\u7f6e\u200b go-cqhttp","text":"<p>\u200b\u5b89\u88c5\u200b\u5b8c\u6210\u200b\u540e\u200b\uff0c\u200b\u7b2c\u4e00\u6b21\u200b\u6253\u5f00\u200b go-cqhttp \u200b\u65f6\u8bf7\u200b\u9009\u62e9\u200b\u201cHTTP\u200b\u901a\u4fe1\u200b\u201d\uff0c\u200b\u7136\u540e\u200b\u4fee\u6539\u200b\u751f\u6210\u200b\u7684\u200b <code>config.yml</code> \u200b\u6587\u4ef6\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code># go-cqhttp \u200b\u9ed8\u8ba4\u200b\u914d\u7f6e\u6587\u4ef6\u200b\naccount: # \u200b\u8d26\u53f7\u200b\u76f8\u5173\u200b\nuin: {\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u7684\u200b\u5730\u65b9\u200b1} # QQ\u200b\u8d26\u53f7\u200b\npassword:  {\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u7684\u200b\u5730\u65b9\u200b2} # \u200b\u5bc6\u7801\u200b\u4e3a\u200b\u7a7a\u65f6\u200b\u4f7f\u7528\u200b\u626b\u7801\u200b\u767b\u5f55\u200b\nencrypt: false  # \u200b\u662f\u5426\u200b\u5f00\u542f\u200b\u5bc6\u7801\u200b\u52a0\u5bc6\u200b\nstatus: 0      # \u200b\u5728\u7ebf\u200b\u72b6\u6001\u200b \u200b\u8bf7\u200b\u53c2\u8003\u200b https://docs.go-cqhttp.org/guide/config.html#\u200b\u5728\u7ebf\u200b\u72b6\u6001\u200b\nrelogin: # \u200b\u91cd\u8fde\u200b\u8bbe\u7f6e\u200b\ndelay: 3   # \u200b\u9996\u6b21\u200b\u91cd\u8fde\u200b\u5ef6\u8fdf\u200b, \u200b\u5355\u4f4d\u200b\u79d2\u200b\ninterval: 3   # \u200b\u91cd\u8fde\u200b\u95f4\u9694\u200b\nmax-times: 0  # \u200b\u6700\u5927\u200b\u91cd\u8fde\u200b\u6b21\u6570\u200b, 0\u200b\u4e3a\u200b\u65e0\u200b\u9650\u5236\u200b\n# \u200b\u662f\u5426\u200b\u4f7f\u7528\u200b\u670d\u52a1\u5668\u200b\u4e0b\u53d1\u200b\u7684\u200b\u65b0\u200b\u5730\u5740\u200b\u8fdb\u884c\u200b\u91cd\u8fde\u200b\n# \u200b\u6ce8\u610f\u200b, \u200b\u6b64\u200b\u8bbe\u7f6e\u200b\u53ef\u80fd\u200b\u5bfc\u81f4\u200b\u5728\u200b\u6d77\u5916\u200b\u670d\u52a1\u5668\u200b\u4e0a\u200b\u8fde\u63a5\u200b\u60c5\u51b5\u200b\u66f4\u5dee\u200b\nuse-sso-address: false\n# \u200b\u662f\u5426\u200b\u5141\u8bb8\u200b\u53d1\u9001\u200b\u4e34\u65f6\u200b\u4f1a\u8bdd\u200b\u6d88\u606f\u200b\nallow-temp-session: true\nsign-server:  {\u200b\u9700\u8981\u200b\u4fee\u6539\u200b\u7684\u200b\u5730\u65b9\u200b3} # \u200b\u7b7e\u540d\u200b\u670d\u52a1\u5668\u200b\uff0c\u200b\u63a8\u8350\u200b 'https://qsign.loli.vet/'\nheartbeat:\n# \u200b\u5fc3\u8df3\u200b\u9891\u7387\u200b, \u200b\u5355\u4f4d\u200b\u79d2\u200b\n# -1 \u200b\u4e3a\u200b\u5173\u95ed\u200b\u5fc3\u8df3\u200b\ninterval: 5\nmessage:\n# \u200b\u4e0a\u62a5\u200b\u6570\u636e\u7c7b\u578b\u200b\n# \u200b\u53ef\u200b\u9009\u200b: string,array\npost-format: string\n# \u200b\u662f\u5426\u200b\u5ffd\u7565\u200b\u65e0\u6548\u200b\u7684\u200bCQ\u200b\u7801\u200b, \u200b\u5982\u679c\u200b\u4e3a\u200b\u5047\u200b\u5c06\u200b\u539f\u6837\u200b\u53d1\u9001\u200b\nignore-invalid-cqcode: false\n# \u200b\u662f\u5426\u200b\u5f3a\u5236\u200b\u5206\u7247\u200b\u53d1\u9001\u200b\u6d88\u606f\u200b\n# \u200b\u5206\u7247\u200b\u53d1\u9001\u200b\u5c06\u4f1a\u200b\u5e26\u6765\u200b\u66f4\u5feb\u200b\u7684\u200b\u901f\u5ea6\u200b\n# \u200b\u4f46\u662f\u200b\u517c\u5bb9\u6027\u200b\u4f1a\u200b\u6709\u4e9b\u200b\u95ee\u9898\u200b\nforce-fragment: false\n# \u200b\u662f\u5426\u200b\u5c06\u200burl\u200b\u5206\u7247\u200b\u53d1\u9001\u200b\nfix-url: false\n# \u200b\u4e0b\u8f7d\u200b\u56fe\u7247\u200b\u7b49\u200b\u8bf7\u6c42\u200b\u7f51\u7edc\u200b\u4ee3\u7406\u200b\nproxy-rewrite: ''\n# \u200b\u662f\u5426\u200b\u4e0a\u62a5\u200b\u81ea\u8eab\u200b\u6d88\u606f\u200b\nreport-self-message: false\n# \u200b\u79fb\u9664\u200b\u670d\u52a1\u7aef\u200b\u7684\u200bReply\u200b\u9644\u5e26\u200b\u7684\u200bAt\nremove-reply-at: false\n# \u200b\u4e3a\u200bReply\u200b\u9644\u52a0\u200b\u66f4\u200b\u591a\u200b\u4fe1\u606f\u200b\nextra-reply-data: false\n# \u200b\u8df3\u8fc7\u200b Mime \u200b\u626b\u63cf\u200b, \u200b\u5ffd\u7565\u200b\u9519\u8bef\u200b\u6570\u636e\u200b\nskip-mime-scan: false\noutput:\n# \u200b\u65e5\u5fd7\u200b\u7b49\u7ea7\u200b trace,debug,info,warn,error\nlog-level: warn\n# \u200b\u65e5\u5fd7\u200b\u65f6\u6548\u200b \u200b\u5355\u4f4d\u200b\u5929\u200b. \u200b\u8d85\u8fc7\u200b\u8fd9\u4e2a\u200b\u65f6\u95f4\u200b\u4e4b\u524d\u200b\u7684\u200b\u65e5\u5fd7\u200b\u5c06\u4f1a\u200b\u88ab\u200b\u81ea\u52a8\u200b\u5220\u9664\u200b. \u200b\u8bbe\u7f6e\u200b\u4e3a\u200b 0 \u200b\u8868\u793a\u200b\u6c38\u4e45\u200b\u4fdd\u7559\u200b.\nlog-aging: 15\n# \u200b\u662f\u5426\u200b\u5728\u200b\u6bcf\u6b21\u200b\u542f\u52a8\u200b\u65f6\u200b\u5f3a\u5236\u200b\u521b\u5efa\u200b\u5168\u65b0\u200b\u7684\u200b\u6587\u4ef6\u200b\u50a8\u5b58\u200b\u65e5\u5fd7\u200b. \u200b\u4e3a\u200b false \u200b\u7684\u200b\u60c5\u51b5\u200b\u4e0b\u200b\u5c06\u200b\u4f1a\u200b\u5728\u200b\u4e0a\u6b21\u200b\u542f\u52a8\u200b\u65f6\u200b\u521b\u5efa\u200b\u7684\u200b\u65e5\u5fd7\u200b\u6587\u4ef6\u200b\u7eed\u5199\u200b\nlog-force-new: true\n# \u200b\u662f\u5426\u200b\u542f\u7528\u200b\u65e5\u5fd7\u200b\u989c\u8272\u200b\nlog-colorful: true\n# \u200b\u662f\u5426\u200b\u542f\u7528\u200b DEBUG\ndebug: false # \u200b\u5f00\u542f\u200b\u8c03\u8bd5\u6a21\u5f0f\u200b\n# \u200b\u9ed8\u8ba4\u200b\u4e2d\u95f4\u4ef6\u200b\u951a\u70b9\u200b\ndefault-middlewares: &amp;default\n# \u200b\u8bbf\u95ee\u200b\u5bc6\u94a5\u200b, \u200b\u5f3a\u70c8\u63a8\u8350\u200b\u5728\u200b\u516c\u7f51\u200b\u7684\u200b\u670d\u52a1\u5668\u200b\u8bbe\u7f6e\u200b\naccess-token: ''\n# \u200b\u4e8b\u4ef6\u200b\u8fc7\u6ee4\u5668\u200b\u6587\u4ef6\u76ee\u5f55\u200b\nfilter: ''\n# API\u200b\u9650\u901f\u200b\u8bbe\u7f6e\u200b\n# \u200b\u8be5\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b\u5168\u5c40\u200b\u751f\u6548\u200b\n# \u200b\u539f\u200b cqhttp \u200b\u867d\u7136\u200b\u542f\u7528\u200b\u4e86\u200b rate_limit \u200b\u540e\u7f00\u200b, \u200b\u4f46\u662f\u200b\u57fa\u672c\u200b\u6ca1\u200b\u63d2\u4ef6\u200b\u9002\u914d\u200b\n# \u200b\u76ee\u524d\u200b\u8be5\u200b\u9650\u901f\u200b\u8bbe\u7f6e\u200b\u4e3a\u200b\u4ee4\u724c\u200b\u6876\u200b\u7b97\u6cd5\u200b, \u200b\u8bf7\u200b\u53c2\u8003\u200b:\n# https://baike.baidu.com/item/%E4%BB%A4%E7%89%8C%E6%A1%B6%E7%AE%97%E6%B3%95/6597000?fr=aladdin\nrate-limit:\nenabled: false # \u200b\u662f\u5426\u200b\u542f\u7528\u200b\u9650\u901f\u200b\nfrequency: 1  # \u200b\u4ee4\u724c\u200b\u56de\u590d\u200b\u9891\u7387\u200b, \u200b\u5355\u4f4d\u200b\u79d2\u200b\nbucket: 1     # \u200b\u4ee4\u724c\u200b\u6876\u200b\u5927\u5c0f\u200b\ndatabase: # \u200b\u6570\u636e\u5e93\u200b\u76f8\u5173\u200b\u8bbe\u7f6e\u200b\nleveldb:\n# \u200b\u662f\u5426\u200b\u542f\u7528\u200b\u5185\u7f6e\u200bleveldb\u200b\u6570\u636e\u5e93\u200b\n# \u200b\u542f\u7528\u200b\u5c06\u4f1a\u200b\u589e\u52a0\u200b10-20MB\u200b\u7684\u200b\u5185\u5b58\u200b\u5360\u7528\u200b\u548c\u200b\u4e00\u5b9a\u200b\u7684\u200b\u78c1\u76d8\u7a7a\u95f4\u200b\n# \u200b\u5173\u95ed\u200b\u5c06\u200b\u65e0\u6cd5\u200b\u4f7f\u7528\u200b \u200b\u64a4\u56de\u200b \u200b\u56de\u590d\u200b get_msg \u200b\u7b49\u200b\u4e0a\u4e0b\u6587\u200b\u76f8\u5173\u200b\u529f\u80fd\u200b\nenable: true\n# \u200b\u5a92\u4f53\u6587\u4ef6\u200b\u7f13\u5b58\u200b\uff0c \u200b\u5220\u9664\u200b\u6b64\u9879\u200b\u5219\u200b\u4f7f\u7528\u200b\u7f13\u5b58\u200b\u6587\u4ef6\u200b(\u200b\u65e7\u7248\u200b\u884c\u4e3a\u200b)\ncache:\nimage: data/image.db\nvideo: data/video.db\n# \u200b\u8fde\u63a5\u200b\u670d\u52a1\u200b\u5217\u8868\u200b\nservers:\n# \u200b\u6dfb\u52a0\u200b\u65b9\u5f0f\u200b\uff0c\u200b\u540c\u4e00\u200b\u8fde\u63a5\u200b\u65b9\u5f0f\u200b\u53ef\u200b\u6dfb\u52a0\u200b\u591a\u4e2a\u200b\uff0c\u200b\u5177\u4f53\u200b\u914d\u7f6e\u200b\u8bf4\u660e\u200b\u8bf7\u200b\u67e5\u770b\u200b\u6587\u6863\u200b\n#- http: # http \u200b\u901a\u4fe1\u200b\n#- ws:   # \u200b\u6b63\u5411\u200b Websocket\n#- ws-reverse: # \u200b\u53cd\u5411\u200b Websocket\n#- pprof: #\u200b\u6027\u80fd\u200b\u5206\u6790\u200b\u670d\u52a1\u5668\u200b\n- http: # HTTP \u200b\u901a\u4fe1\u200b\u8bbe\u7f6e\u200b\naddress: 127.0.0.1:5701 # HTTP\u200b\u76d1\u542c\u200b\u5730\u5740\u200b\ntimeout: 5      # \u200b\u53cd\u5411\u200b HTTP \u200b\u8d85\u65f6\u200b\u65f6\u95f4\u200b, \u200b\u5355\u4f4d\u200b\u79d2\u200b\uff0c&lt;5 \u200b\u65f6\u200b\u5c06\u200b\u88ab\u200b\u5ffd\u7565\u200b\nlong-polling:   # \u200b\u957f\u200b\u8f6e\u8be2\u200b\u62d3\u5c55\u200b\nenabled: false       # \u200b\u662f\u5426\u200b\u5f00\u542f\u200b\nmax-queue-size: 2000 # \u200b\u6d88\u606f\u200b\u961f\u5217\u200b\u5927\u5c0f\u200b\uff0c0 \u200b\u8868\u793a\u200b\u4e0d\u200b\u9650\u5236\u200b\u961f\u5217\u200b\u5927\u5c0f\u200b\uff0c\u200b\u8c28\u614e\u200b\u4f7f\u7528\u200b\nmiddlewares:\n&lt;&lt;: *default # \u200b\u5f15\u7528\u200b\u9ed8\u8ba4\u200b\u4e2d\u95f4\u4ef6\u200b\npost:           # \u200b\u53cd\u5411\u200bHTTP POST\u200b\u5730\u5740\u200b\u5217\u8868\u200b\n#- url: ''                # \u200b\u5730\u5740\u200b\n#  secret: ''             # \u200b\u5bc6\u94a5\u200b\n#  max-retries: 3         # \u200b\u6700\u5927\u200b\u91cd\u8bd5\u200b\uff0c0 \u200b\u65f6\u200b\u7981\u7528\u200b\n#  retries-interval: 1500 # \u200b\u91cd\u8bd5\u200b\u65f6\u95f4\u200b\uff0c\u200b\u5355\u4f4d\u200b\u6beb\u79d2\u200b\uff0c0 \u200b\u65f6\u200b\u7acb\u5373\u200b\n- url: http://127.0.0.1:5986/ # \u200b\u5730\u5740\u200b\nsecret: ''                  # \u200b\u5bc6\u94a5\u200b\nmax-retries: 0            # \u200b\u6700\u5927\u200b\u91cd\u8bd5\u200b\uff0c0 \u200b\u65f6\u200b\u7981\u7528\u200b\nretries-interval: 3000      # \u200b\u91cd\u8bd5\u200b\u65f6\u95f4\u200b\uff0c\u200b\u5355\u4f4d\u200b\u6beb\u79d2\u200b\uff0c0 \u200b\u65f6\u200b\u7acb\u5373\u200b\n</code></pre> <p>\u200b\u8bf7\u200b\u8bb0\u4f4f\u200b\u4e24\u5904\u200b\u9ad8\u4eae\u200b\u5904\u200b\u60a8\u200b\u8bbe\u7f6e\u200b\u7684\u200b\u7aef\u53e3\u53f7\u200b\uff0c\u200b\u5728\u200b\"\u200b\u90e8\u7f72\u200b Bot\"\u200b\u4e00\u8282\u200b\uff0c\u200b\u6211\u4eec\u200b\u5c06\u200b\u518d\u6b21\u200b\u7528\u5230\u200b\u3002</p> <p>\u200b\u914d\u7f6e\u6587\u4ef6\u200b\u4e2d\u200b\u7684\u200b\u5176\u4f59\u90e8\u5206\u200b\uff08\u200b\u5982\u200b\u8d26\u53f7\u200b\u767b\u9646\u200b\u72b6\u6001\u200b\uff0c\u200b\u6d88\u606f\u200b\u53d1\u9001\u200b\u91cd\u8bd5\u200b\u6b21\u6570\u200b\u7b49\u200b\uff09\uff0c\u200b\u4f60\u200b\u5747\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u6ce8\u91ca\u200b\uff0c\u200b\u6309\u200b\u9700\u200b\u66f4\u6539\u200b\u3002</p>"},{"location":"get-start/set-driver/#3-go-cqhttp","title":"3. \u200b\u542f\u52a8\u200b go-cqhttp","text":"<p>\u200b\u5b8c\u6210\u200b\u4e0a\u8ff0\u200b\u914d\u7f6e\u200b\u540e\u200b\uff0c\u200b\u60a8\u200b\u53ef\u4ee5\u200b\u542f\u52a8\u200b go-cqhttp\u3002</p> <p>Windows \u200b\u73af\u5883\u200b\u4e0b\u200b\u76f4\u63a5\u200b\u8fd0\u884c\u200b go-cqhttp.bat</p> <p>Linux \u200b\u73af\u5883\u200b\u4e0b\u200b\uff0c\u200b\u5728\u200b go-cqhttp \u200b\u76ee\u5f55\u200b\u4e0b\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\u4ee5\u200b\u8fd0\u884c\u200b</p> <pre><code>./go-cqhttp # \u200b\u8001\u200b\u7248\u672c\u200bgocqhttp\u200b\u662f\u200b\u53ef\u6267\u884c\u6587\u4ef6\u200b\ngo-cqhttp   # v1.1.0\u200b\u7248\u672c\u200bgocqhttp\u200b\u662f\u200bdpkg\u200b\u5305\u200b\uff0c\u200b\u4f1a\u200b\u5b89\u88c5\u200b\u5230\u200bbin\u200b\u6587\u4ef6\u5939\u200b\u4e0b\u200b\n</code></pre> <p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u540e\u53f0\u200b\u8fd0\u884c\u200b\u4e0e\u200b\u591a\u200b\u7ec8\u7aef\u200b\u7ba1\u7406\u200b</p> <p>Linux\u200b\u73af\u5883\u200b\u4e0b\u200b\uff0c\u200b\u63a8\u8350\u200b\u4f7f\u7528\u200b tmux \u200b\u7ba1\u7406\u200b\u7ec8\u7aef\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b tmux \u200b\u4e2d\u200b\u65b0\u5efa\u200b\u4e00\u4e2a\u200b session \u200b\u4ee5\u540e\u200b\u53f0\u200b\u8fd0\u884c\u200b go-cqhttp</p>"},{"location":"get-start/set-driver/#4","title":"4. \u200b\u767b\u5f55\u200b\u95ee\u9898","text":"<p>\u200b\u5728\u200b\u4f7f\u7528\u200b go-cqhttp \u200b\u767b\u5f55\u200b\u4f60\u200b\u7684\u200b Bot \u200b\u8d26\u53f7\u200b\u65f6\u200b\uff0c\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u9047\u5230\u200b\u5b89\u5168\u200b\u9a8c\u8bc1\u200b\u3002\u200b\u5728\u200b\u5b89\u5168\u200b\u9a8c\u8bc1\u200b\u4e4b\u524d\u200b\uff0c\u200b\u9996\u5148\u200b\u628a\u200b <code>device.json</code> \u200b\u7684\u200b <code>\"protocol\"</code> \u200b\u503c\u200b\u6539\u6210\u200b5\uff0c\u200b\u53c2\u8003\u200b\u8bbe\u5907\u200b\u578b\u53f7\u200b\u3002</p> <p></p> <p>\u200b\u5f53\u200b\u51fa\u73b0\u200b\u4ee5\u4e0a\u200b\u9009\u9879\u200b\u65f6\u200b\uff0c\u200b\u8bf7\u200b\u8f93\u5165\u200b2\uff0c\u200b\u5c06\u200b\u51fa\u73b0\u200b\u7684\u200b\u94fe\u63a5\u200b\u590d\u5236\u200b\u8fdb\u200b\u6d4f\u89c8\u5668\u200b\uff0c\u200b\u6309\u200bF12\u200b\u8fdb\u5165\u200b\u5f00\u53d1\u8005\u200b\u9009\u9879\u200b\u3002\u200b\u8f93\u5165\u200bcaptcha\u200b\u4ee5\u540e\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u7a97\u53e3\u200b\u4f1a\u200b\u6709\u200b\u5982\u4e0b\u200b\u663e\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u770b\u5230\u200b\u201c\u200b\u9884\u89c8\u200b\u201d-\u201cticket\u201d\u200b\u9009\u9879\u200b\uff0c\u200b\u53f3\u952e\u200bticket\uff0c\u200b\u9009\u62e9\u200b\u201c\u200b\u590d\u5236\u200b\u503c\u200b\u201d\uff0c\u200b\u7136\u540e\u200b\u5c06\u200b\u590d\u5236\u200b\u7684\u200b\u4e1c\u897f\u200b\u7c98\u8d34\u200b\u5230\u200bgo-cqhttp\u200b\u91cc\u200b\u3002</p> <p></p>"},{"location":"get-start/set-driver/#5","title":"5. \u200b\u6ce8\u610f","text":"<ol> <li>\u200b\u5982\u200b\u4f60\u200b\u5728\u200b\u670d\u52a1\u5668\u200b\u8fd0\u884c\u200b\uff0c\u200b\u7531\u4e8e\u200b\u626b\u7801\u200b\u624b\u673a\u200b\u4e0e\u200b\u670d\u52a1\u5668\u7aef\u200b\u901a\u5e38\u200b\u4e0d\u200b\u5728\u200b\u540c\u4e00\u200b\u7f51\u7edc\u200b\u73af\u5883\u200b\u4e0b\u200b\uff0c\u200b\u4f60\u200b\u53ef\u80fd\u200b\u4f1a\u200b\u9047\u5230\u200b\u626b\u7801\u200b\u5931\u8d25\u200b\u7684\u200b\u60c5\u51b5\u200b\u3002\u200b\u6b64\u65f6\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u5728\u200b\u672c\u673a\u200b\u4f7f\u7528\u200b go-cqhttp \u200b\u626b\u7801\u200b\u767b\u5f55\u200b\uff0c\u200b\u5e76\u200b\u5c06\u200b\u4ea7\u751f\u200b\u7684\u200b <code>device.json</code> \u200b\u548c\u200b <code>session.token</code> \u200b\u6587\u4ef6\u200b\u590d\u5236\u5230\u200b\u670d\u52a1\u5668\u200b\u7684\u200b go-cqhttp \u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff0c\u200b\u7136\u540e\u200b\u91cd\u65b0\u542f\u52a8\u200b go-cqhttp\u3002</li> <li>\u200b\u5982\u679c\u200bgocqhttp\u200b\u63d0\u793a\u200b\u5f53\u524d\u200bQQ\u200b\u7248\u672c\u200b\u8fc7\u4f4e\u200b\uff0c\u200b\u8bf7\u6362\u4e2a\u200b\u53f7\u200b\u91cd\u8bd5\u200b</li> </ol>"},{"location":"get-start/set-python/","title":"python\u200b\u5b89\u88c5\u200b\u4e0e\u200bpip\u200b\u5305\u200b\u4f9d\u8d56","text":""},{"location":"get-start/set-python/#1-python","title":"1. python\u200b\u5b89\u88c5","text":""},{"location":"get-start/set-python/#11-ubuntu2004-x64pythonminiconda","title":"1.1 \u200b\u63a8\u8350\u200b\u5e73\u53f0\u200b\u4e0b\u200b(ubuntu20.04 x64)\u200b\u7684\u200b\u63a8\u8350\u200bpython\u200b\u73af\u5883\u200b(Miniconda)\u200b\u5b89\u88c5","text":"<p>\u200b\u63a8\u8350\u200b\u4f7f\u7528\u200b Miniconda \u200b\u4f5c\u4e3a\u200b Python \u200b\u73af\u5883\u200b</p> <p>\u200b\u9996\u5148\u200b\uff0c\u200b\u6765\u5230\u200b\u6e05\u534e\u200b\u955c\u50cf\u200b\u7684\u200bminiconda\u200b\u9875\u9762\u200b\uff0c\u200b\u5728\u200b\u9875\u9762\u200b\u5185\u200b\u641c\u7d22\u200b\\\"latest\\\"\uff0c\u200b\u627e\u5230\u200b\\\"Miniconda3-latest-Linux-x86_64.sh\\\"\u200b\u7684\u200b\u4e0b\u8f7d\u200b\u94fe\u63a5\u200b\u3002\u200b\u63a5\u4e0b\u6765\u200b\u5728\u200b\u670d\u52a1\u5668\u200b\u547d\u4ee4\u884c\u200b\u65b0\u5efa\u200b <code>~/tmp</code> \u200b\u8def\u5f84\u200b\u4f5c\u4e3a\u200b\u4e0b\u8f7d\u200b\u7f13\u5b58\u200b\u8def\u5f84\u200b\uff0c\u200b\u8fdb\u5165\u200b\u5e76\u200b\u4e0b\u8f7d\u200b\u4e4b\u200b\uff0c\u200b\u63a8\u8350\u200b\u5b89\u88c5\u200b\u8def\u5f84\u200b\u4e3a\u200b <code>/usr/local/miniconda3</code> \uff0c\u200b\u5177\u4f53\u200b\u547d\u4ee4\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>mkdir ~/tmp\ncd ~/tmp\nwget https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda3-latest-Linux-x86_64.sh\nsudo bash Miniconda3-latest-Linux-x86_64.sh\n</code></pre> <p>\u200b\u5b89\u88c5\u200b\u5b8c\u200bconda\u200b\u540e\u200b\u4e5f\u200b\u8981\u200b\u5bf9\u200b conda/pip \u200b\u8fdb\u884c\u200b\u6362\u6e90\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u53c2\u89c1\u200b\u7f51\u4e0a\u200b\u6559\u7a0b\u200b eg\u3002</p>"},{"location":"get-start/set-python/#12-windowspythonminiconda","title":"1.2 Windows\u200b\u4e0b\u200b\u7684\u200b\u63a8\u8350\u200bpython\u200b\u73af\u5883\u200b(Miniconda)\u200b\u5b89\u88c5","text":"<p>\u200b\u9996\u5148\u200b\uff0c\u200b\u6765\u5230\u200b\u6e05\u534e\u200b\u955c\u50cf\u200b\u7684\u200bminiconda\u200b\u9875\u9762\u200b\uff0c\u200b\u5728\u200b\u9875\u9762\u200b\u5185\u200b\u641c\u7d22\u200b\\\"latest\\\"\uff0c\u200b\u627e\u5230\u200b\\\"Miniconda3-latest-Windows-x86_64.exe\\\"\uff0c\u200b\u70b9\u51fb\u200b\u4e0b\u8f7d\u200b\uff0c\u200b\u7136\u540e\u200b\u53cc\u51fb\u200b\u8fd0\u884c\u200b\u4e4b\u200b\u3002</p> <p>\u200b\u5b89\u88c5\u7a0b\u5e8f\u200b\u8fd0\u884c\u200b\u5b8c\u6bd5\u200b\u540e\u200b\uff0c\u200b\u6253\u5f00\u200bpowershell\uff0c\u200b\u5982\u679c\u200b\u524d\u9762\u200b\u6ca1\u6709\u200b\u4ee5\u200b<code>(base) C:\\...&gt;</code>\u200b\u5b57\u6837\u200b\u5927\u5934\u200b\uff0c\u200b\u8bf7\u200b\u7528\u200b\u7ba1\u7406\u5458\u200b\u6743\u9650\u200b\u5f00\u542f\u200bpowershell\uff0c\u200b\u8f93\u5165\u200b\uff08\u200b\u6b32\u77e5\u200b\u8be6\u60c5\u200b\uff0c\u200b\u8bf7\u200b\u767e\u5ea6\u200b \u201cpowershell\u200b\u6267\u884c\u200b\u811a\u672c\u200b\u201d\uff09\uff1a</p> <pre><code>Set-ExecutionPolicy Unrestricted\n</code></pre> <p>\u200b\u91cd\u542f\u200bpowershell\uff0c\u200b\u5982\u679c\u200b\u770b\u5230\u200b\u4ee5\u200b<code>(base) C:\\...&gt;</code>\u200b\u5b57\u6837\u200b\u6253\u5934\u200b\uff0c\u200b\u4e14\u200b\u8f93\u5165\u200bpython\u200b\u80fd\u200b\u8fdb\u5165\u200b\u547d\u4ee4\u884c\u200b\uff0c\u200b\u5219\u200b\u5927\u529f\u544a\u6210\u200b\u3002</p> <p>\u200b\u5c06\u200bpython\u200b\u8def\u5f84\u200b\u6ce8\u518c\u200b\u5230\u200b\u7cfb\u7edf\u200bPATH</p> <p>\u200b\u5728\u200b\u6267\u884c\u200bMiniconda\u200b\u5b89\u88c5\u7a0b\u5e8f\u200b\u7a97\u53e3\u200b\uff0c\u200b\u5982\u679c\u200b\u770b\u5230\u200b\u5c06\u200bpython\u200b\u8def\u5f84\u200b\u6ce8\u518c\u200b\u5230\u200b\u7cfb\u7edf\u200bPATH\u200b\u9009\u9879\u200b\uff0c\u200b\u8bf7\u200b\u52fe\u9009\u200b\u4e4b\u200b</p>"},{"location":"get-start/set-python/#13-windowspython","title":"1.3 windows\u200b\u4e0b\u200bpython\u200b\u5b89\u88c5","text":"<p>\u200b\u8bf7\u200b\u81ea\u884c\u200b\u767e\u5ea6\u200b</p>"},{"location":"get-start/set-python/#2-pip","title":"2. pip\u200b\u5305\u200b\u4f9d\u8d56","text":"<p>\u200b\u672c\u200b\u9879\u76ee\u200b\u7684\u200bPython\u200b\u5305\u200b\u4f9d\u8d56\u200b\u90fd\u200b\u5199\u200b\u5728\u200b\u4e86\u200b\u6839\u76ee\u5f55\u200b\u4e0b\u200b\u7684\u200b <code>requirements.txt</code> \u200b\u6587\u4ef6\u200b\u4e2d\u200b\uff0c\u200b\u4f7f\u7528\u200b\u65f6\u200b\u53ea\u200b\u9700\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\u5373\u53ef\u200b\u5b89\u88c5\u200b\u3002</p> <pre><code>pip install -r requirements.txt\n</code></pre> <p>\u200b\u63d2\u4ef6\u200bimport\u200b\u9519\u8bef\u200b\u89e3\u51b3\u200b\u65b9\u6cd5\u200b</p> <p>\u200b\u5982\u679c\u200b\u5728\u200bimport\u200b\u63d2\u4ef6\u200b\u65f6\u62a5\u200b\u9519\u200b\u67d0\u4e2a\u200bpip\u200b\u5305\u200b\u4f9d\u8d56\u200b\u9519\u8bef\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u6ce8\u91ca\u200b\u5148\u8be5\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u5c1d\u8bd5\u200b\u5148\u200b\u8ba9\u200bbot\u200b\u8dd1\u901a\u200b\uff0c\u200b\u7136\u540e\u200b\u518d\u200b\u60f3\u200b\u89e3\u51b3\u529e\u6cd5\u200bQwQ</p>"},{"location":"get-start/set-sql/","title":"\u914d\u7f6e\u200bSQL","text":"<p>Little-UNIkeEN-Bot \u200b\u5173\u4e8e\u200b\u7528\u6237\u200b\u6570\u636e\u200b\u3001\u200b\u529f\u80fd\u200b\u914d\u7f6e\u200b\u7b49\u200b\u6570\u636e\u200b\u5b58\u50a8\u200b\u5747\u200b\u662f\u200b\u57fa\u4e8e\u200b MySQL \u200b\u5b9e\u73b0\u200b\u7684\u200b\u3002\u200b\u5728\u200b\u8fd0\u884c\u200b Bot \u200b\u4e4b\u524d\u200b\uff0c\u200b\u4f60\u200b\u9700\u8981\u200b\u4e3a\u200b\u670d\u52a1\u5668\u200b\u5b89\u88c5\u200b MySQL \u200b\u73af\u5883\u200b\u3002</p> <p>\u200b\u5173\u4e8e\u200b MySQL \u200b\u7684\u200b\u5b89\u88c5\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u53c2\u89c1\u200b\u5982\u4e0b\u200b\u6559\u7a0b\u200b eg1 \uff0ceg2\u3002</p>"},{"location":"get-start/set-sql/#1-linuxmysql","title":"1. Linux\u200b\u4e0a\u200b\u5b89\u88c5\u200bmysql","text":"<p>\u200b\u9996\u5148\u200b\u5230\u200b MySQL\u200b\u5b98\u7f51\u200b \u200b\u4e0b\u8f7d\u200b\u5bf9\u5e94\u200b\u64cd\u4f5c\u7cfb\u7edf\u200b\u7684\u200b\u5305\u200b\uff0c\u200b\u641c\u7d22\u200b\u6761\u4ef6\u200b\u5982\u4e0b\u200b\uff08ProductVersion \u200b\u9009\u62e9\u200b\u6700\u65b0\u200b\uff0cOsVersion \u200b\u9009\u62e9\u200b\u76f8\u5e94\u200b\u7cfb\u7edf\u200b\u7248\u672c\u200b\uff09\uff1a</p> <p></p> <p>\u200b\u590d\u5236\u200b\u4e0b\u8f7d\u200b\u94fe\u63a5\u200b\u5e76\u200b\u5728\u200b\u7ec8\u7aef\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\uff1a</p> <pre><code># stage 1: download\ncd ~/tmp\nwget ${YOUR_COPIED_URL}\nsudo dpkg -i ${DOWNLOADED_DEB}\nsudo apt update\nsudo apt install mysql-server\n\n# stage 2: init\nsudo chown -R mysql:mysql /var/lib/mysql/\nmysqld --initialize\nsystemctl start mysqld\n</code></pre> <p>\u200b\u5b8c\u6210\u200b\u5b89\u88c5\u200b\u540e\u200b\uff0c\u200b\u4fee\u6539\u200b\u914d\u7f6e\u200b\u548c\u200b\u5bc6\u7801\u200b\uff0c\u200b\u6b64\u5904\u200b\u4e0d\u518d\u200b\u8d58\u8ff0\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\u4e0a\u8ff0\u200b\u7f51\u7ad9\u200b\u6559\u7a0b\u200b\u3002</p> <p>\u200b\u76f4\u5230\u200b\u4f60\u200b\u8f93\u5165\u200b\u4ee5\u4e0b\u200b\u547d\u4ee4\u200b\u540e\u200b\u53ef\u4ee5\u200b\u663e\u793a\u200b MySQL \u200b\u547d\u4ee4\u884c\u200b\uff0c\u200b\u4f60\u200b\u7684\u200b MySQL \u200b\u5b89\u88c5\u200b\u8fc7\u7a0b\u200b\u5c31\u7b97\u200b\u5927\u529f\u544a\u6210\u200b\u4e86\u200b\uff1a</p> <pre><code>mysql -u root -p\n</code></pre> <p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u53ef\u89c6\u5316\u200b</p> <p>\u200b\u5982\u679c\u200b\u4f60\u200b\u662f\u200b\u5728\u200b\u672c\u673a\u200b\u5b89\u88c5\u200bSQL\u200b\u7684\u8bdd\u200b\uff0c\u200b\u63a8\u8350\u200b MySQL Workbench \u200b\u4f5c\u4e3a\u200b MySQL \u200b\u53ef\u89c6\u5316\u200b\u5de5\u5177\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u65e7\u200b\u7684\u200b\u6570\u636e\u200b\u5b58\u50a8\u200b\u683c\u5f0f\u200b</p> <p>\u200b\u4e00\u4e9b\u200b\u5185\u6d4b\u200b\u65f6\u671f\u200b\u7684\u200b\u65e7\u7248\u200b\u529f\u80fd\u200b\u63d2\u4ef6\u200b\u53ef\u80fd\u200b\u4f7f\u7528\u200b JSON \u200b\u6587\u4ef6\u200b\u5b58\u50a8\u7528\u6237\u200b\u6570\u636e\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u81ea\u884c\u200b\u9009\u62e9\u200b\u4fee\u6539\u200b\u4e3a\u200b SQL \u200b\u5b58\u50a8\u200b\u3002\u200b\u51fa\u4e8e\u200b\u6027\u80fd\u200b\u4e0e\u200b\u7edf\u4e00\u5316\u200b\u8003\u91cf\u200b\uff0c\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u60a8\u200b\u4f7f\u7528\u200b SQL \u200b\u5b58\u50a8\u200b\u3002</p>"},{"location":"get-start/set-sql/#2-windowsmysql","title":"2. windows\u200b\u4e0a\u200b\u5b89\u88c5\u200bmysql","text":"<p>\u200b\u8bf7\u200b\u81ea\u884c\u200b\u767e\u5ea6\u200b</p>"},{"location":"plugin/introduction/","title":"\u63d2\u4ef6\u200b\u5165\u95e8","text":"<p>Little-UNIkeEN-Bot \u200b\u901a\u8fc7\u200b\u63d2\u4ef6\u200b\u673a\u5236\u200b\u5b9e\u73b0\u200b\u529f\u80fd\u200b\u7684\u200b\u5f00\u53d1\u200b\uff0c\u200b\u901a\u8fc7\u200b\u7ef4\u62a4\u200b\u63d2\u4ef6\u200b\u5217\u8868\u200b\u5b9e\u73b0\u200b\u529f\u80fd\u200b\u7684\u200b\u589e\u51cf\u200b\u3002</p>"},{"location":"plugin/introduction/#1-standardplugin","title":"1. \u200b\u804a\u5929\u200b\u63d2\u4ef6\u200b - StandardPlugin","text":""},{"location":"plugin/introduction/#_1","title":"\u63d2\u4ef6\u200b\u903b\u8f91","text":"<p>\u200b\u6240\u6709\u200b\u63a5\u6536\u200b\u79c1\u804a\u200b\u6d88\u606f\u200b\u548c\u200b\u7fa4\u200b\u6d88\u606f\u200b\u7684\u200b\u63d2\u4ef6\u200b\u90fd\u200b\u5fc5\u987b\u200b\u7ee7\u627f\u200b\u4e8e\u200b <code>StandardPlugin</code> \u200b\u7c7b\u200b\uff0c\u200b\u5e76\u200b\u5b9e\u73b0\u200b\u4ee5\u4e0b\u200b\u56db\u4e2a\u200b\u63a5\u53e3\u51fd\u6570\u200b\uff08\u200b\u524d\u200b\u4e09\u4e2a\u200b\u5fc5\u987b\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u6700\u540e\u200b\u4e00\u4e2a\u200b\u53ef\u200b\u9009\u200b\uff09\uff1a</p> \u200b\u63a5\u53e3\u200b\u540d\u79f0\u200b \u200b\u53c2\u6570\u200b \u200b\u8fd4\u56de\u503c\u200b\u7c7b\u578b\u200b \u200b\u4f5c\u7528\u200b judgeTrigger <code>@msg</code>: \u200b\u6d88\u606f\u200b\u6587\u672c\u200b\uff0c<code>str</code>\u200b\u7c7b\u578b\u200b<code>@data</code>: \u200b\u6d88\u606f\u200b\u6240\u200b\u5305\u62ec\u200b\u7684\u200b\u6240\u6709\u200b\u4fe1\u606f\u200b\uff0c<code>dict</code>\u200b\u7c7b\u578b\u200b <code>bool</code> \u200b\u5224\u65ad\u200b\u6b64\u200b\u63d2\u4ef6\u200b\u662f\u5426\u200b\u4f1a\u200b\u89e6\u53d1\u200b executeEvent <code>@msg</code>: \u200b\u6d88\u606f\u200b\u6587\u672c\u200b\uff0c<code>str</code>\u200b\u7c7b\u578b\u200b<code>@data</code>: \u200b\u6d88\u606f\u200b\u6240\u200b\u5305\u62ec\u200b\u7684\u200b\u6240\u6709\u200b\u4fe1\u606f\u200b\uff0c<code>dict</code>\u200b\u7c7b\u578b\u200b <code>str</code> \u200b\u6216\u8005\u200b <code>None</code> \u200b\u6267\u884c\u200b\u63d2\u4ef6\u200b\u903b\u8f91\u200b getPluginInfo <code>None</code> <code>dict</code> \u200b\u8fd4\u56de\u200b\u63d2\u4ef6\u200b\u4fe1\u606f\u200b onStateChange <code>@nextState</code>: \u200b\u4e0b\u200b\u4e00\u4e2a\u200b\u72b6\u6001\u200b\uff0c<code>bool</code>\u200b\u7c7b\u578b\u200b<code>@data</code>: \u200b\u6d88\u606f\u200b\u6240\u200b\u5305\u62ec\u200b\u7684\u200b\u6240\u6709\u200b\u4fe1\u606f\u200b\uff0c<code>dict</code>\u200b\u7c7b\u578b\u200b <code>None</code> \u200b\u5728\u200b\u5f00\u5173\u200b\u63d2\u4ef6\u200b\u7684\u200b\u65f6\u5019\u200b\u51fa\u53d1\u200b\u63d2\u4ef6\u200b\u7279\u5b9a\u200b\u903b\u8f91\u200b <p>\u200b\u5f00\u53d1\u8005\u200b\u5728\u200b <code>main.py</code> \u200b\u4e2d\u200b <code>import</code> \u200b\u529f\u80fd\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u5e76\u200b\u7ef4\u62a4\u200b <code>main.py</code> \u200b\u4e2d\u200b\u7684\u200b\u63d2\u4ef6\u200b\u5217\u8868\u200b\u4ee5\u200b\u589e\u51cf\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u5173\u4e8e\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5177\u4f53\u200b\u793a\u4f8b\u200b\u8bf7\u89c1\u200b\u4e0b\u200b\u4e00\u8282\u200b\u3002</p> <p>Bot \u200b\u8fd0\u884c\u200b\u6536\u5230\u200b\u7fa4\u804a\u200b/\u200b\u79c1\u804a\u200b\u6d88\u606f\u200b\u65f6\u200b\uff0c\u200b\u5c06\u200b\u904d\u5386\u200b\u7fa4\u804a\u200b/\u200b\u79c1\u804a\u200b\u63d2\u4ef6\u200b\u5217\u8868\u200b\uff0c\u200b\u9010\u4e00\u200b\u8c03\u7528\u200b\u5404\u200b\u63d2\u4ef6\u200b\u7684\u200b <code>judgeTrigger()</code> \u200b\u51fd\u6570\u200b\uff0c\u200b\u82e5\u200b\u8fd4\u56de\u503c\u200b\u4e3a\u200b\u771f\u5219\u200b\u89e6\u53d1\u200b\uff0c\u200b\u8c03\u7528\u200b\u8be5\u200b\u63d2\u4ef6\u200b\u7684\u200b <code>executeEvent()</code> \u200b\u51fd\u6570\u200b\u8fdb\u884c\u200b\u54cd\u5e94\u200b\u3002\u200b\u63d2\u4ef6\u200b\u7684\u200b <code>getPluginInfo()</code> \u200b\u51fd\u6570\u200b\u5219\u200b\u5728\u200b\u7528\u6237\u200b\u83b7\u53d6\u200b\u5e2e\u52a9\u200b\u4fe1\u606f\u200b\u65f6\u200b\u88ab\u200b\u9010\u4e00\u200b\u8c03\u7528\u200b\u3002</p> <p>\u200b\u7279\u522b\u5f3a\u8c03\u200b\uff0c\u200b\u5173\u4e8e\u200b <code>getPluginInfo()</code> \u200b\u7684\u200b\u8fd4\u56de\u503c\u200b\u683c\u5f0f\u200b\uff0c\u200b\u8981\u6c42\u200b\u5982\u4e0b\u200b\uff1a</p> <pre><code>{\n'name': 'Faq',                      # require\n'description': '\u200b\u95ee\u7b54\u200b\u5e93\u200b',             # require\n'commandDescription': '\u200b\u95ee\u200b [title]', # require\n'usePlace': ['group', 'private', ], # require\n'showInHelp': True,                 # suggest, default True\n'pluginConfigTableNames': ['Faq',], # suggest, must be unique among plugins\n'version': '1.0.0',                 # suggest\n'author': 'Unicorn',                # suggest\n...                                 # any other information you want\n}\n</code></pre> \u200b\u540d\u79f0\u200b \u200b\u7c7b\u578b\u200b \u200b\u4f5c\u7528\u200b \u200b\u662f\u5426\u200b\u5fc5\u987b\u200b 'name' <code>str</code> \u200b\u63d0\u793a\u200b\u8fd9\u4e2a\u200b\u63d2\u4ef6\u200b\u7684\u200bclass\u200b\u540d\u79f0\u200b \u200b\u662f\u200b 'description' <code>str</code> \u200b\u7b80\u8981\u200b\u63cf\u8ff0\u200b\u8fd9\u4e2a\u200b\u63d2\u4ef6\u200b \u200b\u662f\u200b 'commandDescription' <code>str</code> \u200b\u6982\u62ec\u200b\u89e6\u53d1\u200b\u8fd9\u4e2a\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5173\u952e\u8bcd\u200b \u200b\u662f\u200b 'usePlace' <code>list</code> \u200b\u63cf\u8ff0\u200b\u8fd9\u4e2a\u200b\u63d2\u4ef6\u200b\u7684\u200b\u4f5c\u7528\u57df\u200b'private': \u200b\u8fd9\u4e2a\u200b\u63d2\u4ef6\u200b\u53ef\u4ee5\u200b\u5728\u200b\u79c1\u804a\u200b\u5f00\u542f\u200b'group': \u200b\u8fd9\u4e2a\u200b\u63d2\u4ef6\u200b\u53ef\u4ee5\u200b\u5728\u200b\u7fa4\u804a\u200b\u5f00\u542f\u200b \u200b\u662f\u200b 'showInHelp' <code>bool</code> \u200b\u662f\u5426\u200b\u5728\u200bhelp\u200b\u65f6\u200b\u5c55\u793a\u200b \u200b\u5426\u200b\uff0c\u200b\u9ed8\u8ba4\u200b<code>True</code> 'pluginConfigTableNames' <code>list</code> \u200b\u8fd9\u4e2a\u200b\u63d2\u4ef6\u200b\u6240\u200b\u9700\u8981\u200b\u5360\u7528\u200b\u7684\u200b\u6570\u636e\u5e93\u200b\u8868\u540d\u200b\u3002\u200b\u6ce8\u610f\u200b\uff0c\u200b\u63d2\u4ef6\u200b\u5f00\u53d1\u8005\u200b\u521b\u5efa\u200b\u7684\u200bsql\u200b\u8868\u200b\u5c3d\u91cf\u200b\u6302\u200b\u5728\u200b<code>BOT_DATA</code>\u200b\u8fd9\u4e2a\u200b\u5e93\u200b\u4e0b\u9762\u200b\uff0c\u200b\u56e0\u6b64\u200b\u9700\u8981\u200b\u907f\u514d\u200b\u8868\u200b\u91cd\u540d\u200b\u3002 \u200b\u5426\u200b 'version' <code>str</code> \u200b\u63d2\u4ef6\u200b\u7248\u672c\u200b \u200b\u5426\u200b 'author' <code>str</code> \u200b\u63d2\u4ef6\u200b\u4f5c\u8005\u200b \u200b\u5426"},{"location":"plugin/introduction/#_2","title":"\u63d2\u4ef6\u200b\u793a\u8303","text":"<p>\u200b\u4ee5\u4e0b\u200b\u7684\u200b\u4ee3\u7801\u200b\u53ef\u4ee5\u200b\u5b9e\u73b0\u200b\uff0c\u200b\u5728\u200b\u7fa4\u804a\u200b\u6216\u200b\u79c1\u804a\u200b\u4e2d\u200b\u6709\u4eba\u200b\u53d1\u9001\u200b\u5173\u952e\u8bcd\u200b\u201c\u200b\u653e\u4e2a\u200b\u70df\u82b1\u200b\u201d\u200b\u6216\u200b\u201c\u200b\u70df\u82b1\u200b\u201d\u200b\u65f6\u200b\uff0cBot \u200b\u56de\u590d\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\u201c\u200b\u70df\u82b1\u200b\u201d\u3002</p> <p><code>plugins/superEmoji.py</code> \u200b\u4e2d\u200b\u5b9e\u73b0\u200b\u63d2\u4ef6\u200b\u529f\u80fd\u200b\u4ee3\u7801\u200b\uff1a</p> <pre><code>from typing import Union, Any\nfrom utils.basicEvent import *\nfrom utils.standardPlugin import StandardPlugin # \u200b\u5f15\u5165\u200bStandardPlugin\nclass FireworksFace(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u653e\u4e2a\u200b\u70df\u82b1\u200b','\u200b\u70df\u82b1\u200b']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, \"[CQ:face,id=333,type=sticker]\", data['message_type']) # \u200b\u53d1\u9001\u200b\u6d88\u606f\u200b\nreturn \"OK\"\ndef getPluginInfo(self, ) -&gt; dict:\nreturn {\n'name': 'FireworksFace',\n'description': '\u200b\u70df\u82b1\u200b',\n'commandDescription': '\u200b\u653e\u4e2a\u200b\u70df\u82b1\u200b/\u200b\u70df\u82b1\u200b',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre> <p>\u200b\u53d1\u9001\u200b\u6d88\u606f\u200b\u51fd\u6570\u200b <code>send()</code> \u200b\u7684\u200b\u5177\u4f53\u200b\u53c2\u6570\u200b\u4e0e\u200b\u529f\u80fd\u200b\u8bf7\u200b\u89c1\u200b API - \u200b\u9a71\u52a8\u5668\u200b\u5bf9\u63a5\u200b\u3002</p> <p>\u200b\u5728\u200b <code>main.py</code> \u200b\u7684\u200b\u63d2\u4ef6\u200b\u5217\u8868\u200b\u4e2d\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\uff1a</p> <pre><code>from plugins.superEmoji import *\n...\nGroupPluginList=[ # \u200b\u7fa4\u200b\u63d2\u4ef6\u200b\u5217\u8868\u200b\n..., FireworksFace(), # \u200b\u5728\u200b\u6b64\u5904\u200b\u6dfb\u52a0\u200b\u63d2\u4ef6\u200b\u7c7b\u4ee5\u200b\u5728\u200b\u7fa4\u804a\u200b\u65f6\u200b\u542f\u7528\u200b\n]\nPrivatePluginList=[ # \u200b\u79c1\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\n..., FireworksFace(), # \u200b\u5728\u200b\u6b64\u5904\u200b\u6dfb\u52a0\u200b\u63d2\u4ef6\u200b\u7c7b\u4ee5\u200b\u5728\u200b\u79c1\u804a\u200b\u65f6\u200b\u542f\u7528\u200b\n]\n</code></pre> <p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u4ee3\u7801\u200b\u7ed3\u6784\u200b</p> <p>\u200b\u4e3a\u200b\u4fbf\u4e8e\u7ba1\u7406\u200b\uff0c\u200b\u6211\u4eec\u200b\u63a8\u8350\u200b\u5c06\u200b\u529f\u80fd\u200b\u63d2\u4ef6\u200b\u7684\u200b\u4ee3\u7801\u200b\u6587\u4ef6\u200b\u653e\u5728\u200b <code>plugins/</code> \u200b\u76ee\u5f55\u200b\u4e0b\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b <code>main.py</code> \u200b\u4e2d\u200b <code>import</code> \u3002\u200b\u5982\u679c\u200b\u6709\u200b\u9700\u8981\u200b\uff0c\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u968f\u610f\u200b\u66f4\u6539\u200b\u6b64\u200b\u4ee3\u7801\u200b\u7ed3\u6784\u200b\u3002</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u89e6\u53d1\u200b\u6761\u4ef6\u200b\u51b2\u7a81\u200b</p> <p>Bot \u200b\u5728\u200b\u8bbe\u8ba1\u200b\u65f6\u200b\u9ed8\u8ba4\u200b\u4e00\u53e5\u200b\u6307\u4ee4\u200b\u53ea\u80fd\u200b\u8fdb\u884c\u200b\u4e00\u6b21\u200b\u54cd\u5e94\u200b\uff0c\u200b\u5f00\u53d1\u8005\u200b\u8bf7\u200b\u5c3d\u91cf\u200b\u786e\u4fdd\u200b\u89e6\u53d1\u200b\u6761\u4ef6\u200b\u4e0d\u200b\u51b2\u7a81\u200b\uff0c\u200b\u6216\u200b\u8003\u8651\u200b\u63d2\u4ef6\u200b\u5217\u8868\u200b\u4e2d\u200b\u5404\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5148\u540e\u987a\u5e8f\u200b\u3002 \u200b\u5982\u200b\u67d0\u200b\u4e00\u200b\u63d2\u4ef6\u200b\u89e6\u53d1\u200b\u4f46\u200b\u4e0d\u200b\u63d0\u4f9b\u200b\u54cd\u5e94\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u8fd4\u56de\u200b None \u200b\u4ee5\u200b\u7ee7\u7eed\u6267\u884c\u200b\u5217\u8868\u200b\u4e2d\u200b\u7684\u200b\u540e\u7eed\u200b\u63d2\u4ef6\u200b\u3002</p>"},{"location":"plugin/introduction/#2-recallmessagestandardplugin","title":"2. \u200b\u63a5\u6536\u200b\u64a4\u56de\u200b\u6d88\u606f\u200b\u63d2\u4ef6\u200b - RecallMessageStandardPlugin","text":"<p>\u200b\u6240\u6709\u200b\u63a5\u6536\u200b'\u200b\u79c1\u804a\u200b\u64a4\u56de\u200b\u6d88\u606f\u200b'\u200b\u548c\u200b'\u200b\u7fa4\u804a\u200b\u64a4\u56de\u200b\u6d88\u606f\u200b'\u200b\u7684\u200b\u63d2\u4ef6\u200b\u90fd\u200b\u5fc5\u987b\u200b\u7ee7\u627f\u200b\u4e8e\u200b <code>RecallMessageStandardPlugin</code> \u200b\u7c7b\u200b\uff0c\u200b\u5e76\u200b\u5b9e\u73b0\u200b\u4ee5\u4e0b\u200b\u63a5\u53e3\u51fd\u6570\u200b\uff1a</p> \u200b\u63a5\u53e3\u200b\u540d\u79f0\u200b \u200b\u53c2\u6570\u200b \u200b\u8fd4\u56de\u503c\u200b\u7c7b\u578b\u200b \u200b\u4f5c\u7528\u200b recallMessage <code>@data</code>: \u200b\u6d88\u606f\u200b\u6240\u200b\u5305\u62ec\u200b\u7684\u200b\u6240\u6709\u200b\u4fe1\u606f\u200b\uff0c<code>dict</code>\u200b\u7c7b\u578b\u200b <code>None</code> \u200b\u5bf9\u200b'\u200b\u64a4\u56de\u200b\u6d88\u606f\u200b'\u200b\u6d88\u606f\u200b\u8fdb\u884c\u200b\u5904\u7406"},{"location":"plugin/introduction/#3-groupuploadstandardplugin","title":"3. \u200b\u63a5\u6536\u200b\u4e0a\u4f20\u200b\u6587\u4ef6\u200b\u63d2\u4ef6\u200b - GroupUploadStandardPlugin","text":"<p>\u200b\u6240\u6709\u200b\u63a5\u6536\u200b'\u200b\u7fa4\u804a\u200b\u4e0a\u4f20\u200b\u6587\u4ef6\u200b'\u200b\u7684\u200b\u63d2\u4ef6\u200b\u90fd\u200b\u5fc5\u987b\u200b\u7ee7\u627f\u200b\u4e8e\u200b <code>GroupUploadStandardPlugin</code> \u200b\u7c7b\u200b\uff0c\u200b\u5e76\u200b\u5b9e\u73b0\u200b\u4ee5\u4e0b\u200b\u63a5\u53e3\u51fd\u6570\u200b\uff1a</p> \u200b\u63a5\u53e3\u200b\u540d\u79f0\u200b \u200b\u53c2\u6570\u200b \u200b\u8fd4\u56de\u503c\u200b\u7c7b\u578b\u200b \u200b\u4f5c\u7528\u200b uploadFile <code>@data</code>: \u200b\u6d88\u606f\u200b\u6240\u200b\u5305\u62ec\u200b\u7684\u200b\u6240\u6709\u200b\u4fe1\u606f\u200b\uff0c<code>dict</code>\u200b\u7c7b\u578b\u200b <code>None</code> \u200b\u5bf9\u200b'\u200b\u4e0a\u4f20\u200b\u6587\u4ef6\u200b'\u200b\u6d88\u606f\u200b\u8fdb\u884c\u200b\u5904\u7406"},{"location":"plugin/introduction/#4-pokestandardplugin","title":"4. \u200b\u63a5\u6536\u200b\u62cd\u200b\u4e00\u200b\u62cd\u200b\u63d2\u4ef6\u200b - PokeStandardPlugin","text":"<p>\u200b\u6240\u6709\u200b\u63a5\u6536\u200b'\u200b\u7fa4\u804a\u200b\u4e0a\u4f20\u200b\u6587\u4ef6\u200b'\u200b\u7684\u200b\u63d2\u4ef6\u200b\u90fd\u200b\u5fc5\u987b\u200b\u7ee7\u627f\u200b\u4e8e\u200b <code>PokeStandardPlugin</code> \u200b\u7c7b\u200b\uff0c\u200b\u5e76\u200b\u5b9e\u73b0\u200b\u4ee5\u4e0b\u200b\u63a5\u53e3\u51fd\u6570\u200b\uff1a</p> \u200b\u63a5\u53e3\u200b\u540d\u79f0\u200b \u200b\u53c2\u6570\u200b \u200b\u8fd4\u56de\u503c\u200b\u7c7b\u578b\u200b \u200b\u4f5c\u7528\u200b judgeTrigger <code>@data</code>: \u200b\u6d88\u606f\u200b\u6240\u200b\u5305\u62ec\u200b\u7684\u200b\u6240\u6709\u200b\u4fe1\u606f\u200b <code>bool</code> \u200b\u5224\u65ad\u200b\u6b64\u200b\u63d2\u4ef6\u200b\u662f\u5426\u200b\u4f1a\u200b\u89e6\u53d1\u200b pokeMessage <code>@data</code>: \u200b\u6d88\u606f\u200b\u6240\u200b\u5305\u62ec\u200b\u7684\u200b\u6240\u6709\u200b\u4fe1\u606f\u200b <code>str</code> \u200b\u6216\u8005\u200b <code>None</code> \u200b\u6267\u884c\u200b\u63d2\u4ef6\u200b\u903b\u8f91"},{"location":"plugin/introduction/#_3","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code># parts of utils/standardPlugin.py\nfrom abc import ABC, abstractmethod\nfrom typing import Union, Tuple, Any, List\nclass StandardPlugin(ABC):\n\"\"\"\u200b\u63a5\u6536\u200b\u2018\u200b\u6b63\u5e38\u200b\u79c1\u804a\u200b\u6d88\u606f\u200b\u6216\u7fa4\u200b\u6d88\u606f\u200b\u2019\u200b\u7684\u200b\u63a5\u53e3\u200b\"\"\"\n@abstractmethod\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\n\"\"\"\n        @msg: message text\n        @data: all the message data, including group_id or user_id\n        @return: whether trigger this class\n        \"\"\"\nraise NotImplementedError\n@abstractmethod\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\n\"\"\"\n        @msg: message text\n        @data: all the message data, including group_id or user_id\n        @return:\n            if None, then continue tranversing following plugins\n            if \"OK\", then stop tranversing\n        \"\"\"\nraise NotImplementedError\n@abstractmethod\ndef getPluginInfo(self)-&gt;dict:\n\"\"\"\n        @return:\n            a dict object like:\n            {\n                'name': 'Faq',                      # require\n                'description': '\u200b\u95ee\u7b54\u200b\u5e93\u200b',             # require\n                'commandDescription': '\u200b\u95ee\u200b [title]', # require\n                'usePlace': ['group', 'private', ], # require\n                'showInHelp': True,                 # suggest, default True\n                'pluginConfigTableNames': ['Faq',], # suggest, must be unique among plugins\n                'version': '1.0.0',                 # suggest\n                'author': 'Unicorn',                # suggest\n                ...                                 # any other information you want\n            }\n        \"\"\"\nraise NotImplementedError\ndef onStateChange(self, nextState:bool, data:Any)-&gt;None:\n\"\"\"\u200b\u63d2\u4ef6\u200b\u7684\u200b\u72b6\u6001\u200b\uff08\u200b\u5f00\u542f\u200b\u6216\u200b\u5173\u95ed\u200b\uff09\u200b\u6539\u53d8\u200b\u65f6\u4f1a\u200b\u8c03\u7528\u200b\u6b64\u200b\u63a5\u53e3\u200b\n        @nextState: \n            if True, plugin will open next\n            if False, plugin will close next\n        @data: all the message data, including group_id or user_id\n        \"\"\"\nclass EmptyPlugin(StandardPlugin):\n\"\"\"\u200b\u7a7a\u200b\u63d2\u4ef6\u200b\"\"\"\ndef __init__(self, *args, **kwargs) -&gt; None:\nreturn\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn False\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\nreturn None\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'EmptyPlugin',\n'description': '\u200b\u7a7a\u200b\u63d2\u4ef6\u200b',\n'commandDescription': '',\n'usePlace': ['group', 'private', ],\n'showInHelp': False,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass PokeStandardPlugin(ABC):\n\"\"\"\u200b\u63a5\u6536\u200b\u2018\u200b\u62cd\u200b\u4e00\u200b\u62cd\u200b\u2019\u200b\u6d88\u606f\u200b\"\"\"\n@abstractmethod\ndef judgeTrigger(self, data:Any)-&gt;bool:\n\"\"\"\u200b\u5224\u65ad\u200b\u63d2\u4ef6\u200b\u662f\u5426\u200b\u89e6\u53d1\u200b\"\"\"\nraise NotImplementedError\n@abstractmethod\ndef pokeMessage(self, data:Any)-&gt;Union[str, None]:\n\"\"\"\u200b\u63a5\u6536\u200b\u2018\u200b\u6233\u200b\u4e00\u200b\u6233\u200b\u2019\u200b\u6d88\u606f\u200b\u7684\u200b\u63a5\u53e3\u200b\"\"\"\nraise NotImplementedError\nclass RecallMessageStandardPlugin(ABC):\n\"\"\"\u200b\u63a5\u6536\u200b\u2018\u200b\u64a4\u56de\u200b\u7c7b\u578b\u200b\u2019\u200b\u6d88\u606f\u200b\u7684\u200b\u63a5\u53e3\u200b\"\"\"\n@abstractmethod\ndef recallMessage(self, data:Any)-&gt;Union[str, None]:\nraise NotImplementedError\nclass GroupUploadStandardPlugin(ABC):\n\"\"\"\u200b\u63a5\u6536\u200b\u2018\u200b\u4e0a\u4f20\u200b\u6587\u4ef6\u200b\u2019\u200b\u6d88\u606f\u200b\u7684\u200b\u63a5\u53e3\u200b\"\"\"\n@abstractmethod\ndef uploadFile(self, data)-&gt;Union[str, None]:\nraise NotImplementedError\n</code></pre>"},{"location":"plugin/pluginWithSql/","title":"\u63d2\u4ef6\u200b\u4e0e\u200b\u6570\u636e\u5e93","text":"<p>\u200b\u63d2\u4ef6\u200b\u7a0b\u5e8f\u5458\u200b\u6709\u200b\u4e24\u79cd\u200b\u65b9\u6cd5\u200b\u53ef\u4ee5\u200b\u4e0e\u200bmysql\u200b\u4ea4\u4e92\u200b\uff1a</p> <ol> <li>\u200b\u901a\u8fc7\u200b\u73b0\u6709\u200b API \u200b\u95f4\u63a5\u200b\u4ea4\u4e92\u200b\uff0c\u200b\u4f8b\u5982\u200b group config</li> <li>\u200b\u81ea\u5df1\u200b import mysql.connector \u200b\u76f4\u63a5\u200b\u4ea4\u4e92\u200b</li> </ol> <p>\u200b\u7b2c\u4e00\u79cd\u200b\u65b9\u5f0f\u200b\u6bd4\u8f83\u7b80\u5355\u200b\uff0c\u200b\u4f46\u662f\u200b\u5b9e\u73b0\u200b\u7684\u200b\u529f\u80fd\u200b\u6709\u9650\u200b\u3002\u200b\u5728\u200b utils.basicEvent \u200b\u4e2d\u6709\u200b readGlobalConfig \u200b\u7b49\u200b\u51fd\u6570\u200b\uff0c\u200b\u5b83\u4eec\u200b\u80fd\u591f\u200b\u8bfb\u5199\u200b <code>BOT_DATA.globalConfig</code> \u200b\u8868\u4e2d\u200b\u5b58\u50a8\u200b\u7684\u200b\u6570\u636e\u200b\u3002\u200b\u4f46\u662f\u200b\u8fd9\u79cd\u200b\u65b9\u5f0f\u200b\u53ea\u80fd\u200b\u8bfb\u53d6\u200b\u63d2\u4ef6\u200b\u662f\u5426\u200b\u5728\u200b\u67d0\u7fa4\u200b\u4e2d\u200b\u5f00\u542f\u200b\u3001\u200b\u67d0\u7fa4\u200b\u7684\u200b bot\u200b\u7ba1\u7406\u5458\u200b \u200b\u6709\u200b\u54ea\u51e0\u4e2a\u200b\uff0c\u200b\u65e0\u6cd5\u200b\u8fdb\u884c\u200b\u66f4\u200b\u591a\u200b\u6570\u636e\u200b\u7684\u200b\u5b58\u53d6\u200b\u3002</p> <p>\u200b\u7b2c\u4e8c\u79cd\u200b\u65b9\u5f0f\u200b\u80fd\u591f\u200b\u81ea\u5b9a\u4e49\u200b\u8fdb\u884c\u200bsql\u200b\u4ea4\u4e92\u200b\uff0c\u200b\u5b9e\u73b0\u200b\u66f4\u52a0\u200b\u4e30\u5bcc\u200b\u7684\u200b\u529f\u80fd\u200b\u3002\u200b\u4f8b\u5982\u200b</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u6570\u636e\u5e93\u200b\u4ea4\u4e92\u200b\u5fc5\u987b\u200b\u9632\u6b62\u200b\u5916\u90e8\u200b\u6570\u636e\u200b\u6ce8\u5165\u200b</p> <p>sql \u200b\u9632\u200b\u6ce8\u5165\u200b\u662f\u200b\u5f00\u53d1\u8005\u200b\u5fc5\u987b\u200b\u9075\u5b88\u200b\u7684\u200b\u5b89\u5168\u200b\u51c6\u5219\u200b\uff0c\u200b\u63d2\u4ef6\u200b\u7a0b\u5e8f\u5458\u200b\u53ef\u4ee5\u200b\u901a\u8fc7\u200b\u5b57\u7b26\u4e32\u200b\u8f6c\u4e49\u200b\uff08\u200b\u4f8b\u5982\u200b escape_string \uff09\u200b\u6216\u200b\u6b63\u5219\u200b\u5b57\u7b26\u4e32\u200b\u5339\u914d\u200b\uff08\u200b\u4f8b\u5982\u200b re.match \uff09\u200b\u6765\u200b\u89c4\u907f\u200b\u6570\u636e\u5e93\u200b\u6ce8\u5165\u200b\u98ce\u9669\u200b\u3002\u200b\u4efb\u4f55\u200b\u6765\u81ea\u200b\u5916\u90e8\u200b\u7684\u200b\u6570\u636e\u200b\u90fd\u200b\u5fc5\u987b\u200b\u505a\u5230\u200b\u9632\u200b\u6ce8\u5165\u200b\uff0c\u200b\u6bd4\u5982\u200b\u6635\u79f0\u200b\u3001\u200b\u804a\u5929\u8bb0\u5f55\u200b\u3001\u200b\u5934\u50cf\u200b url \u200b\u7b49\u200b\u3002</p> <p>\u200b\u5173\u4e8e\u200b mysql \u200b\u4ea4\u4e92\u200b\u63d2\u4ef6\u200b\u7f16\u5199\u200b\u7684\u200b\u6837\u4f8b\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u53c2\u8003\u200b\uff1a</p> <ul> <li>\u200b\u7fa4\u200b bot \u200b\u6743\u9650\u200b\u7ba1\u7406\u200b API\uff08\u200b\u8bfb\u5199\u200b\u7fa4\u200b bot \u200b\u7ba1\u7406\u5458\u200b\u3001\u200b\u63d2\u4ef6\u200b\u5f00\u542f\u200b\u4fe1\u606f\u200b\uff09</li> <li>SJTU canvas \u200b\u63d2\u4ef6\u200b \uff08ics url \u200b\u7684\u200b\u5b58\u53d6\u200b\uff09</li> <li>\u200b\u804a\u5929\u8bb0\u5f55\u200b\u5b58\u6863\u200b\u63d2\u4ef6\u200b\uff08\u200b\u804a\u5929\u8bb0\u5f55\u200b\u7684\u200b\u5b58\u50a8\u200b\uff09</li> <li>accountOperation API \u200b\u91d1\u5e01\u200b\u7cfb\u7edf\u200b</li> <li>B\u200b\u7ad9\u200b\u8ba2\u9605\u200b \uff08\u200b\u5b58\u50a8\u200b\u8ba2\u9605\u200b\u4fe1\u606f\u200b\u548c\u200bup\u200b\u4e3b\u200b\u4e0a\u6b21\u200b\u4e0a\u4f20\u200b\u89c6\u9891\u200b\u4fe1\u606f\u200b\uff09</li> </ul>"},{"location":"plugin/pluginWithTimer/","title":"1. \u200b\u95f4\u9694\u200b\u56fa\u5b9a\u200b\u65f6\u95f4\u200b\u89e6\u53d1\u200b\u63d2\u4ef6","text":""},{"location":"plugin/pluginWithTimer/#_1","title":"\u63d2\u4ef6\u200b\u903b\u8f91","text":"<p>\u200b\u95f4\u9694\u200b\u56fa\u5b9a\u200b\u65f6\u95f4\u200b\u89e6\u53d1\u200b\u7684\u200b\u63d2\u4ef6\u200b\u63a8\u8350\u200b\u7ee7\u627f\u200b\u4e8e\u200b <code>CronStandardPlugin</code> \u200b\u7c7b\u200b\uff0c\u200b\u7ee7\u627f\u200b\u6b64\u7c7b\u200b\u540e\u200b\uff0c\u200b\u5b9a\u65f6\u200b\u4efb\u52a1\u200b\u6267\u884c\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u6240\u200b\u629b\u51fa\u200b\u7684\u200b\u5f02\u5e38\u200b\u4f1a\u200b\u88ab\u200b\u81ea\u52a8\u200bwarning\u3002</p> \u200b\u63a5\u53e3\u200b\u540d\u79f0\u200b \u200b\u53c2\u6570\u200b \u200b\u8fd4\u56de\u503c\u200b\u7c7b\u578b\u200b \u200b\u4f5c\u7528\u200b tick - <code>None</code> \u200b\u505a\u200b\u6bcf\u6b21\u200b\u89e6\u53d1\u200b\u4efb\u52a1\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u4e8b\u60c5\u200b start _, intervalTime <code>None</code> \u200b\u5f00\u59cb\u200b\u8ba1\u65f6\u200b <p>\u200b\u6ce8\u610f\u200b\uff1astart\u200b\u63a5\u53e3\u200b\u9996\u4e2a\u200b\u53c2\u6570\u200b\u5f03\u7528\u200b\uff0c\u200b\u7559\u200b\u4f5c\u200b\u5360\u4f4d\u200b\u7b26\u200b</p> <p>\u200b\u7531\u4e8e\u200b\u5386\u53f2\u200b\u539f\u56e0\u200b\uff0c<code>CronStandardPlugin</code>\u200b\u7c7b\u200b\u7684\u200b<code>start</code>\u200b\u63a5\u53e3\u200b\u7b2c\u4e00\u4e2a\u200b\u53c2\u6570\u200b\"startTime\"\u200b\u5f03\u7528\u200b</p> <p>\u200b\u6ce8\u610f\u200b\uff1aCronStandardPlugin\u200b\u540d\u79f0\u200b\u4e2d\u200b\u7684\u200bcron\u200b\u5b9e\u9645\u4e0a\u200b\u5bf9\u5e94\u200bapschedule\u200b\u7684\u200binterval</p> <p>\u200b\u7531\u4e8e\u200b\u5386\u53f2\u200b\u539f\u56e0\u200b\uff0c<code>CronStandardPlugin</code>\u200b\u7c7b\u200b\u7684\u200b\"cron\"\u200b\u5b9e\u9645\u4e0a\u200b\u5bf9\u5e94\u200bapschedule\u200b\u7684\u200b\"interval\"</p> <p>\u200b\u5173\u4e8e\u200b <code>CronStandardPlugin</code> \u200b\u7c7b\u200b\u7684\u200b\u4f7f\u7528\u200b\uff0c\u200b\u53ef\u200b\u53c2\u8003\u200b:</p> <ul> <li>B\u200b\u7ad9\u200b\u8ba2\u9605\u200b \uff08\u200b\u8f6e\u8be2\u200bup\u200b\u4e3b\u200b\u4fe1\u606f\u200b\uff09</li> <li>\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b \uff08\u200b\u8f6e\u8be2\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u4fe1\u606f\u200b\uff09</li> <li>SJTU\u200b\u6559\u52a1\u5904\u200b \uff08\u200b\u8f6e\u8be2\u200b\u6559\u52a1\u200b\u901a\u77e5\u200b\uff09</li> <li>\u200b\u65b0\u95fb\u200b \uff08\u200b\u8f6e\u8be2\u200b\u65b0\u95fb\u200b\u66f4\u65b0\u200b\u4fe1\u606f\u200b\uff09</li> <li>SJMC\u200b\u76f4\u64ad\u95f4\u200b\u72b6\u6001\u200b \uff08\u200b\u8f6e\u8be2\u200bSJMC\u200b\u76f4\u64ad\u95f4\u200b\u72b6\u6001\u200b\uff09</li> <li>SJTU\u200b\u9ea6\u5f53\u52b3\u200b \uff08\u200b\u8f6e\u8be2\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u9910\u5385\u200b\u72b6\u6001\u200b\uff09</li> </ul>"},{"location":"plugin/pluginWithTimer/#2","title":"2. \u200b\u951a\u5b9a\u200b\u56fa\u5b9a\u200b\u65f6\u523b\u200b\u89e6\u53d1\u200b\u63d2\u4ef6","text":"<p>\u200b\u951a\u5b9a\u200b\u56fa\u5b9a\u200b\u65f6\u523b\u200b\u89e6\u53d1\u200b\u7684\u200b\u63d2\u4ef6\u200b\u63a8\u8350\u200b\u7ee7\u627f\u200b\u4e8e\u200b <code>ScheduleStandardPlugin</code> \u200b\u7c7b\u200b\uff0c\u200b\u7ee7\u627f\u200b\u6b64\u7c7b\u200b\u540e\u200b\uff0c\u200b\u5b9a\u65f6\u200b\u4efb\u52a1\u200b\u6267\u884c\u200b\u8fc7\u7a0b\u200b\u4e2d\u200b\u6240\u200b\u629b\u51fa\u200b\u7684\u200b\u5f02\u5e38\u200b\u4f1a\u200b\u88ab\u200b\u81ea\u52a8\u200bwarning\u3002</p> \u200b\u63a5\u53e3\u200b\u540d\u79f0\u200b \u200b\u53c2\u6570\u200b \u200b\u8fd4\u56de\u503c\u200b\u7c7b\u578b\u200b \u200b\u4f5c\u7528\u200b tick - <code>None</code> \u200b\u505a\u200b\u6bcf\u6b21\u200b\u89e6\u53d1\u200b\u4efb\u52a1\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u4e8b\u60c5\u200b schedule hour, minute <code>None</code> \u200b\u5f00\u59cb\u200b\u8ba1\u65f6\u200b <p>\u200b\u6ce8\u610f\u200b\uff1aScheduleStandardPlugin\u200b\u540d\u79f0\u200b\u4e2d\u200b\u7684\u200bschedule\u200b\u5b9e\u9645\u4e0a\u200b\u5bf9\u5e94\u200bapschedule\u200b\u7684\u200bcron</p> <p>\u200b\u7531\u4e8e\u200b\u5386\u53f2\u200b\u539f\u56e0\u200b\uff0c<code>ScheduleStandardPlugin</code>\u200b\u7c7b\u200b\u7684\u200b\"schedule\"\u200b\u5b9e\u9645\u4e0a\u200b\u5bf9\u5e94\u200bapschedule\u200b\u7684\u200b\"cron\"</p> <p>\u200b\u5173\u4e8e\u200b <code>ScheduleStandardPlugin</code> \u200b\u7c7b\u200b\u7684\u200b\u4f7f\u7528\u200b\uff0c\u200b\u53ef\u200b\u53c2\u8003\u200b\uff1a</p> <ul> <li>\u200b\u6628\u65e5\u200b\u8bcd\u4e91\u200b \uff08\u200b\u6bcf\u5929\u200b0\u200b\u70b9\u200b\u5b9a\u65f6\u200b\u66f4\u65b0\u200b\u8bcd\u4e91\u200b\uff09</li> <li>\u200b\u5f69\u7968\u200b \uff08\u200b\u6bcf\u5929\u200b\u5b9a\u65f6\u200b\u5f00\u5956\u200b\uff09</li> </ul>"},{"location":"plugin/pluginWithTimer/#_2","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>utils/standardPlugin.py</code></p> <pre><code>class BaseTimeSchedulePlugin(ABC):\n\"\"\"\u200b\u5b9a\u65f6\u200b\u4efb\u52a1\u200b\u57fa\u7c7b\u200b\uff0c\u200b\u53c2\u8003\u200bapscheduler\u200b\u6587\u6863\u200b\"\"\"\nscheduler = BackgroundScheduler()\nscheduler.start()\n@abstractmethod\ndef tick(self,)-&gt;None:\n\"\"\"\u200b\u6bcf\u6b21\u200b\u89e6\u53d1\u200b\u4efb\u52a1\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u4e8b\u60c5\u200b\"\"\"\nraise NotImplementedError\n@final\ndef _tick(self,)-&gt;None:\ntry:\nself.tick()\nexcept BaseException as e:\nwarning('exception in ScheduleStandardPlugin: {}'.format(e))\nclass ScheduleStandardPlugin(BaseTimeSchedulePlugin):\n\"\"\"\u200b\u56fa\u5b9a\u200b\u6bcf\u65e5\u200b\u65f6\u523b\u200b\u6267\u884c\u200b\"\"\"\ndef schedule(self, hour:Union[str, int]=0, minute:Union[str, int]=0)-&gt;None:\n\"\"\"\u200b\u53ef\u4ee5\u200b\u91cd\u5199\u200b\u6b64\u200b\u65b9\u6cd5\u200b\n        @hour: \n        @minute:\n        e.g:\n            hour: (str)'1-3', minute: None ---- \u200b\u6bcf\u5929\u200b 1:00, 2:00, 3:00 \u200b\u8fd0\u884c\u200b\n            hour: (int)0, minute: (int)1   ---- \u200b\u6bcf\u5929\u200b 0:01 \u200b\u8fd0\u884c\u200b\n        \"\"\"\nBaseTimeSchedulePlugin.scheduler.add_job(self._tick, 'cron', hour=hour, minute=minute)\nclass CronStandardPlugin(BaseTimeSchedulePlugin):\n\"\"\"\u200b\u95f4\u9694\u200b\u56fa\u5b9a\u200b\u65f6\u200b\u957f\u200b\u6267\u884c\u200b\"\"\"\ndef start(self, startTime:float, intervalTime:float)-&gt;None:\n\"\"\"\u200b\u5f00\u59cb\u200b\u6267\u884c\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u91cd\u5199\u200b\u6b64\u200b\u65b9\u6cd5\u200b\n        @startTime: deprecated\n        @intervalTime: \u200b\u95f4\u9694\u200b\u591a\u4e45\u200b\u6267\u884c\u200b\u4e00\u6b21\u200b\u4efb\u52a1\u200b\uff0c\u200b\u5355\u4f4d\u200b\uff1a\u200b\u79d2\u200b\n        \"\"\"\nBaseTimeSchedulePlugin.scheduler.add_job(self._tick, 'interval', seconds=intervalTime)\n</code></pre>"},{"location":"plugin/plugins/2cyPicPlugin/","title":"\u4e8c\u6b21\u5143\u200b\u56fe","text":""},{"location":"plugin/plugins/2cyPicPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b Show2cyPIC StandardPlugin '\u200b\u6765\u70b9\u200b\u56fe\u56fe\u200b' None \u200b\u83b7\u53d6\u200b\u4e8c\u6b21\u5143\u200b\u56fe\u7247\u200b ShowSePIC StandardPlugin '\u200b\u6765\u70b9\u200b\u6da9\u200b\u6da9\u200b' None \u200b\u83b7\u53d6\u200b\u4e8c\u6b21\u5143\u200b\u5927\u200b\u5c3a\u5ea6\u200b\u56fe\u7247\u200b <p>\u200b\u98ce\u9669\u200b\u63d0\u793a\u200b</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u89e6\u53d1\u200b ShowSePIC \u200b\u63d2\u4ef6\u200b\u540e\u200b bot \u200b\u5927\u200b\u6982\u7387\u200b\u4f1a\u200b\u88ab\u200b\u98ce\u63a7\u200b</p>"},{"location":"plugin/plugins/2cyPicPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; \u200b\u6765\u70b9\u200b\u56fe\u56fe\u200b\nbot&gt; \u3010\u200b\u4e8c\u6b21\u5143\u200b\u56fe\u7247\u200b\u3011\n222&gt; \u200b\u6765\u70b9\u200b\u6da9\u200b\u6da9\u200b\nbot&gt; \u3010\u200b\u4e8c\u6b21\u5143\u200b\u5927\u200b\u5c3a\u5ea6\u200b\u56fe\u7247\u200b\u3011\n</code></pre>"},{"location":"plugin/plugins/2cyPicPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b plugins/show2cyPic.py</p> <pre><code>class Show2cyPIC(StandardPlugin): \ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg == '\u200b\u6765\u70b9\u200b\u56fe\u56fe\u200b'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nreq = requests.get(url='https://tenapi.cn/acg',params={'return': 'json'})\nif req.status_code != requests.codes.ok:\nwarning(\"tenapi failed in Show2cyPIC\")\nreturn \"OK\"\ntry:\npic_url = req.json()['imgurl']\nexcept requests.JSONDecodeError as e:\nwarning(\"json decode error in Show2cyPIC: {}\".format(e))\nreturn \"OK\"\nexcept KeyError as e:\nwarning(\"key error in Show2cyPIC: {}\".format(e))\nreturn \"OK\"\nsend(target,'[CQ:image,file=' + pic_url + ']', data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'Show2cyPIC',\n'description': '\u200b\u6765\u70b9\u200b\u56fe\u56fe\u200b',\n'commandDescription': '\u200b\u6765\u70b9\u200b\u56fe\u56fe\u200b',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass ShowSePIC(StandardPlugin): \ndef __init__(self) -&gt; None:\nprint('\u200b\u6ce8\u610f\u200b\uff0c\u200b\u5f00\u542f\u200bShowSePIC\u200b\u63d2\u4ef6\u200b\u6709\u200b\u88ab\u200b\u817e\u8baf\u200b\u5c01\u53f7\u200b\u7684\u200b\u5371\u9669\u200b')\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn startswith_in(msg, ['\u200b\u6765\u70b9\u200b\u6da9\u200b\u6da9\u200b'])\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nmsg_split = msg.split()\nif len(msg_split)==0:\ntag=''\nelse:\ntag=msg.replace('\u200b\u6765\u70b9\u200b\u6da9\u200b\u6da9\u200b','',1)\ntag=tag.strip().split()\ntagText = \"\"\nfor t in tag:\ntagText += urllib.parse.quote(t) + '|'\ntagText = tagText[:-1]\ntry:\nreq= requests.get(url=f\"https://api.lolicon.app/setu/v2?tag={tagText}&amp;r18=0&amp;size=regular\",params={'return': 'json'})\nif req.status_code != requests.codes.ok:\nwarning(\"lolicon API failed in ShowSePIC\")\nreturn \"OK\"\npic_url = req.json()['data'][0]['urls']['regular']\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target,'[CQ:image,file=' + pic_url + ',type=flash]',data['message_type'])\nexcept BaseException as e:\nwarning('exception in show2cyPic, error: {}'.format(e))\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'ShowSePIC',\n'description': '\u200b\u6765\u70b9\u200b\u6da9\u200b\u6da9\u200b',\n'commandDescription': '\u200b\u6765\u70b9\u200b\u6da9\u200b\u6da9\u200b [tag]',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/autoRepokePlugin/","title":"\u7fa4\u5185\u200b\u81ea\u52a8\u200b\u56de\u62cd","text":""},{"location":"plugin/plugins/autoRepokePlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b AutoRepoke PokeStandardPlugin [\u200b\u7fa4\u5185\u200b\u62cd\u200b\u4e00\u200b\u62cd\u200b\u6d88\u606f\u200b] None \u200b\u56de\u590d\u200b\u62cd\u200b\u4e00\u200b\u62cd\u200b <p>\u200b\u8bbe\u8ba1\u200b\u521d\u8877\u200b \u2014\u2014 \u200b\u5b89\u5168\u200b\u5730\u56de\u200b\u6233\u200b</p> <p>\u200b\u5728\u200b\u7fa4\u804a\u200b\u4e2d\u200b\u5f80\u5f80\u200b\u5b58\u5728\u200b\u591a\u4e2a\u200b\u673a\u5668\u4eba\u200b\uff0c\u200b\u67d0\u200b\u673a\u5668\u4eba\u200b\u63a5\u6536\u200b\u201c\u200b\u6233\u200b@{..}\u201d\u200b\u683c\u5f0f\u200b\u7684\u200b\u6d88\u606f\u200b\u4f1a\u200b\u6233\u200b\u4e00\u200b\u6233\u200b\u88ab\u200bat\u200b\u7684\u200b\u4eba\u200b\uff0c\u200b\u540c\u65f6\u200b\u8be5\u200b\u673a\u5668\u4eba\u200b\u88ab\u200b\u6233\u200b\u65f6\u4f1a\u200b\u81ea\u52a8\u200b\u56de\u200b\u6233\u200b\u3002\u200b\u5982\u679c\u200bLittle-Unicorn-Bot\u200b\u662f\u200b\u88ab\u200b \u201c\u200b\u6233\u200b@{..}\u201d at\u200b\u7684\u200b\u76ee\u6807\u200b\uff0c\u200b\u90a3\u4e48\u200bLittle-Unicorn-Bot\u200b\u548c\u200b\u8be5\u200b\u673a\u5668\u4eba\u200b\u4f1a\u200b\u4e0d\u505c\u200b\u5730\u4e92\u200b\u6233\u200b\uff0c\u200b\u76f4\u5230\u200b\u88ab\u200b\u817e\u8baf\u200b\u9650\u5236\u200b\u3002\u200b\u8bbe\u8ba1\u200b\u6b64\u200b\u63d2\u4ef6\u200b\u7684\u200b\u521d\u8877\u200b\u5c31\u662f\u200b\u4e3a\u4e86\u200b\u5b89\u5168\u200b\u5730\u56de\u200b\u6233\u200b\u3002</p>"},{"location":"plugin/plugins/autoRepokePlugin/#2","title":"2. \u200b\u6837\u4f8b\u200b\u5206\u6790","text":"<pre><code>111&gt; \u3010\u200b\u6233\u200b\u4e00\u200b\u6233\u200bbot\u3011\nbot&gt; \u3010\u200b\u6233\u200b\u4e00\u200b\u6233\u200b111\u3011\n</code></pre>"},{"location":"plugin/plugins/autoRepokePlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/autoRepoke.py</code></p> <pre><code>class AutoRepoke(PokeStandardPlugin):\ndef __init__(self) -&gt; None:\nself.mutex = Lock()\nself.fullResource = Semaphore(5)\nself.emptyResource = Semaphore(0)\nself.job = BaseTimeSchedulePlugin.scheduler.add_job(self._feedThread, 'interval', seconds=3)\ndef _acquire(self)-&gt;bool:\ncanPoke = False\nself.mutex.acquire(blocking=True)\nif self.fullResource.acquire(blocking=False):\ncanPoke = True\nself.emptyResource.release()\nself.mutex.release()\nreturn canPoke\ndef _release(self)-&gt;bool:\nresult = False\nself.mutex.acquire(blocking=True)\nif self.emptyResource.acquire(blocking=False):\nself.fullResource.release()\nresult = True\nself.mutex.release()\nreturn result\ndef _feedThread(self):\nif not self._release():\nself.job.pause()\ndef judgeTrigger(self, data:Any)-&gt;bool:\nreturn data['target_id'] == data['self_id']\ndef pokeMessage(self, data:Any)-&gt;Union[None, str]:        \nif self._acquire():\nsend(data['group_id'], f\"[CQ:poke,qq={data['sender_id']}]\")\nself.job.resume()\nreturn \"OK\"\n</code></pre>"},{"location":"plugin/plugins/bilibiliSubscribePlugin/","title":"B\u200b\u7ad9\u200b\u8ba2\u9605","text":""},{"location":"plugin/plugins/bilibiliSubscribePlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b BilibiliSubscribeHelper StandardPlugin 'B\u200b\u7ad9\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b' None \u200b\u83b7\u53d6\u200bB\u200b\u7ad9\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b BilibiliSubscribe StandardPlugin '\u200b\u8ba2\u9605\u200bup' / '\u200b\u53d6\u6d88\u200b\u8ba2\u9605\u200b' / '\u200b\u5df2\u200b\u8ba2\u9605\u200bup' None \u200b\u8ba2\u9605\u200bB\u200b\u7ad9\u200bup\u200b\u4e3b\u7b49"},{"location":"plugin/plugins/bilibiliSubscribePlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; B\u200b\u7ad9\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b\nbot&gt; \u3010\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b\u5185\u5bb9\u200b\u3011\n111&gt; \u200b\u5df2\u200b\u8ba2\u9605\u200bup\nbot&gt; \u3010\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b\u3011\u200b\u672c\u7fa4\u200b\u8fd8\u200b\u6ca1\u6709\u200b\u8ba2\u9605\u200bup\u200b\u54e6\u200b~\n222&gt; \u200b\u8ba2\u9605\u200bup 316568752\nbot&gt; \u200b\u8ba2\u9605\u200b\u6210\u529f\u200b\uff01\n     name: \u200b\u9a6c\u200b\u7763\u5de5\u200b\n     uid: 316568752\n111&gt; \u200b\u5df2\u200b\u8ba2\u9605\u200bup\nbot&gt; \u200b\u672c\u7fa4\u200b\u8ba2\u9605\u200b\u7684\u200bup\u200b\u6709\u200b\uff1a\n\nname: \u200b\u9a6c\u200b\u7763\u5de5\u200b\n     uid: 316568752\n&lt;\u200b\u9a6c\u9006\u200b\u66f4\u65b0\u200b\u89c6\u9891\u200b\u540e\u200b\u51e0\u5206\u949f\u200b&gt;\nbot&gt; \u200b\u672c\u7fa4\u200b\u8ba2\u9605\u200bUP\u200b\u4e3b\u200b \u3010\u200b\u9a6c\u200b\u7763\u5de5\u200b\u3011 \u200b\u66f4\u65b0\u200b\u89c6\u9891\u200b\u5566\u200b\uff01\n     \u200b\u89c6\u9891\u200b\u6807\u9898\u200b\uff1a[...]\n\u200b\u94fe\u63a5\u200b\uff1a[...]\n</code></pre>"},{"location":"plugin/plugins/bilibiliSubscribePlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/bilibiliSubscribe.py</code></p> <pre><code>def bvToUrl(bvid:str):\nreturn 'https://www.bilibili.com/video/' + bvid\ndef createBilibiliTable()-&gt;None:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmydb.autocommit = True\nmycursor.execute(\"\"\"\n    create table if not exists `BOT_DATA`.`bilibiliUp` (\n       `uid` bigint unsigned not null,\n       `uploadTime` timestamp not null,\n       `bvid` char(20) not null,\n       primary key (`uid`)\n    )\"\"\")\nmycursor.execute(\"\"\"\n    create table if not exists `BOT_DATA`.`bilibiliSubscribe` (\n        `group_id` bigint unsigned not null,\n        `uid` bigint unsigned not null,\n        primary key(`group_id`, `uid`)\n    )\"\"\")\nclass BilibiliSubscribeHelper(StandardPlugin):\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn msg == \"B\u200b\u7ad9\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b\" and data['message_type']=='group'\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ngroup_id = data['group_id']\nsend(group_id,'\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b: B\u200b\u7ad9\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b\\n' \n'\u200b\u8ba2\u9605\u200bup:    \u200b\u8ba2\u9605\u200bup &lt;uid&gt;\\n'\n'\u200b\u53d6\u6d88\u200b\u8ba2\u9605\u200bup: \u200b\u53d6\u6d88\u200b\u8ba2\u9605\u200bup&lt;uid&gt;\\n'\n'\u200b\u83b7\u53d6\u200b\u5df2\u200b\u8ba2\u9605\u200b: \u200b\u5df2\u200b\u8ba2\u9605\u200bup\\n'\n'\u200b\u6ce8\u610f\u200b:  \u200b\u5173\u95ed\u200b\u672c\u200b\u63d2\u4ef6\u200b\u4f1a\u200b\u81ea\u52a8\u200b\u53d6\u6d88\u200b\u8ba2\u9605\u200b\u6240\u6709\u200b\u5df2\u200b\u8ba2\u9605\u200b\u7684\u200bup')\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'BilibiliSubscribeHelper',\n'description': 'B\u200b\u7ad9\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b',\n'commandDescription': 'B\u200b\u7ad9\u200b\u8ba2\u9605\u200b\u5e2e\u52a9\u200b',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass BilibiliUpSearcher(StandardPlugin):\ndef __init__(self) -&gt; None:\nself.pattern = re.compile(r'^\u200b\u641c\u7d22\u200bup\\s*(\\S+)$')\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn self.pattern.match(msg) != None\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'BilibiliUpSearcher',\n'description': '\u200b\u641c\u7d22\u200bB\u200b\u7ad9\u200b\u7528\u6237\u200buid',\n'commandDescription': '\u200b\u641c\u7d22\u200bup &lt;name&gt;',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass BilibiliSubscribe(StandardPlugin):\ndef __init__(self) -&gt; None:\n\"\"\"\n        self.bUps: uid -&gt; User\n        self.groupUps: group_id -&gt; Set[uid: int]\n        \"\"\"\nself.pattern1 = re.compile(r'^\u200b\u8ba2\u9605\u200bup\\s*(\\d+)$')\nself.pattern2 = re.compile(r'^\u200b\u53d6\u6d88\u200b\u8ba2\u9605\u200bup\\s*(\\d+)$')\nself.pattern3 = re.compile(r'^\u200b\u5df2\u200b\u8ba2\u9605\u200bup$')\nself.bUps:Dict[int, BilibiliMonitor] = {}\nself.groupUps:Dict[int, Set[int]] = {}\nself._loadFromSql()\ndef _loadFromSql(self)-&gt;None:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"\"\"\n        select group_id, uid from `BOT_DATA`.`bilibiliSubscribe`\n        \"\"\")\nfor group_id, uid in list(mycursor):\nif group_id not in self.groupUps.keys():\nself.groupUps[group_id] = set()\nif uid not in self.bUps.keys():\nself.bUps[uid] = BilibiliMonitor(uid)\nself.groupUps[group_id].add(uid)\nself.bUps[uid].addGroup(group_id)\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn self.pattern1.match(msg) != None or\\\n               self.pattern2.match(msg) != None or\\\n               self.pattern3.match(msg) != None\ndef subscribeBilibili(self, group_id:int, bilibili_uid:int)-&gt;None:\nif group_id not in self.groupUps.keys():\nself.groupUps[group_id] = set()\nif bilibili_uid not in self.groupUps[group_id]:\nself.groupUps[group_id].add(bilibili_uid)\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmydb.autocommit = True\nmycursor.execute(\"\"\"\n            insert ignore into BOT_DATA.bilibiliSubscribe set\n            group_id = %d,\n            uid = %d\n            \"\"\"%(group_id, bilibili_uid))\nif bilibili_uid not in self.bUps.keys():\nself.bUps[bilibili_uid] = BilibiliMonitor(bilibili_uid)\nself.bUps[bilibili_uid].addGroup(group_id)\ndef unsubscribeBilibili(self, group_id:int, bilibili_uid:int)-&gt;None:\nif group_id in self.groupUps.keys() and bilibili_uid in self.groupUps[group_id]:\nself.groupUps[group_id].discard(bilibili_uid)\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmydb.autocommit = True\nmycursor.execute(\"\"\"\n            delete from BOT_DATA.bilibiliSubscribe where\n            group_id = %d and\n            uid = %d\n            \"\"\"%(group_id, bilibili_uid))\nif bilibili_uid in self.bUps.keys():\nself.bUps[bilibili_uid].delGroup(group_id)\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ngroup_id = data['group_id']\nif self.pattern1.match(msg) != None:\nuid = self.pattern1.findall(msg)[0]\nuid = int(uid)\ntry:\nu = User(uid)\nuserInfo = asyncio.run(u.get_user_info())\nself.subscribeBilibili(group_id, uid)\nname = gocqQuote(userInfo['name'])\nsend(group_id, f'\u200b\u8ba2\u9605\u200b\u6210\u529f\u200b\uff01\\nname: {name}\\nuid: {uid}')\nexcept ResponseCodeException as e:\nsend(group_id, f'\u200b\u597d\u50cf\u200b\u6ca1\u200b\u627e\u5230\u200b\u8fd9\u4e2a\u200bUP:\\n{e}')\nexcept KeyError as e:\nwarning('bilibili api get_user_info error: {}'.format(e))\nelif self.pattern2.match(msg) != None:\nuid = self.pattern2.findall(msg)[0]\nuid = int(uid)\nself.unsubscribeBilibili(group_id, uid)\nsend(group_id, '[CQ:reply,id=%d]OK'%data['message_id'])\nelif self.pattern3.match(msg) != None:\nups = self.subscribeList(group_id)\nif len(ups) == 0:\nsend(group_id, '[CQ:reply,id=%d]\u200b\u672c\u7fa4\u200b\u8fd8\u200b\u6ca1\u6709\u200b\u8ba2\u9605\u200bup\u200b\u54e6\u200b~'%data['message_id'])\nelse:\ntry:\nmetas = asyncio.run(asyncio.wait([up.get_user_info() for up in ups]))\nmetas = [m.result() for m in metas[0]]\nmetas = [f\"name: {m['name']}\\nuid: {m['mid']}\" for m in metas]\nsend(group_id,f'\u200b\u672c\u7fa4\u200b\u8ba2\u9605\u200b\u7684\u200bup\u200b\u6709\u200b\uff1a\\n\\n'+'\\n----------\\n'.join(metas))\nexcept BaseException as e:\nsend(group_id, 'bilibili api error')\nwarning('bilibili get_user_info error: {}'.format(e))\nreturn \"OK\"\ndef onStateChange(self, nextState: bool, data: Any) -&gt; None:\ngroup_id = data['group_id']\nif nextState or group_id not in self.groupUps.keys(): return\nfor uid in copy.deepcopy(self.groupUps[group_id]):\nself.unsubscribeBilibili(group_id, uid)\ndef subscribeList(self, group_id:int)-&gt;List[User]:\nuids = self.groupUps.get(group_id, set())\nreturn [self.bUps[uid].bUser for uid in uids]\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'BilibiliSubscribe',\n'description': '\u200b\u8ba2\u9605\u200bB\u200b\u7ad9\u200bup',\n'commandDescription': '\u200b\u8ba2\u9605\u200bup &lt;uid&gt;/\u200b\u53d6\u6d88\u200b\u8ba2\u9605\u200bup &lt;uid&gt;/\u200b\u5df2\u200b\u8ba2\u9605\u200bup',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass BilibiliMonitor(CronStandardPlugin):\n\"\"\"bilibili up\u200b\u4e3b\u200b\u76d1\u63a7\u200b\u7c7b\u200b\n    self.uid: \u200b\u88ab\u200b\u76d1\u63a7\u200b\u7684\u200bup\u200b\u4e3b\u200buid\n    self.groupList\n    \"\"\"\ndef __init__(self, uid:int) -&gt; None:\nself.uid:int = uid\nself.bUser = User(uid=uid)\nself.groupList = set()\nself.job: Optional[Job] = None\nself.cumulativeNetworkErrCount = 0\nself._prevMeta:Optional[Tuple[int, str]] = None\ndef addGroup(self, group_id:int):\nself.groupList.add(group_id)\nif self.job == None:\nself.job = self.start(0, 5 * 60)\nelse:\nself.resume()\ndef delGroup(self, group_id:int):\nself.groupList.discard(group_id)\nif len(self.groupList) == 0:\nself.pause()\ndef tick(self) -&gt; None:\nvideos = None\nattempts = 0\nwhile videos == None and attempts &lt; 3:\nattempts += 1\ntry:\nvideos = asyncio.run(self.bUser.get_videos())\nexcept BaseException as e:\nvideos = None\nif videos == None: \nself.cumulativeNetworkErrCount += 1\nif self.cumulativeNetworkErrCount &gt;= 3:\nwarning('bilibili subscribe api failed!')\nself.cumulativeNetworkErrCount = 0\nself.cancel()\nreturn\nelse:\nself.cumulativeNetworkErrCount = 0\ntry:\nvideos = videos['list']['vlist']\nif len(videos) == 0: return\nlatestVideo = max(videos, key=lambda x:x['created'])\nuploadTime = latestVideo['created']\nbvid = latestVideo['bvid']\nprevMeta = self.getPrevMeta()\nif prevMeta == None or prevMeta != (uploadTime, bvid):\nself.writeMeta(uploadTime, bvid)\ntitle = gocqQuote(latestVideo['title'])\nauthor = gocqQuote(latestVideo['author'])\nfor group in self.groupList:\nsend(group, f'\u200b\u672c\u7fa4\u200b\u8ba2\u9605\u200bUP\u200b\u4e3b\u200b \u3010{author}\u3011 \u200b\u66f4\u65b0\u200b\u89c6\u9891\u200b\u5566\u200b\uff01\\n\u200b\u89c6\u9891\u200b\u6807\u9898\u200b\uff1a {title}\\n\u200b\u94fe\u63a5\u200b\uff1a{bvToUrl(bvid)}')\nexcept KeyError as e:\nwarning('bilibili api has changed!')\nself.cancel()\nreturn\nexcept BaseException as e:\nwarning('base excption in BilibiliMonitor: {}'.format(e))\nself.cancel()\ndef getPrevMeta(self)-&gt;Optional[Tuple[int, str]]:\n\"\"\"\u200b\u83b7\u53d6\u200b\u8be5\u200bup\u200b\u4e3b\u200b\u8bb0\u5f55\u200b\u5728\u518c\u200b\u7684\u200b\u524d\u200b\u4e00\u6b21\u200b\u4e0a\u4f20\u200b\u6570\u636e\u200b\n        @return: Optional[(\n            [0]: int: uploadTime unix\u200b\u65f6\u95f4\u200b\u6233\u200b\n            [1]: str: bvid\n        )]\n        \"\"\"\nif self._prevMeta == None:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"\"\"\n            select unix_timestamp(uploadTime), bvid from BOT_DATA.bilibiliUp where\n            uid = %d\n            \"\"\"%self.uid)\nmeta = list(mycursor)\nif len(meta) != 0:\nself._prevMeta = meta[0]\nreturn self._prevMeta\ndef writeMeta(self, uploadTime:int, bvid:str)-&gt;None:\n\"\"\"\u200b\u5199\u5165\u200bup\u200b\u4e3b\u200b\u672c\u6b21\u200b\u4e0a\u4f20\u200b\u6570\u636e\u200b\"\"\"\nmeta = (uploadTime, bvid)\nif self._prevMeta == meta: return\nself._prevMeta = meta\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmydb.autocommit = True\nmycursor.execute(\"\"\"\n        insert into BOT_DATA.bilibiliUp set\n        uploadTime = from_unixtime(%s),\n        bvid = %s,\n        uid = %s\n        on duplicate key update\n        uploadTime = from_unixtime(%s),\n        bvid = %s\n        \"\"\", (uploadTime, bvid, self.uid, uploadTime, bvid))\ndef cancel(self,) -&gt; None:\nif self.job != None: \nself.job.remove()\ndef pause(self) -&gt; None:\nif self.job != None:\nself.job.pause()\ndef resume(self) -&gt; None:\nif self.job != None:\nself.job.resume()\ndef __del__(self,):\nself.cancel()\n</code></pre>"},{"location":"plugin/plugins/canvasIcsPlugin/","title":"SJTU canvas\u200b\u65e5\u5386","text":""},{"location":"plugin/plugins/canvasIcsPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b CanvasiCalBind StandardPlugin '-ics bind ${url}' None \u200b\u7ed1\u5b9a\u200bcanvas ics\u200b\u94fe\u63a5\u200b CanvasiCalUnbind StandardPlugin '-ics unbind' None \u200b\u89e3\u7ed1\u200bcanvas ics\u200b\u94fe\u63a5\u200b GetCanvas StandardPlugin '-ddl' / '-canvas' None \u200b\u83b7\u53d6\u200bcanvas\u200b\u65e5\u5386\u200b\u9988\u9001"},{"location":"plugin/plugins/canvasIcsPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u4ee3\u7801\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>ROOT_ADMIN_ID = [111, # \u200b\u7528\u6237\u200bA  \n222, # \u200b\u7528\u6237\u200bB\n444] # \u200b\u7528\u6237\u200bD\nGroupPluginList = [ # \u200b\u7fa4\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\n# .....\nPluginGroupManager([GetCanvas(), CanvasiCalBind(), CanvasiCalUnbind()], 'canvas'), # \u200b\u65e5\u5386\u200b\u9988\u9001\u200b\n# .....\n]\nPrivatePluginList=[ # \u200b\u79c1\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\n# .....\nGetCanvas(), CanvasiCalBind(), CanvasiCalUnbind()\n# .....\n]\n</code></pre> <p>\u200b\u7fa4\u804a\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code># \u200b\u7fa4\u5185\u200b\u5c1a\u672a\u200b\u6253\u5f00\u200bcanvas\n333&gt; -ddl\n# \u200b\u65e0\u200b\u4e8b\u200b\u53d1\u751f\u200b\n# \u200b\u63a5\u4e0b\u6765\u200b\u7ba1\u7406\u5458\u200b\u6253\u5f00\u200bcanvas\n111&gt; -grpcfg enable canvas\nbot&gt; OK\n\n# \u200b\u6b64\u65f6\u200b\u7528\u6237\u200bC\u200b\u5c1a\u672a\u200b\u7ed1\u5b9a\u200bics url\n333&gt; -ddl\nbot&gt;    \u200b\u67e5\u8be2\u200b\u5931\u8d25\u200b\n        \u200b\u8bf7\u200b\u7fa4\u804a\u200b\u6216\u200b\u79c1\u804a\u200b\u4f7f\u7528\u200b-ics bind ${url} \u200b\u7ed1\u5b9a\u200b\u60a8\u200b\u7684\u200bCanvas iCal\u200b\u9988\u9001\u200b\u94fe\u63a5\u200b\n        ${url}\u200b\u53ef\u200b\u5728\u200b canvas - \u200b\u65e5\u5386\u200b\ud83d\udcc5 - \u200b\u65e5\u5386\u200b\u9988\u9001\u200b \u200b\u4e2d\u200b\u83b7\u53d6\u200b\n\n# \u200b\u7528\u6237\u200bC\u200b\u7ed1\u5b9a\u200bcanvas\n333&gt; -ics bind ${\u200b\u7528\u6237\u200bC\u200b\u7684\u200bicsUrl}\nbot&gt; OK\n333&gt; -ddl\nbot&gt; ${333\u200b\u7684\u200bcanvas\u200b\u65e5\u5386\u200b\u56fe\u7247\u200b}\n# \u200b\u7528\u6237\u200bC\u200b\u89e3\u7ed1\u200b\u540e\u200b\u67e5\u8be2\u200b\n333&gt; -ics unbind\nbot&gt; OK\n333&gt; -ddl\nbot&gt;    \u200b\u67e5\u8be2\u200b\u5931\u8d25\u200b\n        \u200b\u8bf7\u200b\u7fa4\u804a\u200b\u6216\u200b\u79c1\u804a\u200b\u4f7f\u7528\u200b-ics bind ${url} \u200b\u7ed1\u5b9a\u200b\u60a8\u200b\u7684\u200bCanvas iCal\u200b\u9988\u9001\u200b\u94fe\u63a5\u200b\n        ${url}\u200b\u53ef\u200b\u5728\u200b canvas - \u200b\u65e5\u5386\u200b\ud83d\udcc5 - \u200b\u65e5\u5386\u200b\u9988\u9001\u200b \u200b\u4e2d\u200b\u83b7\u53d6\u200b\n</code></pre> <p>\u200b\u56fe\u7247\u200b\u5c55\u793a\u200b\uff1a</p> <p></p>"},{"location":"plugin/plugins/canvasIcsPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u65e7\u200b\u7684\u200b\u7ed8\u56fe\u200b\u4ee3\u7801\u200b</p> <p>\u200b\u8fd9\u662f\u200b\u65e9\u671f\u200b\u5b8c\u6210\u200b\u7684\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u7ed8\u56fe\u200b\u90e8\u5206\u200b\u4ee3\u7801\u200b\u5e76\u672a\u200b\u4f7f\u7528\u200b\u63a8\u8350\u200b\u7684\u200b responseImage \u200b\u5e93\u200b</p> <pre><code>from utils.standardPlugin import StandardPlugin, Any, Union\nimport requests\nfrom utils.basicEvent import *\nfrom utils.basicConfigs import *\nfrom pathlib import Path\nimport json\nfrom icalendar import Calendar\nfrom datetime import datetime, timedelta\nimport re\nimport mysql.connector\nclass CanvasiCalUnbind(StandardPlugin):\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn msg.strip() == '-ics unbind'\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nif unbind_ics(data['user_id']):\nsend(target,\"\u200b\u89e3\u7ed1\u200b\u6210\u529f\u200b\", data['message_type'])\nelse:\nsend(target,\"\u200b\u89e3\u7ed1\u200b\u5931\u8d25\u200b\", data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'CanvasiCalUnbind',\n'description': 'canvas\u200b\u65e5\u5386\u200b\u89e3\u7ed1\u200b',\n'commandDescription': '-ics unbind',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass CanvasiCalBind(StandardPlugin): \ndef __init__(self) -&gt; None:\n# \u200b\u5916\u90e8\u200b\u670d\u52a1\u200b\uff0c\u200b\u9632\u6b62\u200bsql\u200b\u6ce8\u5165\u200b\u3001url\u200b\u6ce8\u5165\u200b\nself.urlRegex = re.compile(r'https://(oc.sjtu.edu.cn|jicanvas.com)/feeds/calendars/user_[a-zA-Z0-9]{40}.ics')\n# \u200b\u68c0\u67e5\u200bsql\u200b\u662f\u5426\u200b\u5f00\u200b\u4e86\u200bBOT_DATA.canvasIcs\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"\"\"create table if not exists `BOT_DATA`.`canvasIcs` (\n                `qq` bigint not null,\n                `icsUrl` char(128) not null,\n                primary key (`qq`)\n            );\"\"\")\nexcept BaseException as e:\nwarning('canvas ics \u200b\u65e0\u6cd5\u200b\u8fde\u63a5\u200b\u81f3\u200b\u6570\u636e\u5e93\u200b, error: {}'.format(e))\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn startswith_in(msg, ['-ics bind '])\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nmsg=msg.replace('-ics bind','',1).strip()\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nif self.urlRegex.match(msg) == None or len(msg) &gt; 110:\nsend(target,'\u200b\u683c\u5f0f\u200b\u9519\u8bef\u200b\uff0c\u200b\u8bf7\u200b\u68c0\u67e5\u200bics\u200b\u94fe\u63a5\u200b\u7b26\u5408\u200b\u683c\u5f0f\u200b:\\n'+\nr're.compile(r\"https://(oc.sjtu.edu.cn|jicanvas.com)/feeds/calendars/user_[a-zA-Z0-9]{40}.ics\")'+\n\"\\n\u3010\u200b\u5df2\u200b\u505a\u9632\u200b\u6ce8\u5165\u200b\u5904\u7406\u200b\u3011\", data['message_type'])\nelse:\nif edit_bind_ics(data['user_id'], msg):\nsend(target,\"\u200b\u7ed1\u5b9a\u200b\u6210\u529f\u200b\", data['message_type'])\nelse:\nsend(target,\"\u200b\u7ed1\u5b9a\u200b\u5931\u8d25\u200b\", data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'CanvasiCalBind',\n'description': 'canvas\u200b\u65e5\u5386\u200b\u7ed1\u5b9a\u200b',\n'commandDescription': '-ics bind [url]',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass GetCanvas(StandardPlugin): \ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg.strip() in ['-ddl', '-canvas']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nret = getCanvas(data['user_id'])\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nif not ret[0]:\nsend(target ,ret[1], data['message_type'])\nelse:\ncanvasPicPath = os.path.join(ROOT_PATH, ret[1])\nsend(target,f'[CQ:image,file=files://{canvasPicPath},id=40000]', data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'GetCanvas',\n'description': 'canvas\u200b\u6d3b\u52a8\u200b\u67e5\u8be2\u200b',\n'commandDescription': '-ddl/-canvas',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': ['canvasIcs'],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\ndef unbind_ics(qq_id: Union[int, str])-&gt;bool:\nif isinstance(qq_id, str):\nqq_id = int(qq_id)\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"delete from `BOT_DATA`.`canvasIcs` where qq=%d\"%(qq_id))\nmydb.commit()\nreturn True\nexcept BaseException as e:\nwarning(\"error in canvasSync, error: {}\".format(e))\nreturn False\ndef edit_bind_ics(qq_id: Union[int, str], ics_url: str)-&gt;bool:\nif isinstance(qq_id, str):\nqq_id = int(qq_id)\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"replace into `BOT_DATA`.`canvasIcs` values (%d, '%s')\"%(qq_id, escape_string(ics_url)))\nmydb.commit()\nreturn True\nexcept BaseException as e:\nwarning(\"error in canvasSync, error: {}\".format(e))\nreturn False\nFAIL_REASON_1=\"\u200b\u8bf7\u200b\u7fa4\u804a\u200b\u6216\u200b\u79c1\u804a\u200b\u4f7f\u7528\u200b-ics bind ${url} \u200b\u7ed1\u5b9a\u200b\u60a8\u200b\u7684\u200bCanvas iCal\u200b\u9988\u9001\u200b\u94fe\u63a5\u200b\\n ${url}\u200b\u53ef\u200b\u5728\u200b canvas - \u200b\u65e5\u5386\u200b\ud83d\udcc5 - \u200b\u65e5\u5386\u200b\u9988\u9001\u200b \u200b\u4e2d\u200b\u83b7\u53d6\u200b\"\nFAIL_REASON_2=\"\u200b\u65e0\u6cd5\u200b\u83b7\u53d6\u200b\u6216\u200b\u89e3\u6790\u200b\u65e5\u5386\u200b\u6587\u4ef6\u200b\"\ndef getCanvas(qq_id) -&gt; Tuple[bool, str]:\nif isinstance(qq_id, str):\nqq_id = int(qq_id)\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"select icsUrl from `BOT_DATA`.`canvasIcs` where qq=%d\"%(qq_id))\nurls = list(mycursor)\nif len(urls) == 0:\nreturn False, f\"\u200b\u67e5\u8be2\u200b\u5931\u8d25\u200b\\n{FAIL_REASON_1}\"\nelse:\nurl = urls[0][0]\nexcept BaseException as e:\nwarning(\"error in canvasSync, error: {}\".format(e))\nqq_id=str(qq_id)\ntry:\nret = requests.get(url=url)\ndata = ret.content\ngcal = Calendar.from_ical(data)\nevent_list = []\nfor component in gcal.walk():\nif component.name == \"VEVENT\":\nnow = time.localtime()\nddl_time = component.get('dtend').dt\nif not isinstance(ddl_time,datetime):\ntmp=datetime.strftime(ddl_time,\"%Y-%m-%d\")+\" 23:59:59\"\nddl_time = datetime.strptime(tmp,\"%Y-%m-%d %H:%M:%S\")\nelse:\nddl_time+=timedelta(hours=8)\ntmp = datetime.strftime(ddl_time, \"%Y-%m-%d %H:%M:%S\")\nif time.mktime(time.strptime(tmp, \"%Y-%m-%d %H:%M:%S\")) &lt; time.mktime(now):\ncontinue\nddl_time = datetime.strftime(ddl_time,\"%Y-%m-%d %H:%M\")\nevent_list.append([component.get('summary'), component.get('description'), ddl_time])\nreturn True, DrawEventListPic(event_list, qq_id)\nexcept Exception as e:\nprint(e)\nreturn False, f\"\u200b\u67e5\u8be2\u200b\u5931\u8d25\u200b\\n{FAIL_REASON_2}\"\ndef DrawEventListPic(event_list, qq_id):\nproceed_list = []\nwidth=880\nh_title, h_des = 0, 0\nfor summary, description, deadline in event_list[:10]:\n# print(description.replace('\\n','-sep-'))\nif description==None:\ndescription = ''\nh_block=0 #\u200b\u5757\u200b\u5185\u200b\u52a8\u6001\u200b\u9ad8\u5ea6\u200b\ntxt_line=\"\"\ntitle_parse=[]\nsummary = summary.replace('[\u200b\u672c\u200b-', '\\n[\u200b\u672c\u200b-')\nfor word in summary:\nif txt_line==\"\" and word in ['\uff0c','\uff1b','\u3002','\u3001','\"','\uff1a','.','\u201d']: #\u200b\u907f\u514d\u200b\u6807\u70b9\u7b26\u53f7\u200b\u5728\u200b\u9996\u4f4d\u200b\ntitle_parse[-1]+=word\ncontinue\ntxt_line+=word\nif font_syhtmed_24.getsize(txt_line)[0]&gt;width-180:\ntitle_parse.append(txt_line)\ntxt_line=\"\"\nif word=='\\n':\ntitle_parse.append(txt_line)\ntxt_line=\"\"\ncontinue\nif txt_line!=\"\":\ntitle_parse.append(txt_line)\nh_title+=len(title_parse)*33\ntxt_line=\"\"\ndescription_parse=[]\ndescription_re = re.sub('\\n+','\\n', description)\ndescription_re = description_re.replace('\\xa0','')\nfor word in description_re:\nif txt_line==\"\" and word in ['\uff0c','\uff1b','\u3002','\u3001','\"','\uff1a','.','\u201d']: #\u200b\u907f\u514d\u200b\u6807\u70b9\u7b26\u53f7\u200b\u5728\u200b\u9996\u4f4d\u200b\ndescription_parse[-1]+=word\ncontinue\ntxt_line+=word\nif font_syhtmed_18.getsize(txt_line)[0]&gt;width-180:\ndescription_parse.append(txt_line)\ntxt_line=\"\"\nif word=='\\n':\ndescription_parse.append(txt_line)\ntxt_line=\"\"\ncontinue\nif txt_line!=\"\":\ndescription_parse.append(txt_line)\nh_des+=len(description_parse)*27\n# print(description_parse)\nh_block+=(len(title_parse)*33+len(description_parse)*27)\nif len(description_parse)==0:\nh_des-=15\nh_block-=15\nproceed_list.append([title_parse, description_parse, deadline, h_block])\nheight=len(event_list[:10])*150+190+(240 if len(event_list)==0 else 0)+h_title+h_des+(40 if len(event_list)&gt;10 else 0)\nimg, draw, h = init_image_template('Canvas \u200b\u65e5\u5386\u200b\u9988\u9001\u200b', width, height, (0, 142, 226, 255))\nh+=130\nfor title, description, deadline, h_block in proceed_list:\nimg = draw_rounded_rectangle(img, x1=60, y1=h, x2=width-60 ,y2=h+120+h_block, fill=(255,255,255,255))\nl = 90\nt = h+30 # \u200b\u8ddd\u200b \u200b\u5757\u200b\u9876\u200b \u200b\u5750\u6807\u200b\nfor line in title:\ndraw.text((l,t), line, fill=(0,0,0,255),font = font_syhtmed_24)\nt+=33\nt+=17\ndraw.text((l,t), '\u200b\u7ed3\u675f\u200b\u65f6\u95f4\u200b\uff1a'+deadline, fill=(0, 142, 226, 255),font = font_syhtmed_24)\nt+=50\nfor line in description:\ndraw.text((l,t), line, fill=(115,115,115,255),font = font_syhtmed_18)\nt+=27\nh+=(140+h_block)\nif len(event_list)==0:\nimg = draw_rounded_rectangle(img, x1=60, y1=h, x2=width-60 ,y2=h+210, fill=(255,255,255,255))\ntxt_size=draw.textsize('\u200b\u606d\u559c\u200b\u4f60\u200b\uff0c\u200b\u6ca1\u6709\u200b\u5373\u5c06\u200b\u5230\u671f\u200b\u7684\u200bddl~', font = font_syhtmed_32)\ndraw.text(((width-txt_size[0])/2+5,h+80), '\u200b\u606d\u559c\u200b\u4f60\u200b\uff0c\u200b\u6ca1\u6709\u200b\u5373\u5c06\u200b\u5230\u671f\u200b\u7684\u200bddl~', fill=(0,0,0,255),font = font_syhtmed_32)\nif len(event_list)&gt;10:\ntxt_size = draw.textsize('\u200b\u65e5\u5386\u200b\u9879\u592a\u591a\u200b\u5566\u200b\uff0c\u200b\u53ea\u200b\u663e\u793a\u200b\u4e86\u200b\u524d\u200b10\u200b\u6761\u200bqwq',font=font_syhtmed_18)\ndraw.text((width/2-txt_size[0]/2, height-85),'\u200b\u65e5\u5386\u200b\u9879\u592a\u591a\u200b\u5566\u200b\uff0c\u200b\u53ea\u200b\u663e\u793a\u200b\u4e86\u200b\u524d\u200b10\u200b\u6761\u200bqwq', fill=(115,115,115,255) ,font = font_syhtmed_18) \nsave_path= os.path.join(SAVE_TMP_PATH, f'{qq_id}_canvas.png')\nimg.save(save_path)\nreturn save_path\n</code></pre>"},{"location":"plugin/plugins/faqPlugin/","title":"\u95ee\u7b54\u200b\u5e93","text":""},{"location":"plugin/plugins/faqPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b HelpFAQ StandardPlugin \u200b\u95ee\u7b54\u200b\u5e2e\u52a9\u200b None \u200b\u83b7\u53d6\u200b\u95ee\u7b54\u200b\u5e2e\u52a9\u200b AskFAQ StandardPlugin '\u200b\u95ee\u200b [..]' / 'q [..]' None \u200b\u83b7\u53d6\u200b\u95ee\u7b54\u200b\u5185\u5bb9\u200b MaintainFAQ StandardPlugin 'faq [...]' None \u200b\u7ef4\u62a4\u200b\u95ee\u7b54\u200b\u5e93"},{"location":"plugin/plugins/faqPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u804a\u5929\u200b\u65b9\u9762\u200b\uff1a</p> <pre><code>111&gt; -faq help\nbot&gt; \u3010faq\u200b\u5e2e\u52a9\u200b\u56fe\u7247\u200b\u3011\n222&gt; faq add sjtu \u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b\nbot&gt; [\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b]\u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b \u3010sjtu\u3011\n333&gt; faq edit sjtu \u200b\u4e0a\u4ea4\u200b\nbot&gt; [\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b]\u200b\u4e0a\u4ea4\u200b \u3010sjtu\u3011\n111&gt; faq cp sjtu \u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b\nbot&gt; [\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b]\u200b\u4e0a\u4ea4\u200b \u3010\u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b\u3011\n222&gt; faq del sjtu\nbot&gt; [\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b]\u200b\u95ee\u9898\u200b\u5220\u9664\u200b\u6210\u529f\u200b\n444&gt; faq append \u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b \u200b\u5927\u200b\nbot&gt; [\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b]\u200b\u4e0a\u4ea4\u200b\u5927\u200b \u3010\u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b\u3011\n111&gt; faq show\nbot&gt; \u3010\u200b\u7fa4\u804a\u200bfaq\u200b\u603b\u8868\u200b\uff08\u200b\u6309\u200b\u5b57\u6bcd\u200b\u6392\u5e8f\u200b\uff09\u3011\n222&gt; faq ls -2\nbot&gt; \u3010\u200b\u7fa4\u804a\u200bfaq\u200b\u603b\u8868\u200b\uff08\u200b\u6309\u200btag\u200b\u6392\u5e8f\u200b\uff09\u3011\n111&gt; faq history \u200b\u738b\u200b\nbot&gt; \u3010question`\u200b\u738b\u200b`\u200b\u5386\u53f2\u200b\u3011\n</code></pre> <p>faq\u200b\u5e2e\u52a9\u200b\u56fe\u7247\u200b\uff1a</p> <p></p> <p>\u200b\u7fa4\u804a\u200bfaq\u200b\u603b\u8868\u200b\uff08\u200b\u6309\u200b\u5b57\u6bcd\u200b\u6392\u5e8f\u200b\uff09</p> <p></p> <p>\u200b\u7fa4\u804a\u200bfaq\u200b\u603b\u8868\u200b\uff08\u200b\u6309\u200btag\u200b\u6392\u5e8f\u200b\uff09</p> <p></p> <p>question <code>\u200b\u738b\u200b</code> \u200b\u5386\u53f2\u200b</p> <p></p>"},{"location":"plugin/plugins/faqPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b plugins/faq_v2.py</p> <pre><code>FAQ_DATA_PATH=\"data\"\ndef createFaqTable(tableName: str):\n# warning: tableName may danger\nif not isinstance(tableName, str):\ntableName = str(tableName)\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\nmycursor.execute(\"\"\"\n    create table if not exists `BOT_FAQ_DATA`.`%s` (\n        `faq_seq` bigint unsigned not null auto_increment,\n        `question` varchar(100) not null,\n        `latest` bool not null default true,\n        `answer` varchar(4000) not null,\n        `modify_user_id` bigint not null,\n        `modify_time` timestamp not null,\n        `group_tag` varchar(100) not null default '',\n        `deleted` bool not null default false,\n        primary key (`faq_seq`),\n        index(`question`, `latest`, `deleted`),\n        index(`group_tag`, `latest`, `deleted`)\n    )charset=utf8mb4, collate=utf8mb4_unicode_ci;\n    \"\"\"%(\nescape_string(tableName)\n))\ndef createFaqDb():\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\nmycursor.execute(\"create database if not exists `BOT_FAQ_DATA`\")\ncreateFaqTable(\"globalFaq\")\nclass HelpFAQ(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg == '\u200b\u95ee\u7b54\u200b\u5e2e\u52a9\u200b' and data['message_type']=='group'\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ngroup_id = data['group_id']\npicPath = draw_help_pic(group_id)\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\nsend(group_id, '[CQ:image,file=files://%s]'%picPath)\nreturn \"OK\"\ndef getPluginInfo(self)-&gt;Any:\nreturn {\n'name': 'AskFAQ',\n'description': '\u200b\u95ee\u7b54\u200b\u5e2e\u52a9\u200b',\n'commandDescription': '\u200b\u95ee\u7b54\u200b\u5e2e\u52a9\u200b',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.4',\n'author': 'Unicorn',\n}\ndef get_answer(group_id: int, key: str)-&gt;Tuple[bool, str]:\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"\"\"\n    select `answer` from `BOT_FAQ_DATA`.`%d` where \n        `question` = '%s' and\n        `latest` = true and\n        `deleted` = false\n    \"\"\"%(\ngroup_id, \nescape_string(key),\n))\nanswer = list(mycursor)\nif len(answer) == 0:\nreturn False, ''\nelse:\nreturn True, answer[0][0]\ndef rollback_answer(group_id:int, question:str)-&gt;bool:\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"\"\"\n        select max(`faq_seq`) from `BOT_FAQ_DATA`.`%d` where question = '%s'\n        \"\"\"%(group_id, escape_string(question)))\nfaq_seq = list(mycursor)[0][0]\nif faq_seq == None:\nreturn False\nelse:\nmycursor.execute(\"\"\"\n            delete from `BOT_FAQ_DATA`.`%d` where `faq_seq` = %d\n            \"\"\"%(group_id, faq_seq))\nmycursor.execute(\"\"\"\n            update `BOT_FAQ_DATA`.`%d` set `latest` = true where\n            `faq_seq` = (\n                select * from (\n                    select max(`faq_seq`) from `BOT_FAQ_DATA`.`%d`\n                    where question = '%s'\n                )a\n            )\n            \"\"\"%(group_id, group_id, escape_string(question)))\nexcept mysql.connector.Error as e:\nwarning('mysql error in faq rollback_answer: {}'.format(e))\nreturn False\nexcept KeyError as e:\nwarning(\"key error in faq rollback_answer: {}\".format(e))\nreturn False\nexcept BaseException as e:\nwarning(\"exception in faq rollback_answer: {}\".format(e))\nreturn False\nreturn True\ndef update_answer(group_id:int, question:str, answer:str, data:Any, tag:str = '',delete:bool= False)-&gt;bool:\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"\"\"\n        update `BOT_FAQ_DATA`.`%d` \n        set\n            `latest` = false\n        where\n            `question` = '%s' and\n            `latest` = true\n        \"\"\"%(\ngroup_id,\nescape_string(question)\n))\nmycursor.execute(\"\"\"\n        insert into `BOT_FAQ_DATA`.`%d` (\n            `question`, `answer`, `modify_user_id`, `modify_time`, `deleted`, `group_tag`\n        ) values (\n            '%s', '%s', %d, from_unixtime(%d), %s, '%s'\n        )\"\"\"%(\ndata['group_id'],\nescape_string(question),\nescape_string(answer),\ndata['user_id'],\ndata['time'],\n'true' if delete else False,\nescape_string(tag)\n))\nexcept mysql.connector.Error as e:\nwarning('mysql error in faq update_answer: {}'.format(e))\nreturn False\nexcept KeyError as e:\nwarning(\"key error in faq update_answer: {}\".format(e))\nreturn False\nexcept BaseException as e:\nwarning(\"exception in faq update_answer: {}\".format(e))\nreturn False\nreturn True\nclass AskFAQ(StandardPlugin):\ndef __init__(self):\nself.pattern = re.compile(r'^(\u200b\u95ee\u200b|q)\\s+([^\\s]+)$')\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn self.pattern.match(msg) != None and data['message_type']=='group'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nquestion = self.pattern.findall(msg)[0][1]\ngroup_id = data['group_id']\nhasMsg, ans = get_answer(group_id, question)\nif hasMsg:\nans = \"[CQ:reply,id=%d]%s\\n\u3010%s\u3011\"%(data['message_id'], ans, question)\nelse:\nans = \"[CQ:reply,id=%d]\u200b\u672a\u200b\u67e5\u8be2\u200b\u5230\u200b\u4fe1\u606f\u200b\"%(data['message_id'])\nsend(group_id, ans)\ndef getPluginInfo(self)-&gt;Any:\nreturn {\n'name': 'AskFAQ',\n'description': '\u200b\u95ee\u7b54\u200b\u5e93\u200b',\n'commandDescription': '\u200b\u95ee\u200b [...]',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.4',\n'author': 'Unicorn',\n}\nclass MaintainFAQ(StandardPlugin):\ndef __init__(self):\nself.findModPattern = re.compile(r\"^faq\\s+([^\\s]+)\\s*(.*)$\")\nself.modMap = {\n'show': MaintainFAQ.faqShow,\n'ls': MaintainFAQ.faqShow,\n'new': MaintainFAQ.faqAdd,\n'add': MaintainFAQ.faqAdd,\n'edit': MaintainFAQ.faqEdit,\n'cp': MaintainFAQ.faqCp,\n'del': MaintainFAQ.faqDel,\n'append': MaintainFAQ.faqAppend,\n'tag': MaintainFAQ.faqTag,\n'rollback': MaintainFAQ.faqRollBack,\n'history': MaintainFAQ.faqHistory,\n'help': MaintainFAQ.faqHelp,\n}\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn self.findModPattern.match(msg) != None and data['message_type']=='group'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nmod, cmd = self.findModPattern.findall(msg)[0]\nif mod in self.modMap.keys():\nself.modMap[mod](cmd, data)\nelse:\nsend(data['group_id'], '\u200b\u8f93\u5165\u200b\u683c\u5f0f\u200b\u4e0d\u200b\u5bf9\u200b\u54e6\u200b\uff0c\u200b\u8bf7\u200b\u8f93\u5165\u200b\u3010\u200b\u95ee\u7b54\u200b\u5e2e\u52a9\u200b\u3011\u200b\u83b7\u53d6\u200b\u64cd\u4f5c\u200b\u6307\u5357\u200b')\nreturn \"OK\"\ndef getPluginInfo(self)-&gt;Any:\nreturn {\n'name': 'MaintainFAQ',\n'description': '\u200b\u7ef4\u62a4\u200b\u95ee\u7b54\u200b\u5e93\u200b',\n'commandDescription': 'faq &lt;mod&gt; [...]',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.4',\n'author': 'Unicorn',\n}\n@staticmethod\ndef faqShow(cmd: str, data):\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\ngroupId = data['group_id']\nif cmd == '' or cmd == '-1':\nmycursor.execute(\"\"\"select `question` from `BOT_FAQ_DATA`.`%d`\n            where latest = true and deleted = false\n            \"\"\"%groupId)\nquestions = [q[0] for q in list(mycursor)]\npicPath = drawQuestionCardByPinyin(questions, groupId)\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\nsend(groupId, '[CQ:image,file=files://%s,id=40000]'%picPath)\nelif cmd == '-2':\nmycursor.execute(\"\"\"select `group_tag`, `question` from `BOT_FAQ_DATA`.`%d`\n            where latest = true and deleted = false\n            \"\"\"%groupId)\nquestions: Dict[str, List[str]] = {}\nfor tag, q in list(mycursor):\nif tag not in questions.keys():\nquestions[tag] = [q]\nelse:\nquestions[tag].append(q)\npicPath = drawQuestionCardByTag(questions, groupId)\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\nsend(groupId, '[CQ:image,file=files://%s,id=40000]'%picPath)\nelse:\nsend(groupId, \"\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq show(/ -1/ -2)\")\n@staticmethod\ndef faqAdd(cmd: str, data):\npattern = re.compile(r'^([^\\s]+)\\s*(.*)$')\nqa = pattern.findall(cmd)\ngroupId = data['group_id']\nif len(qa) == 0:\nsend(groupId, '\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq (new/add) &lt;key&gt; (&lt;ans&gt;)')\nelse:\nquestion, answer = qa[0]\nstatus, _ = get_answer(groupId, question)\nif status:\nsend(groupId, '[CQ:reply,id=%d]\u200b\u95ee\u9898\u200b\u3010%s\u3011\u200b\u5df2\u7ecf\u200b\u5b58\u5728\u200b'%(data['message_id'], question))\nelse:\nstatus = update_answer(groupId, question, answer, data)\nif status:\nsend(groupId, \"[CQ:reply,id=%d]%s\\n\u3010%s\u3011\"%(data['message_id'], answer, question))\nelse:\nsend(groupId, '[CQ:reply,id=%d]\u200b\u66f4\u65b0\u200b\u5931\u8d25\u200b'%data['message_id'])\n@staticmethod\ndef faqEdit(cmd: str, data):\npattern = re.compile(r'^([^\\s]+)\\s*(.*)$')\nqa = pattern.findall(cmd)\ngroupId = data['group_id']\nif len(qa) == 0:\nsend(groupId, '\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq edit &lt;key&gt; &lt;ans&gt;')\nelse:\nquestion, answer = qa[0]\nstatus, _ = get_answer(groupId, question)\nif not status:\nsend(groupId, '[CQ:reply,id=%d]\u200b\u95ee\u9898\u200b\u4e0d\u200b\u5b58\u5728\u200b\uff0c\u200b\u8bf7\u200b\u5148\u200b\u4f7f\u7528\u200b\"faq add\"\u200b\u8bed\u53e5\u200b\u521b\u5efa\u200b\u8be5\u200b\u95ee\u9898\u200b'%data['message_id'])\nelse:\nstatus = update_answer(groupId, question, answer, data)\nif status:\nsend(groupId, \"[CQ:reply,id=%d]%s\\n\u3010%s\u3011\"%(data['message_id'], answer, question))\nelse:\nsend(groupId, '[CQ:reply,id=%d]\u200b\u66f4\u65b0\u200b\u5931\u8d25\u200b'%data['message_id'])\n@staticmethod\ndef faqCp(cmd: str, data):\npattern = re.compile(r'^([^\\s]+)\\s+([^\\s]+)$')\nqa = pattern.findall(cmd)\ngroupId = data['group_id']\nif len(qa) == 0:\nsend(groupId, '\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq cp &lt;name&gt; &lt;new name&gt;')\nelse:\nprevName, newName = qa[0]\nstatus, answer = get_answer(groupId, prevName)\nif not status:\nsend(groupId,\"[CQ:reply,id=%d]\u3010%s\u3011\u200b\u95ee\u9898\u200b\u4e0d\u200b\u5b58\u5728\u200b\"%(data['message_id'], prevName))\nelse:\nstatus = update_answer(groupId, newName, answer, data)\nif status:\nsend(groupId, \"[CQ:reply,id=%d]%s\\n\u3010%s\u3011\"%(data['message_id'], answer, newName))\nelse:\nsend(groupId, '[CQ:reply,id=%d]\u200b\u95ee\u9898\u200b\u590d\u5236\u200b\u5931\u8d25\u200b'%data['message_id'])\n@staticmethod\ndef faqDel(cmd: str, data):\npattern = re.compile(r'^([^\\s]+)\\s*$')\nquestion = pattern.findall(cmd)\ngroupId = data['group_id']\nif len(question) == 0:\nsend(groupId, '\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq del &lt;key&gt;')\nelse:\nquestion = question[0][0]\nstatus, _ = get_answer(groupId, question)\nif not status:\nsend(groupId, \"[CQ:reply,id=%d]\u200b\u95ee\u9898\u200b\u4e0d\u200b\u5b58\u5728\u200b\"%(data['message_id']))\nelse:\nstatus = update_answer(groupId, question, '', data, delete=True)\nif status:\nsend(groupId, \"[CQ:reply,id=%d]\u200b\u95ee\u9898\u200b\u5220\u9664\u200b\u6210\u529f\u200b\"%(data['message_id']))\nelse:\nsend(groupId, \"[CQ:reply,id=%d]\u200b\u95ee\u9898\u200b\u5220\u9664\u200b\u5931\u8d25\u200b\"%(data['message_id']))\n@staticmethod\ndef faqAppend(cmd: str, data):\npattern = re.compile(r'^([^\\s]+)\\s(.*)$')\nqa = pattern.findall(cmd)\ngroupId = data['group_id']\nif len(qa) == 0:\nsend(groupId, '\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq append &lt;key&gt; &lt;ans to append&gt;')\nelse:\nquestion, answer = qa[0]\nstatus, prevAns = get_answer(groupId, question)\nif not status:\nsend(groupId,\"[CQ:reply,id=%d]\u3010%s\u3011\u200b\u95ee\u9898\u200b\u4e0d\u200b\u5b58\u5728\u200b\"%(data['message_id'], question))\nelse:\nanswer = prevAns + answer\nstatus = update_answer(groupId, question, answer, data)\nif status:\nsend(groupId, \"[CQ:reply,id=%d]%s\\n\u3010%s\u3011\"%(data['message_id'], answer, question))\nelse:\nsend(groupId, '[CQ:reply,id=%d]\u200b\u66f4\u65b0\u200b\u5931\u8d25\u200b'%data['message_id'])\n@staticmethod\ndef faqTag(cmd: str, data):\npattern = re.compile(r'^([^\\s]+)\\s+([^\\s]+)$')\nqa = pattern.findall(cmd)\ngroupId = data['group_id']\nif len(qa) == 0:\nsend(groupId, '\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq tag &lt;key&gt; &lt;tag&gt;')\nelse:\nquestion, tag = qa[0]\nstatus, answer = get_answer(groupId, question)\nif not status:\nsend(groupId,\"[CQ:reply,id=%d]\u3010%s\u3011\u200b\u95ee\u9898\u200b\u4e0d\u200b\u5b58\u5728\u200b\"%(data['message_id'], question))\nelse:\nstatus = update_answer(groupId, question, answer, data, tag=tag)\nif status:\nsend(groupId, \"[CQ:reply,id=%d]OK\"%(data['message_id']))\nelse:\nsend(groupId, '[CQ:reply,id=%d]\u200b\u66f4\u65b0\u200b\u5931\u8d25\u200b'%data['message_id'])\n@staticmethod\ndef faqRollBack(cmd: str, data):\ngroupId = data['group_id']\npattern = re.compile(r'^([^\\s]+)$')\nquestion = pattern.findall(cmd)\nif len(question) == 0:\nsend(groupId, '\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq rollback &lt;key&gt;')\nelse:\nif data['user_id'] not in getGroupAdmins(groupId):\nsend(groupId, '[CQ:reply,id=%d]\u200b\u60a8\u200b\u6ca1\u6709\u200b\u56de\u6eda\u200b\u8bb0\u5f55\u200b\u6743\u9650\u200b'%(data['message_id']))\nelse:\nquestion = question[0]\nstatus = rollback_answer(groupId, question)\nif status:\nsend(groupId, '[CQ:reply,id=%d]OK'%data['message_id'])\nelse:\nsend(groupId, '[CQ:reply,id=%d]\u200b\u8bb0\u5f55\u200b\u3010%s\u3011\u200b\u4e0d\u200b\u5b58\u5728\u200b'%(data['message_id'], question))\n@staticmethod\ndef faqHistory(cmd: str, data):\ngroupId = data['group_id']\npattern = re.compile(r'^([^\\s]+)$')\nquestion = pattern.findall(cmd)\nif len(question) == 0:\nsend(groupId, '\u200b\u8bed\u6cd5\u200b\u6709\u8bef\u200b\uff0c\u200b\u652f\u6301\u200b\u8bed\u53e5\u200b\u4e3a\u200b: faq history &lt;key&gt;')\nelse:\nif data['user_id'] not in getGroupAdmins(groupId):\nsend(groupId, '[CQ:reply,id=%d]\u200b\u60a8\u200b\u6ca1\u6709\u200b\u67e5\u770b\u200b\u8bb0\u5f55\u200b\u6743\u9650\u200b'%(data['message_id']))\nelse:\nquestion = question[0]\npicPath = draw_answer_history(groupId, question)\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\nsend(groupId, '[CQ:image,file=files://%s,id=40000]'%picPath)\n@staticmethod\ndef faqHelp(cmd: str, data):\ngroupId = data['group_id']\npicPath = draw_help_pic(groupId)\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\nsend(groupId, '[CQ:image,file=files://%s]'%picPath)\ndef drawQuestionCardByPinyin(questions: List[str], group_id: int)-&gt;str:\n\"\"\"\u200b\u7ed8\u5236\u200b\u95ee\u7b54\u200b\u5217\u8868\u200b\u56fe\u50cf\u200b\n    @questions: \u200b\u95ee\u9898\u200b\u5217\u8868\u200b\n    \"\"\"\nquestions = sorted(questions, key=lambda x: lazy_pinyin(x[0])[0].lower())\nletterGroups = {'abcde': [], 'fghij': [], 'klmno': [], 'pqrst': [], 'uvwxyz': [], '0-9': [], '#': []}\nfor q in questions:\nfirstLetter = lazy_pinyin(q[0])[0][0].lower()\nfirstLetter = ord(firstLetter)\nif firstLetter &gt;= ord('0') and firstLetter &lt;= ord('9'):\nletterGroups['0-9'].append(q)\nelif firstLetter &gt;= ord('a') and firstLetter &lt;= ord('e'):\nletterGroups['abcde'].append(q)\nelif firstLetter &gt;= ord('f') and firstLetter &lt;= ord('j'):\nletterGroups['fghij'].append(q)\nelif firstLetter &gt;= ord('k') and firstLetter &lt;= ord('o'):\nletterGroups['klmno'].append(q)\nelif firstLetter &gt;= ord('p') and firstLetter &lt;= ord('t'):\nletterGroups['pqrst'].append(q)\nelif firstLetter &gt;= ord('u') and firstLetter &lt;= ord('z'):\nletterGroups['uvwxyz'].append(q)\nelse:\nletterGroups['#'].append(q)\nhelpCards = ResponseImage(\ntitle = 'FAQ \u200b\u95ee\u9898\u200b\u5217\u8868\u200b', \ntitleColor = PALETTE_CYAN,\nlayout = 'two-column',\nwidth = 1280,\ncardBodyFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 24),\nfooter='\u200b\u7fa4\u53f7\u200b %d'%group_id\n)\nfor k, v in letterGroups.items():\ncardList = []\ncardList.append(('title', k))\ncardList.append(('separator', ))\ncardList.append(('body', \"\u3001\".join(v)))\nhelpCards.addCard(ResponseImage.RichContentCard(\nraw_content=cardList, titleFontColor=PALETTE_CYAN))\nsavePath = os.path.join(SAVE_TMP_PATH, '%d-faq.png'%group_id)\nhelpCards.generateImage(savePath)\nreturn savePath\ndef drawQuestionCardByTag(questions:Dict[str, List[str]], group_id: int)-&gt;str:\n\"\"\"\n    @questions: {\n        'tag0': [question00, question01, ...],\n        'tag1': [question10, question11, ...],\n    }\n    @group_id:  \u200b\u7fa4\u53f7\u200b\n    \"\"\"\nhelpCards = ResponseImage(\ntitle = 'FAQ \u200b\u95ee\u9898\u200b\u5217\u8868\u200b', \ntitleColor = PALETTE_CYAN,\nlayout = 'two-column',\nwidth = 1280,\ncardBodyFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 24),\nfooter='\u200b\u7fa4\u53f7\u200b %d'%group_id,\n)\nfor tag, qs in questions.items():\ncardList = []\ncardList.append(('title', tag))\ncardList.append(('separator', ))\ncardList.append(('body', \"\u3001\".join(qs)))\nhelpCards.addCard(ResponseImage.RichContentCard(\nraw_content=cardList, titleFontColor=PALETTE_CYAN))\nsavePath = os.path.join(SAVE_TMP_PATH, '%d-faq.png'%group_id)\nhelpCards.generateImage(savePath)\nreturn savePath\ndef draw_answer_history(group_id:int, question:str)-&gt;str:\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\ntry:\nmycursor.execute(\"\"\"select\n        `faq_seq`, `question`, `answer`, `latest`, `deleted`, `modify_user_id`, `modify_time`, `group_tag`\n        from `BOT_FAQ_DATA`.`%d` where `question` = '%s'\n        order by `faq_seq` desc limit 20\n        \"\"\"%(group_id, escape_string(question)))\nexcept mysql.connector.Error as e:\nwarning('mysql error in faq get_answer_history: {}'.format(e))\nreturn []\nexcept KeyError as e:\nwarning(\"key error in faq get_answer_history: {}\".format(e))\nreturn []\nexcept BaseException as e:\nwarning(\"exception in faq get_answer_history: {}\".format(e))\nreturn []\nhelpCards = ResponseImage(\ntitle = 'FAQ \u3010%s\u3011 \u200b\u5386\u53f2\u8bb0\u5f55\u200b'%question, \ntitleColor = PALETTE_CYAN,\nwidth = 1000,\ncardBodyFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 24),\nfooter= '\u200b\u7fa4\u53f7\u200b %d'%group_id,\n)\nfor faq_seq, question, answer, latest, deleted, modify_user_id, modify_time, group_tag in list(mycursor):\ncardList = []\ntitle = 'faq_seq = %d'% faq_seq\nif deleted:\ntitle += '  [DELETED]'\nif latest:\ntitle += '  [LATEST]'\ncardList.append(('title', title))\ncardList.append(('subtitle', '%s by %d'%(modify_time, modify_user_id)))\ncardList.append(('keyword', group_tag))\ncardList.append(('body', answer))\nhelpCards.addCard(ResponseImage.RichContentCard(\nraw_content=cardList,\ntitleFontColor=PALETTE_RED if deleted else PALETTE_CYAN,\n))\nsavePath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, '%d-faq-history.png'%(group_id, ))\nhelpCards.generateImage(savePath)\nreturn savePath\ndef draw_help_pic(group_id:int)-&gt;str:\n\"\"\"\u200b\u7ed8\u5236\u200bfaq\u200b\u5e2e\u52a9\u200b\n    @group_id:  \u200b\u7fa4\u53f7\u200b\n    @return:    \u200b\u56fe\u7247\u200b\u5b58\u50a8\u200b\u8def\u5f84\u200b\n    \"\"\"\nhelpWords = (\n\"\u200b\u67e5\u8be2\u200b\u5173\u952e\u5b57\u200b\uff1a 'q &lt;key&gt;' / '\u200b\u95ee\u200b &lt;key&gt;'\\n\"\n\"\u200b\u95ee\u7b54\u200b\u5e93\u200b\u6309\u200b\u62fc\u97f3\u200b\u6392\u5e8f\u200b\uff1a 'faq (show|ls)' / 'faq (show|ls) -1'\\n\"\n\"\u200b\u95ee\u7b54\u200b\u5e93\u200b\u6309\u200b\u5206\u7ec4\u200b\u6392\u5e8f\u200b\uff1a 'faq (show|ls) -2'\\n\"\n\"\u200b\u65b0\u5efa\u200b\u95ee\u9898\u200b\uff1a 'faq (new|add) &lt;key&gt; (&lt;original ans&gt;)'\\n\"\n\"\u200b\u66f4\u6539\u200b\u7b54\u6848\u200b\uff1a 'faq edit &lt;key&gt; &lt;new ans&gt;'\\n\"\n\"\u200b\u590d\u5236\u200b\u95ee\u9898\u200b\uff1a 'faq cp &lt;key&gt; &lt;new key&gt;'\\n\"\n\"\u200b\u5220\u9664\u200b\u95ee\u9898\u200b\uff1a 'faq del &lt;key&gt;'\\n\"\n\"\u200b\u9644\u52a0\u200b\u7b54\u6848\u200b\uff1a 'faq append &lt;key&gt; &lt;ans to append&gt;'\\n\"\n\"\u200b\u6807\u8bb0\u200b\u5206\u7ec4\u200b\uff1a 'faq tag &lt;key&gt; &lt;tag&gt;'\\n\"\n\"\u200b\u56de\u6eda\u200b(\u200b\u9700\u8981\u200b\u6743\u9650\u200b)\uff1a 'faq rollback &lt;key&gt;'\\n\"\n\"\u200b\u67e5\u770b\u200b\u8bb0\u5f55\u200b(\u200b\u9700\u8981\u200b\u6743\u9650\u200b)\uff1a 'faq history &lt;key&gt;'\\n\"\n\"\u200b\u83b7\u53d6\u200b\u5e2e\u52a9\u200b\uff1a 'faq help' / '\u200b\u95ee\u7b54\u200b\u5e2e\u52a9\u200b'\\n\\n\"\n)\nhelpCards = ResponseImage(\ntitle = 'FAQ \u200b\u5e2e\u52a9\u200b', \ntitleColor = PALETTE_CYAN,\nwidth = 1000,\ncardBodyFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 24),\nfooter='\u200b\u7fa4\u53f7\u200b %d'%group_id\n)\ncardList = []\ncardList.append(('body', helpWords))\nhelpCards.addCard(ResponseImage.RichContentCard(\nraw_content=cardList,\ntitleFontColor=PALETTE_CYAN,\n))\nsavePath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, '%d-faq-helper.png'%(group_id, ))\nhelpCards.generateImage(savePath)\nreturn savePath\n</code></pre>"},{"location":"plugin/plugins/getPermissionPlugin/","title":"\u7fa4\u200b\u6743\u9650\u200b\u83b7\u53d6","text":""},{"location":"plugin/plugins/getPermissionPlugin/#_1","title":"\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b GetPermission StandardPlugin '-sudo' ROOT_ADMIN_ID \u200b\u628a\u200b\u672c\u4eba\u200bid\u200b\u6dfb\u52a0\u200b\u5230\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u6743\u9650\u200b\u540d\u5355\u200b AddPermission StandardPlugin '-addadmin <code>@{\u200b\u67d0\u4eba\u200b}</code>' ROOT_ADMIN_ID \u200b\u628a\u200b<code>@{\u200b\u67d0\u4eba\u200b}</code>\u200b\u6dfb\u52a0\u200b\u5230\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u6743\u9650\u200b\u540d\u5355\u200b DelPermission StandardPlugin '-deladmin <code>@{\u200b\u67d0\u4eba\u200b}</code>' ROOT_ADMIN_ID \u200b\u628a\u200b<code>@{\u200b\u67d0\u4eba\u200b}</code>\u200b\u79fb\u51fa\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u6743\u9650\u200b\u540d\u5355\u200b ShowPermission StandardPlugin '-showadmin' / 'getAdmin' None \u200b\u67e5\u770b\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u5458\u200b\u6743\u9650\u200b\u540d\u5355\u200b AddGroupAdminToBotAdmin StandardPlugin '-autoconf' ROOT_ADMIN_ID \u200b\u628a\u200b\u7fa4\u4e3b\u200b\u548c\u200b\u7ba1\u7406\u5458\u200b\u6dfb\u52a0\u200b\u8fdb\u7fa4\u200bbot\u200b\u7ba1\u7406"},{"location":"plugin/plugins/getPermissionPlugin/#_2","title":"\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u4ee3\u7801\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>ROOT_ADMIN_ID = [111, # \u200b\u7528\u6237\u200bA  \n222, # \u200b\u7528\u6237\u200bB\n444] # \u200b\u7528\u6237\u200bD\n</code></pre> <p>\u200b\u7fa4\u804a\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>333&gt;&gt;&gt; -showadmin\nbot&gt;&gt;&gt; \u200b\u672c\u7fa4\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b [222, 444]\n# 111\u200b\u81ea\u8eab\u200b\u83b7\u53d6\u200b\u6743\u9650\u200b\n111&gt;&gt;&gt; -sudo\nbot&gt;&gt;&gt; OK\n777&gt;&gt;&gt; -getadmin\nbot&gt;&gt;&gt; \u200b\u672c\u7fa4\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b [222, 444, 111]\n111&gt;&gt;&gt; -sudo\nbot&gt;&gt;&gt; \u200b\u7528\u6237\u200b\u3010111\u3011\u200b\u5df2\u200b\u5728\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b\n\n# CQ\u200b\u7801\u200b\u6ce8\u5165\u200b\u65e0\u6548\u200b\n111&gt;&gt;&gt; -deladmin [CQ:at,qq=444]\n777&gt;&gt;&gt; -getadmin\nbot&gt;&gt;&gt; \u200b\u672c\u7fa4\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b [222, 444, 111]\n# 111\u200b\u5220\u9664\u200b444\u200b\u6743\u9650\u200b\n111&gt;&gt;&gt; -deladmin @\u200b\u7528\u6237\u200bD\nbot&gt;&gt;&gt; OK\n444&gt;&gt;&gt; -getadmin\nbot&gt;&gt;&gt; \u200b\u672c\u7fa4\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b [111, 222]\n# 444\u200b\u5220\u9664\u200b111\u200b\u6743\u9650\u200b\n444&gt;&gt;&gt; -deladmin @\u200b\u7528\u6237\u200bA\nbot&gt;&gt;&gt; OK\n111&gt;&gt;&gt; -showadmin\nbot&gt;&gt;&gt; \u200b\u672c\u7fa4\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b [222]\n</code></pre>"},{"location":"plugin/plugins/getPermissionPlugin/#_3","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b<code>plugins/getPermission.py</code></p> <pre><code>class GetPermission(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg == '-sudo' and data['user_id'] in ROOT_ADMIN_ID and data['message_type']=='group'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ngroupId = data['group_id']\nuserId = data['user_id']\nif userId not in getGroupAdmins(groupId):\naddGroupAdmin(groupId, userId)\nsend(groupId, \"[CQ:reply,id=%d]OK\"%data['message_id'])\nelse:\nsend(groupId, \"[CQ:reply,id=%d]\u200b\u7528\u6237\u200b\u3010%d\u3011\u200b\u5df2\u200b\u5728\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b\"%(data['message_id'],userId))\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'GetPermission',\n'description': '\u200b\u83b7\u53d6\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u6743\u9650\u200b\uff08\u200b\u4ec5\u9650\u200broot\u200b\u4f7f\u7528\u200b\uff09',\n'commandDescription': '-sudo',\n'usePlace': ['group'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass AddPermission(StandardPlugin):\ndef __init__(self) -&gt; None:\nself.cmdStyle = re.compile(r'^-addadmin ?\\[CQ:at,qq=(\\d+)\\]$')\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nuserId = data['user_id']\nreturn self.cmdStyle.match(msg) != None and userId in ROOT_ADMIN_ID and data['message_type']=='group'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ngroupId = data['group_id']\nuserId = data['user_id']\ntargetId = int(self.cmdStyle.findall(msg)[0])\nprint(getGroupAdmins(groupId))\nif targetId not in getGroupAdmins(groupId):\naddGroupAdmin(groupId, targetId)\nsend(groupId, \"[CQ:reply,id=%d]OK\"%data['message_id'])\nelse:\nsend(groupId, \"\u200b\u7528\u6237\u200b\u3010%d\u3011\u200b\u5df2\u200b\u5728\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b\"%targetId)\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'AddPermission',\n'description': '\u200b\u6dfb\u52a0\u200b\u7528\u6237\u7fa4\u200bbot\u200b\u7ba1\u7406\u6743\u9650\u200b\uff08\u200b\u4ec5\u9650\u200broot\u200b\u4f7f\u7528\u200b\uff09',\n'commandDescription': '-addadmin @{\u200b\u67d0\u7fa4\u200b\u6210\u5458\u200b}',\n'usePlace': ['group'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass DelPermission(StandardPlugin):\ndef __init__(self) -&gt; None:\nself.cmdStyle = re.compile(r'^-deladmin ?\\[CQ:at,qq=(\\d+)\\]$')\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nuserId = data['user_id']\nreturn self.cmdStyle.match(msg) != None and userId in ROOT_ADMIN_ID and data['message_type']=='group'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ngroupId = data['group_id']\ntargetId = int(self.cmdStyle.findall(msg)[0])\nif targetId in getGroupAdmins(groupId):\ndelGroupAdmin(groupId, targetId)\nsend(groupId, \"[CQ:reply,id=%d]OK\"%data['message_id'])\nelse:\nsend(groupId, \"\u200b\u7528\u6237\u200b\u3010%d\u3011\u200b\u4e0d\u200b\u5728\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b\"%targetId)\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'DelPermission',\n'description': '\u200b\u5220\u9664\u200b\u7528\u6237\u7fa4\u200bbot\u200b\u7ba1\u7406\u6743\u9650\u200b\uff08\u200b\u4ec5\u9650\u200broot\u200b\u4f7f\u7528\u200b\uff09',\n'commandDescription': '-deladmin @{\u200b\u67d0\u7fa4\u200b\u6210\u5458\u200b}',\n'usePlace': ['group'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass ShowPermission(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['-showadmin', '-getadmin'] and data['message_type']=='group'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ngroupId = data['group_id']\nadmins = getGroupAdmins(groupId)\nsend(groupId, '[CQ:reply,id={}]\u200b\u672c\u7fa4\u200b\u7ba1\u7406\u5458\u200b\u5217\u8868\u200b {}'.format(data['message_id'], admins))\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'ShowPermission',\n'description': '\u200b\u5c55\u793a\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u200b',\n'commandDescription': '-showadmin/-getadmin',\n'usePlace': ['group'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass AddGroupAdminToBotAdmin(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nuserId = data['user_id']\nreturn msg in ['-autoconf', '-autoconfig'] and userId in ROOT_ADMIN_ID and data['message_type']=='group'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ngroupId = data['group_id']\nadmins = set(u['user_id'] for u in get_group_member_list(groupId) if u['role'] in ['admin', 'owner']).union(\ngetGroupAdmins(groupId)\n)\nsetGroupAdmin(groupId, list(admins))\nsend(groupId, \"[CQ:reply,id=%d]OK\"%data['message_id'])\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'AddGroupAdminToBotAdmin',\n'description': '\u200b\u6dfb\u52a0\u200b\u7fa4\u4e3b\u200b\u548c\u200b\u7ba1\u7406\u200b\u4e3a\u200bbot\u200b\u7ba1\u7406\u200b\uff08\u200b\u4ec5\u9650\u200broot\u200b\u4f7f\u7528\u200b\uff09',\n'commandDescription': '-autoconf',\n'usePlace': ['group'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/gobangPlugin/","title":"\u4e94\u5b50\u68cb","text":""},{"location":"plugin/plugins/gobangPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b GoBangPlugin StandardPlugin '\u200b\u5f00\u59cb\u200b\u4e94\u5b50\u68cb\u200b' / '\u200b\u63a5\u53d7\u200b\u4e94\u5b50\u68cb\u200b' ... None \u200b\u4e94\u5b50\u68cb"},{"location":"plugin/plugins/gobangPlugin/#2","title":"2. \u200b\u63d2\u4ef6\u200b\u903b\u8f91\u200b\u4ecb\u7ecd","text":"<p>\u200b\u6e38\u620f\u200b\u72b6\u6001\u673a\u200b\uff1a</p>"},{"location":"plugin/plugins/gocqWatchDogPlugin/","title":"gocq\u200b\u79bb\u7ebf\u200b\u8b66\u544a","text":""},{"location":"plugin/plugins/gocqWatchDogPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b GocqWatchDog WatchDog <code>None</code> None go-cqhttp\u200b\u79bb\u7ebf\u200b\u62a5\u8b66"},{"location":"plugin/plugins/gocqWatchDogPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u5f53\u200bgo-cqhttp\u200b\u79bb\u7ebf\u200b\u65f6\u200b\uff0c<code>WARNING_ADMIN_ID</code>\u200b\u6536\u5230\u200b\u90ae\u4ef6\u200b\uff1a</p> <pre><code>Little-Unicorn-Bot warning\n    warning: QQ Bot offline\n</code></pre>"},{"location":"plugin/plugins/gocqWatchDogPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4e3b\u8981\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/gocqWatchDog.py</code></p> <pre><code># main.py\ndef eventClassify(json_data: dict)-&gt;NoticeType: \n\"\"\"\u200b\u4e8b\u4ef6\u200b\u5206\u7c7b\u200b\"\"\"\nif json_data['post_type'] == 'meta_event' and json_data['meta_event_type'] == 'heartbeat':\nreturn NoticeType.GocqHeartBeat\nif json_data['post_type'] == 'message' and json_data['message_type'] == 'group':\nif json_data['group_id'] in APPLY_GROUP_ID:\nreturn NoticeType.GroupMessage\nelse:\nreturn NoticeType.GroupMessageNoProcessRequired\nif json_data['post_type'] == 'message' and json_data['message_type'] == 'private':\nreturn NoticeType.PrivateMessage\nif json_data['post_type'] == 'notice' and json_data['notice_type'] == 'notify' and json_data['sub_type'] == \"poke\":\nif 'group_id' in json_data.keys() and json_data['group_id'] in APPLY_GROUP_ID:\nreturn NoticeType.GroupPoke\nif json_data['post_type'] == 'notice' and json_data['notice_type'] == 'group_recall':\nreturn NoticeType.GroupRecall\nif json_data['post_type'] == 'notice' and json_data['notice_type'] == 'group_upload':\nreturn NoticeType.GroupUpload\nif json_data['post_type'] == 'request' and json_data['request_type'] == 'friend':\nreturn NoticeType.AddPrivate\nreturn NoticeType.NoProcessRequired\n@app.route('/', methods=[\"POST\"])\ndef post_data():\n# \u200b\u83b7\u53d6\u200b\u4e8b\u4ef6\u200b\u4e0a\u62a5\u200b\ndata = request.get_json()\n# \u200b\u7b5b\u9009\u200b\u5e76\u200b\u5904\u7406\u200b\u6307\u5b9a\u200b\u4e8b\u4ef6\u200b\nflag=eventClassify(data)\n# \u200b\u7fa4\u200b\u6d88\u606f\u200b\u5904\u7406\u200b\nif flag==NoticeType.GroupMessage: \nmsg=data['message'].strip()\nfor event in GroupPluginList:\nevent: StandardPlugin\ntry:\nif event.judgeTrigger(msg, data):\nret = event.executeEvent(msg, data)\nif ret != None:\nreturn ret\nexcept TypeError as e:\nwarning(\"type error in main.py: {}\\n\\n{}\".format(e, event))\nelif flag == NoticeType.GroupMessageNoProcessRequired:\ngroupMessageRecorder.executeEvent(data['message'], data)\nelif flag == NoticeType.GroupRecall:\nfor plugin in [groupMessageRecorder]:\nplugin.recallMessage(data)\n# \u200b\u79c1\u804a\u200b\u6d88\u606f\u200b\u5904\u7406\u200b\nelif flag==NoticeType.PrivateMessage:\n# print(data)\nmsg=data['message'].strip()\nfor event in PrivatePluginList:\nif event.judgeTrigger(msg, data):\nif event.executeEvent(msg, data)!=None:\nbreak\nelif flag == NoticeType.GroupUpload:\nfor event in [GroupFileRecorder()]:\nevent.uploadFile(data)\n# \u200b\u7fa4\u5185\u200b\u62cd\u200b\u4e00\u200b\u62cd\u56de\u200b\u62cd\u200b\nelif flag==NoticeType.GroupPoke: \nfor p in GroupPokeList:\nif p.judgeTrigger(data):\nif p.pokeMessage(data)!=None:\nbreak\n# \u200b\u81ea\u52a8\u200b\u52a0\u200b\u597d\u53cb\u200b\nelif flag==NoticeType.AddPrivate:\nset_friend_add_request(data['flag'], True)\nelif flag==NoticeType.GocqHeartBeat:\ngocqWatchDog.feed()\nreturn \"OK\"\n# plugins/gocqWatchDog.py\nfrom utils.standardPlugin import WatchDog\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.header import Header\nfrom utils.basicConfigs import MAIL_USER, MAIL_PASS, WARNING_ADMIN_ID\nfrom typing import List, Tuple, Any, Optional, Dict\ndef sendEmailTo(msg: str, receivers:List[str])-&gt;bool:\n\"\"\"send msg to receivers\"\"\"\ntry:\nmessage = MIMEText(msg)\nmessage['From'] = Header('Little-Unicorn-Bot', 'utf-8')\nmessage['To'] = Header('bot root admins', 'utf-8')\nmessage['Subject'] = Header('Little-Unicorn-Bot warning')\nsmtpobj = smtplib.SMTP_SSL('smtp.qq.com',465)\nsmtpobj.login(MAIL_USER, MAIL_PASS)\nsmtpobj.sendmail(MAIL_USER, receivers, message.as_string())\nsmtpobj.quit()\nexcept BaseException as e:\nreturn False\nclass GocqWatchDog(WatchDog):\ndef __init__(self, intervalTime:float):\nsuper().__init__(intervalTime)\ndef onHungry(self):\nsendEmailTo('warning: QQ Bot offline', ['%d@qq.com'%u for u in WARNING_ADMIN_ID])\n</code></pre>"},{"location":"plugin/plugins/greetingsPlugin/","title":"\u65e9\u5b89\u200b\u665a\u5b89","text":""},{"location":"plugin/plugins/greetingsPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b MorningGreet StandardPlugin '\u200b\u65e9\u5b89\u200b' None \u200b\u83b7\u53d6\u200bbot\u200b\u7684\u200b\u65e9\u4e0a\u200b\u95ee\u597d\u200b NightGreet StandardPlugin '\u200b\u665a\u5b89\u200b' None \u200b\u83b7\u53d6\u200bbot\u200b\u7684\u200b\u665a\u4e0a\u200b\u95ee\u597d"},{"location":"plugin/plugins/greetingsPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u4ee3\u7801\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>ROOT_ADMIN_ID = [111, # \u200b\u7528\u6237\u200bA  \n222, # \u200b\u7528\u6237\u200bB\n444] # \u200b\u7528\u6237\u200bD\nGroupPluginList = [ # \u200b\u7fa4\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\n# .....\nPluginGroupManager([MorningGreet(), NightGreet()], 'greeting'), # \u200b\u65e9\u5b89\u200b\u665a\u5b89\u200b\n# .....\n]\nPrivatePluginList=[ # \u200b\u79c1\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\n# .....\nMorningGreet(), NightGreet(),\n# .....\n]\n</code></pre> <p>\u200b\u7fa4\u804a\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code># \u200b\u7fa4\u5185\u200b\u5c1a\u672a\u200b\u6253\u5f00\u200bgreeting\n333&gt; \u200b\u65e9\u5b89\u200b\n333&gt; \u200b\u665a\u5b89\u200b\n# \u200b\u65e0\u200b\u4e8b\u200b\u53d1\u751f\u200b\n# \u200b\u63a5\u4e0b\u6765\u200b\u7ba1\u7406\u5458\u200b\u6253\u5f00\u200bgreeting\n111&gt; -grpcfg enable greeting\nbot&gt; OK\n\n222&gt; \u200b\u65e9\u5b89\u200b\u7fa4\u53cb\u200b\nbot&gt; \u200b\u4e00\u4e07\u4e2a\u200b\u7f8e\u4e3d\u200b\u7684\u200b\u672a\u6765\u200b\uff0c\u200b\u62b5\u4e0d\u4e0a\u200b\u4e00\u4e2a\u200b\u6e29\u6696\u200b\u7684\u200b\u73b0\u5728\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\n666&gt; \u200b\u665a\u5b89\u200b\nbot&gt; \u200b\u6211\u200b\u7684\u200b\u5c0f\u200b\u8111\u888b\u200b\u5df2\u7ecf\u200b\u5fd9\u200b\u4e86\u200b\u4e00\u5929\u200b\u4e86\u200b\uff0c\u200b\u597d\u7d2f\u200b\u554a\u200b\uff0c\u200b\u4e5f\u200b\u8be5\u200b\u4f11\u606f\u200b\u4e86\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\n</code></pre>"},{"location":"plugin/plugins/greetingsPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>from abc import ABC, abstractmethod\nfrom typing import Union, Any\nimport random\nfrom utils.basicEvent import *\nfrom utils.standardPlugin import StandardPlugin\nGOODMORNING_LIST = [\n\"\u200b\u65f6\u95f4\u200b\u6700\u4f1a\u200b\u9a97\u4eba\u200b\uff0c\u200b\u4f46\u200b\u4e5f\u200b\u80fd\u200b\u8ba9\u200b\u4f60\u200b\u660e\u767d\u200b\uff0c\u200b\u8fd9\u4e2a\u200b\u4e16\u754c\u200b\u6ca1\u6709\u200b\u4ec0\u4e48\u200b\u4e0d\u80fd\u200b\u5931\u53bb\u200b\u7684\u200b\uff0c\u200b\u79bb\u53bb\u200b\u7684\u200b\u90fd\u200b\u662f\u200b\u98ce\u666f\u200b\uff0c\u200b\u7559\u4e0b\u200b\u7684\u200b\u624d\u200b\u662f\u200b\u4eba\u751f\u200b\uff0c\u200b\u8d70\u200b\u5230\u200b\u6700\u540e\u200b\u7684\u200b\uff0c\u200b\u5c31\u662f\u200b\u5bf9\u200b\u7684\u200b\u4eba\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u5584\u826f\u200b\u548c\u200b\u7231\u200b\u90fd\u200b\u662f\u200b\u514d\u8d39\u200b\u7684\u200b\uff0c\u200b\u4f46\u200b\u4e0d\u662f\u200b\u5ec9\u4ef7\u200b\u7684\u200b\uff0c\u200b\u4f60\u200b\u7684\u200b\u5584\u826f\u200b\uff0c\u200b\u9700\u8981\u200b\u5e26\u70b9\u200b\u950b\u8292\u200b\uff0c\u200b\u4f60\u200b\u7684\u200b\u7231\u200b\uff0c\u200b\u9700\u8981\u200b\u5e26\u4e9b\u200b\u7406\u667a\u200b\uff0c\u200b\u5e26\u200b\u773c\u8bc6\u200b\u4eba\u200b\uff0c\u200b\u6bd5\u7adf\u200b\u4e0d\u662f\u200b\u6240\u6709\u4eba\u200b\u90fd\u200b\u914d\u200b\u62e5\u6709\u200b\u5b83\u4eec\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u4eba\u751f\u200b\u6700\u597d\u200b\u7684\u200b\u72b6\u6001\u200b\uff0c\u200b\u662f\u200b\u6bcf\u5929\u200b\u9192\u6765\u200b\uff0c\u200b\u9762\u671d\u200b\u9633\u5149\u200b\uff0c\u200b\u5634\u89d2\u200b\u4e0a\u626c\u200b\u3002\u200b\u4e0d\u200b\u7fa1\u6155\u200b\u8c01\u200b\uff0c\u200b\u4e0d\u200b\u8ba8\u597d\u200b\u8c01\u200b\uff0c\u200b\u9ed8\u9ed8\u200b\u52aa\u529b\u200b\uff0c\u200b\u6d3b\u6210\u200b\u81ea\u5df1\u200b\u60f3\u8981\u200b\u7684\u200b\u6a21\u6837\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u5343\u4e07\u200b\u4e0d\u8981\u200b\u5bf9\u200b\u4efb\u4f55\u200b\u4e8b\u200b\u611f\u5230\u200b\u540e\u6094\u200b\uff0c\u200b\u56e0\u4e3a\u200b\u5b83\u200b\u66fe\u7ecf\u200b\u4e00\u5ea6\u200b\u5c31\u662f\u200b\u4f60\u200b\u60f3\u8981\u200b\u7684\u200b\u3002\u200b\u540e\u6094\u200b\u6ca1\u7528\u200b\uff0c\u200b\u8981\u4e48\u200b\u5fd8\u8bb0\u200b\uff0c\u200b\u8981\u4e48\u200b\u52aa\u529b\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u6709\u65f6\u5019\u200b\uff0c\u200b\u52aa\u529b\u200b\u4e00\u70b9\u200b\uff0c\u200b\u662f\u200b\u4e3a\u200b\u8ba9\u200b\u81ea\u5df1\u200b\u6709\u200b\u8d44\u683c\u200b\uff0c\u200b\u4e0d\u53bb\u200b\u505a\u200b\u4e0d\u200b\u559c\u6b22\u200b\u7684\u200b\u4e8b\u200b\uff1b\u200b\u662f\u200b\u4e3a\u4e86\u200b\u80fd\u200b\u8ba9\u200b\u81ea\u5df1\u200b\uff0c\u200b\u9047\u89c1\u200b\u4e00\u4e2a\u200b\u559c\u6b22\u200b\u7684\u200b\u4eba\u65f6\u200b\uff0c\u200b\u4e0d\u4f1a\u200b\u56e0\u4e3a\u200b\u81ea\u5df1\u200b\u4e0d\u591f\u200b\u597d\u200b\u800c\u200b\u6ca1\u80fd\u200b\u7559\u4f4f\u200b\u5bf9\u65b9\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u8be5\u6765\u200b\u7684\u200b\u90fd\u200b\u4f1a\u200b\u6765\u200b\uff0c\u200b\u8be5\u200b\u8d70\u200b\u7684\u200b\u5168\u4f1a\u200b\u8d70\u200b\uff0c\u200b\u522b\u200b\u6297\u62d2\u200b\uff0c\u200b\u522b\u200b\u633d\u7559\u200b\uff0c\u200b\u522b\u200b\u8d2a\u604b\u200b\u3002\u200b\u5b66\u7740\u200b\u770b\u6de1\u200b\u4e00\u4e9b\u200b\u4e8b\u60c5\u200b\u3002\u200b\u4eb2\u7231\u200b\u7684\u200b\uff0c\u200b\u613f\u200b\u4f60\u200b\u50cf\u200b\u5411\u65e5\u8475\u200b\u4e00\u6837\u200b\uff0c\u200b\u6bcf\u5929\u200b\u90fd\u200b\u5145\u6ee1\u200b\u6b63\u200b\u80fd\u91cf\u200b\uff0c\u200b\u5f00\u59cb\u200b\u5143\u6c14\u200b\u6ee1\u6ee1\u7684\u200b\u4e00\u5929\u200b\u3002\",\n\"\u200b\u4e16\u754c\u200b\u4e0a\u200b\u6839\u672c\u200b\u5c31\u200b\u4e0d\u200b\u5b58\u5728\u200b\u5b8c\u7f8e\u200b\u7684\u200b\u4e8b\u7269\u200b\uff0c\u200b\u6211\u4eec\u200b\u6ca1\u200b\u5fc5\u8981\u200b\u6d6a\u8d39\u200b\u5927\u91cf\u200b\u7684\u200b\u7cbe\u529b\u200b\u53bb\u200b\u5bfb\u627e\u200b\u4e0d\u200b\u5b58\u5728\u200b\u7684\u200b\u4e1c\u897f\u200b\u3002\u200b\u4e0e\u5176\u200b\u7528\u200b\u4e00\u751f\u200b\u7684\u200b\u65f6\u95f4\u200b\u53bb\u200b\u6267\u7740\u200b\u5730\u200b\u8ffd\u6c42\u200b\u865a\u65e0\u7f25\u7f08\u200b\u7684\u200b\u4e1c\u897f\u200b\uff0c\u200b\u4e0d\u5982\u200b\u73cd\u60dc\u200b\u548c\u200b\u628a\u63e1\u200b\u73b0\u5728\u200b\u7f8e\u597d\u200b\u7684\u200b\u751f\u6d3b\u200b\u3002\",\n\"\u200b\u6bcf\u4e2a\u200b\u4eba\u200b\u7684\u200b\u4eba\u751f\u200b\u91cc\u200b\u90fd\u200b\u4f1a\u200b\u9047\u5230\u200b\u4e00\u573a\u200b\u63aa\u624b\u4e0d\u53ca\u200b\u7684\u200b\u5927\u96e8\u200b\uff0c\u200b\u82e5\u200b\u4f60\u200b\u8eab\u9677\u200b\u96e8\u4e2d\u200b\uff0c\u200b\u613f\u200b\u6709\u4eba\u200b\u4e3a\u200b\u4f60\u200b\u6491\u4f1e\u200b\uff1b\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\uff0c\u200b\u4e5f\u200b\u613f\u200b\u4f60\u200b\u6709\u200b\u542c\u200b\u96e8\u200b\u7684\u200b\u5fc3\u60c5\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u7f8e\u597d\u200b\u7684\u200b\u4e8b\u60c5\u200b\u603b\u4f1a\u200b\u5230\u6765\u200b\uff0c\u200b\u4f60\u200b\u8981\u200b\u7b80\u5355\u200b\u5e72\u51c0\u200b\u806a\u660e\u200b\u5355\u7eaf\u200b\uff0c\u200b\u5c31\u200b\u4f1a\u200b\u53d1\u73b0\u200b\u5947\u8ff9\u200b\u4e0d\u662f\u200b\u964d\u4e34\u200b\uff0c\u200b\u5b83\u200b\u662f\u200b\u56e0\u200b\u4f60\u200b\u800c\u200b\u6765\u200b\u3002\",\n\"\u200b\u4eba\u200b\u8fd9\u8f88\u5b50\u200b\uff0c\u200b\u6709\u4eba\u200b\u7fa1\u6155\u200b\u4f60\u200b\uff0c\u200b\u6709\u4eba\u200b\u8ba8\u538c\u200b\u4f60\u200b\uff0c\u200b\u6709\u4eba\u200b\u5ac9\u5992\u200b\u4f60\u200b\uff0c\u200b\u6709\u4eba\u200b\u770b\u4e0d\u8d77\u200b\u4f60\u200b\uff0c\u200b\u6ca1\u5173\u7cfb\u200b\uff0c\u200b\u4ed6\u4eec\u200b\u90fd\u200b\u662f\u200b\u5916\u4eba\u200b\uff1b\u200b\u751f\u6d3b\u200b\u5c31\u662f\u200b\u8fd9\u6837\u200b\uff0c\u200b\u4f60\u200b\u6240\u200b\u505a\u200b\u7684\u200b\u4e00\u5207\u200b\u4e0d\u80fd\u200b\u8ba9\u200b\u6bcf\u4e2a\u200b\u4eba\u200b\u90fd\u200b\u6ee1\u610f\u200b\u3002\u200b\u4e0d\u8981\u200b\u4e3a\u4e86\u200b\u8ba8\u597d\u200b\u522b\u4eba\u200b\uff0c\u200b\u800c\u200b\u4e1f\u5931\u200b\u81ea\u5df1\u200b\u7684\u200b\u672c\u6027\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u4e00\u4e2a\u200b\u4eba\u200b\u81f3\u5c11\u200b\u5e94\u8be5\u200b\u62e5\u6709\u200b\u4e00\u4e2a\u200b\u68a6\u60f3\u200b\uff0c\u200b\u6709\u200b\u4e00\u4e2a\u200b\u7406\u7531\u200b\u53bb\u200b\u575a\u5f3a\u200b\uff0c\u200b\u5fc3\u82e5\u200b\u6ca1\u6709\u200b\u6816\u606f\u200b\u7684\u200b\u5730\u65b9\u200b\uff0c\u200b\u5728\u200b\u54ea\u91cc\u200b\u90fd\u200b\u662f\u200b\u6d41\u6d6a\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u4e00\u4e07\u4e2a\u200b\u7f8e\u4e3d\u200b\u7684\u200b\u672a\u6765\u200b\uff0c\u200b\u62b5\u4e0d\u4e0a\u200b\u4e00\u4e2a\u200b\u6e29\u6696\u200b\u7684\u200b\u73b0\u5728\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u613f\u200b\u4f60\u200b\u6210\u4e3a\u200b\u81ea\u5df1\u200b\u559c\u6b22\u200b\u7684\u200b\u6837\u5b50\u200b\uff0c\u200b\u4e0d\u200b\u62b1\u6028\u200b\uff0c\u200b\u4e0d\u200b\u5c06\u200b\u5c31\u200b\uff0c\u200b\u6709\u200b\u91ce\u5fc3\u200b\uff0c\u200b\u6709\u200b\u5149\u8292\u200b\uff01\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u65e0\u8bba\u200b\u751f\u6d3b\u200b\u600e\u6837\u200b\uff0c\u200b\u90fd\u200b\u4e0d\u8981\u200b\u5fd8\u8bb0\u200b\u5fae\u7b11\u200b\uff0c\u200b\u613f\u200b\u4f60\u200b\u6210\u4e3a\u200b\u81ea\u5df1\u200b\u7684\u200b\u592a\u9633\u200b\uff0c\u200b\u65e0\u9700\u200b\u51ed\u501f\u200b\u8c01\u200b\u7684\u200b\u5149\u200b~\",\n\"\u200b\u4e0d\u7ba1\u200b\u6628\u5929\u200b\u6709\u200b\u591a\u200b\u7cdf\u7cd5\u200b\uff0c\u200b\u4e0d\u8981\u200b\u8ba9\u200b\u5b83\u200b\u5f71\u54cd\u200b\u4f60\u200b\u7684\u200b\u73b0\u5728\u200b\u548c\u200b\u672a\u6765\u200b\uff0c\u200b\u6d3b\u5f97\u200b\u50cf\u200b\u5411\u65e5\u8475\u200b\u4e00\u6837\u200b\u707f\u70c2\u200b\u3002\u200b\u65e9\u4e0a\u597d\u200b\uff01\",\n\"\u200b\u5929\u662f\u200b\u51b7\u200b\u7684\u200b\uff0c\u200b\u5fc3\u662f\u200b\u6696\u200b\u7684\u200b\uff0c\u200b\u5bf9\u200b\u4f60\u200b\u7684\u200b\u795d\u798f\u200b\u662f\u200b\u6c38\u8fdc\u200b\u7684\u200b\uff01\u200b\u4eba\u200b\u662f\u200b\u8fdc\u200b\u7684\u200b\uff0c\u200b\u5fc3\u662f\u200b\u8fd1\u200b\u7684\u200b\uff0c\u200b\u5bf9\u200b\u4f60\u200b\u7684\u200b\u601d\u5ff5\u200b\u662f\u200b\u4e0d\u53d8\u200b\u7684\u200b\uff01\u200b\u613f\u200b\u4f60\u200b\u6bcf\u200b\u4e00\u5929\u200b\u90fd\u200b\u9633\u5149\u707f\u70c2\u200b\u3001\u200b\u7b11\u53e3\u5e38\u5f00\u200b\uff0c\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u62b1\u200b\u6700\u5927\u200b\u5e0c\u671b\u200b\uff0c\u200b\u5c3d\u200b\u6700\u5927\u200b\u52aa\u529b\u200b\uff0c\u200b\u505a\u200b\u6700\u574f\u200b\u6253\u7b97\u200b\uff0c\u200b\u6301\u200b\u6700\u597d\u200b\u5fc3\u6001\u200b\u3002\u200b\u8bb0\u4f4f\u200b\u8be5\u200b\u8bb0\u4f4f\u200b\u7684\u200b\uff0c\u200b\u5fd8\u8bb0\u200b\u8be5\u200b\u5fd8\u8bb0\u200b\u7684\u200b\uff0c\u200b\u6539\u53d8\u200b\u80fd\u200b\u6539\u53d8\u200b\u7684\u200b\uff0c\u200b\u63a5\u53d7\u200b\u6210\u200b\u4e8b\u5b9e\u200b\u7684\u200b\u3002\u200b\u592a\u9633\u200b\u603b\u662f\u200b\u65b0\u200b\u7684\u200b\uff0c\u200b\u6bcf\u5929\u200b\u90fd\u200b\u662f\u200b\u7f8e\u597d\u200b\u7684\u200b\u65e5\u5b50\u200b\u3002\u200b\u65e9\u5b89\u200b\uff01\",\n\"\u200b\u6bcf\u5929\u200b\u6e05\u6668\u200b\u7684\u200b\u7b2c\u4e00\u9053\u200b\u66d9\u5149\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u795e\u5947\u200b\u5730\u200b\u6cbb\u6108\u200b\u6628\u65e5\u200b\u7684\u200b\u4f24\u75db\u200b\u3002\",\n\"\u200b\u5e26\u200b\u7740\u200b\u9633\u5149\u200b\u51fa\u53d1\u200b\uff0c\u200b\u53bb\u200b\u9047\u89c1\u200b\u6e29\u6696\u200b\uff1b\u200b\u5e26\u200b\u7740\u200b\u5fae\u7b11\u200b\u524d\u884c\u200b\uff0c\u200b\u53bb\u200b\u9047\u89c1\u200b\u5e78\u798f\u200b\uff0c\u200b\u6240\u6709\u200b\u7f8e\u597d\u200b\u7684\u200b\u4e0d\u671f\u800c\u9047\u200b\uff0c\u200b\u90fd\u200b\u5728\u200b\u8def\u4e0a\u200b\u3002\u200b\u65b0\u200b\u7684\u200b\u4e00\u5929\u200b\uff0c\u200b\u65e9\u5b89\u200b\uff01\",\n]\nGOODNIGHT_LIST = [\n\"\u200b\u4eca\u591c\u200b\u6211\u8981\u200b\u53bb\u200b\u5f81\u200b\u62ef\u6551\u200b\u5730\u7403\u200b\uff0c\u200b\u6709\u4e8b\u200b\u8bf7\u200b\u7559\u8a00\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u9ed1\u591c\u200b\u4e0d\u4f1a\u200b\u4e8f\u5f85\u200b\u665a\u7761\u200b\u7684\u200b\u4eba\u200b\uff0c\u200b\u5b83\u4f1a\u200b\u8ba9\u200b\u4f60\u200b\u8131\u53d1\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u6211\u200b\u7684\u200b\u5c0f\u200b\u8111\u888b\u200b\u5df2\u7ecf\u200b\u5fd9\u200b\u4e86\u200b\u4e00\u5929\u200b\u4e86\u200b\uff0c\u200b\u597d\u7d2f\u200b\u554a\u200b\uff0c\u200b\u4e5f\u200b\u8be5\u200b\u4f11\u606f\u200b\u4e86\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u628a\u200b\u6240\u6709\u200b\u7684\u200b\u70e6\u607c\u200b\u90fd\u200b\u629b\u6389\u200b\uff0c\u200b\u62c9\u4e0a\u200b\u7a97\u5e18\u200b\uff0c\u200b\u6302\u200b\u4e0a\u200b\u6708\u4eae\u200b\uff0c\u200b\u597d\u597d\u200b\u7761\u4e00\u89c9\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u4f60\u200b\u60f3\u200b\u4e00\u591c\u200b\u66b4\u5bcc\u200b\u5417\u200b\uff1f\u200b\u90a3\u200b\u5c31\u200b\u8ddf\u200b\u6211\u200b\u4e00\u8d77\u200b\u5173\u706f\u200b\u7761\u89c9\u200b\u5427\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\u200b\u4f60\u200b\u60f3\u200b\u4e00\u591c\u200b\u66b4\u5bcc\u200b\u5417\u200b\uff1f\u200b\u90a3\u200b\u5c31\u200b\u8ddf\u200b\u6211\u200b\u4e00\u8d77\u200b\u5173\u706f\u200b\u7761\u89c9\u200b\u5427\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u6211\u200b\u5df2\u7ecf\u200b\u76d6\u200b\u597d\u200b\u4e86\u200b\u88ab\u5b50\u200b\uff0c\u200b\u95ed\u597d\u200b\u4e00\u53ea\u200b\u773c\u200b\uff0c\u200b\u5c31\u200b\u7b49\u200b\u4f60\u200b\u8bf4\u200b\u665a\u5b89\u200b\u4e86\u200b\uff0c\u200b\u8bf4\u5b8c\u200b\u6211\u200b\u5c31\u200b\u95ed\u200b\u53e6\u4e00\u53ea\u200b\u4e86\u200b\u3002\",\n\"\u200b\u8981\u200b\u5f00\u5fc3\u200b\uff0c\u200b\u8981\u200b\u52aa\u529b\u200b\uff0c\u200b\u8981\u200b\u50cf\u200b\u661f\u661f\u200b\u4e00\u6837\u200b\u53d1\u5149\u200b\u53d1\u4eae\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u628a\u200b\u661f\u661f\u200b\u71ac\u6210\u200b\u7cd6\u6d46\u200b\uff0c\u200b\u8638\u200b\u4e00\u200b\u8638\u200b\u4f60\u200b\u8bf4\u200b\u8fc7\u200b\u7684\u200b\u665a\u5b89\u200b\uff0c\u200b\u7136\u540e\u200b\u5927\u53e3\u200b\u5927\u53e3\u200b\u7684\u200b\u5403\u6389\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u6211\u8981\u200b\u4e54\u88c5\u6210\u200b\u4e00\u9897\u200b\u5c0f\u200b\u5976\u7cd6\u200b\uff0c\u200b\u591c\u6df1\u200b\u4e86\u200b\u63d0\u7740\u200b\u661f\u661f\u200b\u706f\u200b\u5feb\u5feb\u200b\u6e9c\u200b\u5230\u200b\u4f60\u200b\u7684\u200b\u68a6\u91cc\u200b\uff0c\u200b\u563b\u563b\u200b\uff0c\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u4f60\u200b\u77e5\u9053\u200b\u4e3a\u4ec0\u4e48\u200b\u6211\u200b\u5728\u200b\u591c\u91cc\u200b\u603b\u662f\u200b\u4e0d\u200b\u7761\u89c9\u200b\u5417\u200b\uff1f\u200b\u56e0\u4e3a\u200b\u9ed1\u591c\u200b\u9700\u8981\u200b\u6211\u200b\u8fd9\u9897\u200b\u95ea\u4eae\u200b\u7684\u200b\u661f\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u65e9\u70b9\u200b\u7761\u200b\u5427\u200b\uff0c\u200b\u4eca\u665a\u200b\u6211\u4f1a\u200b\u8dd1\u200b\u5230\u200b\u4f60\u200b\u7684\u200b\u68a6\u91cc\u200b\u624b\u821e\u8db3\u8e48\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u8981\u200b\u4e0d\u8981\u200b\u4e00\u8d77\u200b\u53bb\u200b\u68a6\u200b\u4e2d\u200b\u770b\u200b\u6708\u4eae\u200b\uff0c\u200b\u4e00\u5b9a\u200b\u8d85\u7ea7\u200b\u5927\u200b\uff0c\u200b\u8d85\u7ea7\u200b\u7f8e\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u6708\u4eae\u200b\u4e0d\u200b\u7761\u89c9\u200b\uff0c\u200b\u6211\u200b\u4e5f\u200b\u4e0d\u200b\u7761\u89c9\u200b\uff0c\u200b\u6211\u200b\u662f\u200b\u8fd9\u4e2a\u200b\u4e16\u754c\u200b\u4e0a\u200b\u7684\u200b\u4e00\u4e2a\u200b\u5c0f\u200b\u7f8e\u5473\u200b\u3002\",\n\"\u200b\u75b2\u60eb\u200b\u7684\u200b\u751f\u6d3b\u200b\u9700\u8981\u200b\u4e00\u4e2a\u200b\u6e29\u67d4\u200b\u7684\u200b\u68a6\u200b\u548c\u200b\u4e00\u4e2a\u200b\u5f88\u200b\u7231\u200b\u7684\u200b\u4eba\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u8fd9\u4e2a\u200b\u4e16\u754c\u200b\u592a\u200b\u5371\u9669\u200b\uff0c\u200b\u65f6\u95f4\u200b\u5c31\u200b\u8be5\u200b\u6d6a\u8d39\u200b\u5728\u200b\u7f8e\u597d\u200b\u7684\u200b\u4e8b\u7269\u200b\u4e0a\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u4e16\u4e8b\u200b\u5343\u5e06\u200b\u8fc7\u200b\uff0c\u200b\u524d\u65b9\u200b\u7ec8\u4f1a\u200b\u662f\u200b\u6e29\u67d4\u200b\u548c\u200b\u6708\u5149\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u5f53\u200b\u4f60\u200b\u5728\u200b\u591c\u665a\u200b\u5b64\u519b\u594b\u6218\u200b\u65f6\u200b\uff0c\u200b\u6f2b\u5929\u200b\u661f\u5149\u200b\u56e0\u4e3a\u200b\u4f60\u200b\u800c\u200b\u95ea\u70c1\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u4f60\u200b\u5c31\u662f\u200b\u5929\u8d50\u200b\u7684\u200b\u793c\u7269\u200b\uff0c\u200b\u6211\u200b\u8fdf\u6765\u200b\u7684\u200b\u6551\u8d4e\u200b\uff1b\u200b\u4f60\u200b\u662f\u200b\u4e0d\u706d\u200b\u7684\u200b\u661f\u5149\u200b\uff0c\u200b\u65e5\u590d\u4e00\u65e5\u200b\u7684\u200b\u7f8e\u68a6\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\".\u200b\u6211\u200b\u5728\u200b\u4eba\u95f4\u200b\u8d29\u5356\u200b\u9ec4\u660f\u200b\uff0c\u200b\u53ea\u200b\u4e3a\u200b\u6536\u96c6\u200b\u4e16\u95f4\u200b\u6e29\u67d4\u200b\u53bb\u200b\u89c1\u200b\u4f60\u200b\uff0c\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u4eca\u5929\u200b\u7684\u200b\u4e16\u754c\u200b\u5df2\u7ecf\u200b\u6253\u70ca\u200b\u4e86\u200b\uff0c\u200b\u5df2\u7ecf\u200b\u4e0d\u200b\u5bf9\u5916\u200b\u8425\u4e1a\u200b\u4e86\u200b\uff0c\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u613f\u200b\u4f60\u200b\u4ece\u6b64\u200b\u4e0d\u200b\u5bf9\u200b\u65b0\u4e8b\u200b\u754f\u60e7\u200b\uff0c\u200b\u4e0d\u4f1a\u200b\u91cd\u8e48\u8986\u8f99\u200b\uff0c\u200b\u518d\u4e5f\u200b\u4e0d\u200b\u4e3a\u200b\u611f\u60c5\u200b\u6c89\u6ca6\u200b\uff0c\u200b\u4e0d\u200b\u4e3a\u200b\u71ac\u591c\u200b\u540e\u6094\u200b\uff0c\u200b\u76f8\u4fe1\u200b\u6709\u4eba\u200b\u4f1a\u200b\u966a\u200b\u4f60\u200b\u98a0\u6c9b\u6d41\u79bb\u200b\uff0c\u200b\u5982\u679c\u200b\u6ca1\u6709\u200b\uff0c\u200b\u613f\u200b\u4f60\u200b\u6210\u4e3a\u200b\u81ea\u5df1\u200b\u7684\u200b\u592a\u9633\u200b\u3002\u200b\u665a\u5b89\u200b\uff0c\u200b\u597d\u200b\u68a6\u200b\uff01\",\n\"\u200b\u9519\u8fc7\u200b\u843d\u65e5\u4f59\u6656\u200b\uff0c\u200b\u8fd8\u4f1a\u200b\u6709\u200b\u6ee1\u5929\u200b\u661f\u8fb0\u200b\uff0c\u200b\u53ea\u8981\u200b\u4e0d\u200b\u653e\u5f03\u200b\uff0c\u200b\u6700\u5dee\u200b\u5c31\u662f\u200b\u5927\u5668\u665a\u6210\u200b\u3002\u200b\u613f\u200b\u4f60\u200b\u5168\u529b\u4ee5\u8d74\u200b\uff0c\u200b\u4e14\u200b\u6ee1\u8f7d\u800c\u5f52\u200b\uff01\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u6700\u597d\u200b\u7684\u200b\u5e74\u9f84\u200b\u662f\u200b\uff0c\u200b\u90a3\u200b\u4e00\u5929\u200b\uff0c\u200b\u4f60\u200b\u7ec8\u4e8e\u200b\u77e5\u9053\u200b\u5e76\u4e14\u200b\u575a\u4fe1\u200b\u81ea\u5df1\u200b\u6709\u200b\u591a\u200b\u597d\u200b\uff0c\u200b\u4e0d\u662f\u200b\u865a\u5f20\u200b\uff0c\u200b\u4e0d\u662f\u200b\u5938\u6d6e\u200b\uff0c\u200b\u4e0d\u662f\u200b\u4f17\u4eba\u200b\u6367\u200b\uff0c\u200b\u662f\u200b\u5185\u5fc3\u200b\u660e\u200b\u660e\u6f88\u6f88\u200b\u77e5\u9053\u200b\uff1a\u200b\u662f\u200b\u7684\u200b\uff0c\u200b\u6211\u200b\u5c31\u662f\u200b\u8fd9\u4e48\u200b\u597d\u200b\u3002\u200b\u665a\u5b89\u200b~\",\n\"\u200b\u591c\u6df1\u4eba\u9759\u200b\u4e86\u200b\u5c31\u200b\u628a\u200b\u5fc3\u638f\u200b\u51fa\u6765\u200b\u81ea\u5df1\u200b\u7f1d\u7f1d\u8865\u8865\u200b\uff0c\u200b\u5b8c\u4e8b\u200b\u4e86\u200b\u518d\u200b\u585e\u200b\u56de\u53bb\u200b\uff0c\u200b\u7761\u4e00\u89c9\u200b\u9192\u6765\u200b\u53c8\u200b\u662f\u200b\u4fe1\u5fc3\u767e\u500d\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u6240\u6709\u200b\u7684\u200b\u6545\u4e8b\u200b\uff0c\u200b\u90fd\u200b\u6709\u200b\u4e00\u4e2a\u200b\u7ed3\u5c40\u200b\u3002\u200b\u4f46\u200b\u5e78\u8fd0\u200b\u7684\u200b\u662f\u200b\uff0c\u200b\u5728\u751f\u6d3b\u4e2d\u200b\uff0c\u200b\u6bcf\u4e2a\u200b\u7ed3\u5c40\u200b\u90fd\u200b\u4f1a\u200b\u53d8\u6210\u200b\u4e00\u4e2a\u200b\u65b0\u200b\u7684\u200b\u5f00\u59cb\u200b\u3002\u200b\u665a\u5b89\u200b!\",\n\"\u200b\u96be\u8fc7\u200b\u7684\u200b\u65f6\u5019\u200b\uff0c\u200b\u5c31\u200b\u628a\u200b\u81ea\u5df1\u200b\u5f53\u6210\u200b\u53e6\u200b\u4e00\u4e2a\u200b\u4eba\u200b\uff0c\u200b\u5f53\u521d\u200b\u600e\u4e48\u200b\u5b89\u6170\u200b\u522b\u4eba\u200b\uff0c\u200b\u73b0\u5728\u200b\u5c31\u200b\u600e\u4e48\u200b\u5b89\u6170\u200b\u81ea\u5df1\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u665a\u662f\u200b\u4e16\u754c\u200b\u7684\u200b\u665a\u200b\uff0c\u200b\u5b89\u662f\u200b\u6709\u200b\u4f60\u200b\u7684\u200b\u5b89\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u5e0c\u671b\u200b\u751f\u6d3b\u200b\u6709\u200b\u60ca\u559c\u200b\uff0c\u200b\u5e0c\u671b\u200b\u559c\u6b22\u200b\u88ab\u200b\u56de\u5e94\u200b\uff0c\u200b\u613f\u200b\u4f60\u597d\u200b\u68a6\u200b\uff0c\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u539f\u6765\u200b\u4ee5\u4e3a\u200b\uff0c\u200b\u62e5\u6709\u200b\u7684\u200b\u4e1c\u897f\u200b\u8d8a\u200b\u591a\u200b\uff0c\u200b\u624d\u200b\u4f1a\u200b\u8d8a\u200b\u5e78\u798f\u200b\uff0c\u200b\u540e\u6765\u200b\u624d\u200b\u53d1\u73b0\u200b\uff0c\u200b\u751f\u6d3b\u200b\u8d8a\u200b\u7b80\u5355\u200b\uff0c\u200b\u624d\u200b\u4f1a\u200b\u66f4\u200b\u8f7b\u677e\u200b\u3002\u200b\u665a\u5b89\u200b\u597d\u200b\u68a6\u200b\u3002\",\n\"\u200b\u661f\u661f\u200b\u4f1a\u200b\u4e0d\u4f1a\u200b\u8d81\u7740\u200b\u4eba\u95f4\u200b\u7684\u200b\u70df\u706b\u200b\u5760\u843d\u200b\u65f6\u200b\uff0c\u200b\u5077\u5077\u200b\u6e9c\u4e0b\u6765\u200b\u89c1\u200b\u60f3\u89c1\u200b\u7684\u200b\u4eba\u200b\u3002\u200b\u665a\u5b89\u200b\uff01\",\n\"\u200b\u4eca\u591c\u200b\u592a\u665a\u200b\u4e86\u200b\uff0c\u200b\u660e\u5929\u200b\u7ee7\u7eed\u200b\u60f3\u200b\u4f60\u200b\uff0c\u200b\u7b49\u200b\u661f\u661f\u200b\u90fd\u200b\u7761\u7740\u200b\u4e86\u200b\uff0c\u200b\u518d\u8bf4\u200b\u60f3\u200b\u4f60\u200b\u3002\",\n\"\"\"\u200b\u6211\u200b\u5bf9\u200b\u4e16\u754c\u200b\u8bf4\u200b\u665a\u5b89\u200b\uff0c\u200b\u552f\u72ec\u200b\u5bf9\u200b\u4f60\u200b\u8bf4\u200b\u559c\u6b22\u200b\uff01\u200b\u7231\u200b\u4f60\u200b\uff08\u3065\uffe33\uffe3\uff09\u3065\u256d\u2764\uff5e\"\"\",\n\"\u200b\u597d\u200b\u60f3\u200b\u62b1\u62b1\u200b\u4f60\u200b\u5440\u200b~\u200b\u53ea\u662f\u200b\u56e0\u4e3a\u200b\u5fc3\u75bc\u200b\u4f60\u200b\uff0c\u200b\u89c9\u5f97\u200b\u4f60\u200b\u8be5\u200b\u4f11\u606f\u200b\u4e86\u200b\uff0c\u200b\u7136\u540e\u200b\u5728\u200b\u4f60\u200b\u63aa\u200b\u4e0d\u53ca\u200b\u9632\u200b\u7684\u200b\u65f6\u5019\u200b\u62e5\u200b\u4f60\u200b\u5165\u6000\u200b\uff0c\u200b\u63c9\u200b\u63c9\u200b\u4f60\u200b\u7684\u200b\u5934\u53d1\u200b\u544a\u8bc9\u200b\u4f60\u200b\uff1a\u200b\u5df2\u7ecf\u200b\u591f\u200b\u4e86\u200b\uff0c\u200b\u4f60\u200b\u5f88\u200b\u52aa\u529b\u200b\u4e86\u200b\u53ef\u4ee5\u200b\u597d\u597d\u200b\u4f11\u606f\u200b\u4e86\u200b\",\n\"\u200b\u665a\u5b89\u200b\uff0c\u200b\u6362\u4e2a\u200b\u4e16\u754c\u200b\u60f3\u200b\u4f60\u200b\uff0c\u200b\u4e00\u4f1a\u513f\u200b\u89c1\u200b\u3002\",\n\"\u200b\u4eca\u5929\u200b\u6708\u4eae\u200b\u4e0d\u200b\u8425\u4e1a\u200b\uff0c\u200b\u6240\u4ee5\u200b\u7531\u200b\u6211\u200b\u6765\u8bf4\u200b\u665a\u5b89\u200b\u3002\",\n\"\u200b\u8d81\u7740\u200b\u661f\u661f\u200b\u548c\u200b\u6708\u4eae\u200b\u90fd\u200b\u5728\u200b\uff0c\u200b\u6084\u6084\u200b\u8bf4\u58f0\u200b\uff0c\u200b\u4f60\u200b\u771f\u200b\u53ef\u7231\u200b\uff0c\u200b\u665a\u5b89\u200b\u3002\",\n\"\u200b\u60f3\u200b\u5bf9\u200b\u5168\u4e16\u754c\u200b\u8bf4\u200b\u665a\u5b89\u200b\uff0c\u200b\u6070\u597d\u200b\u4f60\u200b\u5c31\u662f\u200b\u5168\u4e16\u754c\u200b\u3002\",\n\"\u200b\u60f3\u8981\u200b\u52ab\u6301\u200b\u4e00\u9897\u200b\u661f\u661f\u200b\uff0c\u200b\u5728\u200b\u6708\u8272\u200b\u6726\u80e7\u200b\u7684\u200b\u591c\u665a\u200b\u964d\u843d\u200b\u5230\u200b\u4f60\u200b\u7684\u200b\u68a6\u91cc\u200b\",\n\"\u200b\u665a\u5b89\u200b\u5514\u200b\u897f\u200b\u8fea\u897f\u200b\uff0c\u200b\u665a\u5b89\u200b\u739b\u200b\u5361\u5df4\u200b\u5361\u200b\uff0c\u200b\u665a\u5b89\u200b\u4f9d\u53e4\u200b\u6bd4\u53e4\u200b\uff0c\u200b\u665a\u5b89\u200b\u6c64\u59c6\u200b\u5e03\u5229\u200b\u6ce2\u200b\uff0c\u200b\u665a\u5b89\u200b\u5c0f\u200b\u70b9\u70b9\u200b\uff0c\u200b\u665a\u5b89\u200b\u53ee\u53ee\u200b\u8f66\u200b\uff0c\u200b\u665a\u5b89\u200b\u54c8\u200b\u547c\u547c\u200b\u665a\u5b89\u200b\u98de\u200b\u98de\u9c7c\u200b\uff0c\u200b\u665a\u5b89\u200b\u6211\u200b\u7684\u200b\u670b\u53cb\u200b\u4eec\u200b\u3002\",\n\"\u200b\u7761\u89c9\u200b\u5427\u200b\uff0c\u200b\u4f60\u200b\u7684\u200b\u5934\u53d1\u200b\u4e0d\u200b\u5141\u8bb8\u200b\u4f60\u200b\u778e\u200b\u60f3\u200bw\",\n\"\u200b\u4eca\u665a\u200b\u6765\u200b\u6211\u200b\u7684\u200b\u68a6\u91cc\u200b\u5417\u200b\uff1f\u200b\u8c08\u604b\u7231\u200b\u7684\u200b\u90a3\u79cd\u200b\u3002\",\n\"\u200b\u4f60\u200b\u77e5\u9053\u200b\u5417\u200b\uff1f\u200b\u6211\u200b\u6709\u200b\u4e00\u4e2a\u200b\u5fc3\u613f\u200b\uff0c\u200b\u90a3\u200b\u5c31\u662f\u200b\u4ee5\u540e\u200b\u80fd\u591f\u200b\u4ece\u200b\u4f60\u200b\u7684\u200b\u623f\u95f4\u200b\u8ddf\u200b\u4f60\u200b\u4e00\u8d77\u200b\u770b\u200b\u661f\u661f\u200b\u3002\",\n\"\u200b\u60f3\u200b\u505a\u200b\u4f60\u200b\u5e8a\u8fb9\u200b\u7684\u200b\u5c0f\u718a\u200b\uff0c\u200b\u4e3a\u200b\u4f60\u200b\u6253\u8d25\u200b\u68a6\u91cc\u200b\u7684\u200b\u6076\u9f99\u200b\u3002\",\n\"\u200b\u4eca\u5929\u200b\u8fd9\u200b\u768e\u6d01\u200b\u7684\u200b\u6708\u5149\u200b\u548c\u200b\u6ee1\u5929\u200b\u7684\u200b\u661f\u8fb0\u200b\u90fd\u200b\u5f52\u200b\u4f60\u200b\uff0c\u200b\u800c\u200b\u6211\u200b\u4e5f\u200b\u5f52\u200b\u4f60\u200b\u3002\",\n\"\u200b\u665a\u5b89\u200b\uff0c\u200b\u6211\u200b\u5e26\u200b\u7740\u200b\u6211\u200b\u7684\u200b\u53ef\u7231\u200b\u4e00\u8d77\u200b\u6253\u70ca\u200b\u4e86\u200b\uff0c\u200b\u5e2e\u200b\u6211\u5173\u200b\u4e00\u4e0b\u200b\u6708\u4eae\u200b\",\n]\nclass MorningGreet(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg.startswith('\u200b\u65e9\u5b89\u200b')\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, random.choice(GOODMORNING_LIST), data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'MorningGreet',\n'description': '\u200b\u65e9\u5b89\u200b',\n'commandDescription': '\u200b\u65e9\u5b89\u200b',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass NightGreet(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg.startswith('\u200b\u665a\u5b89\u200b')\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, random.choice(GOODNIGHT_LIST), data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'NightGreet',\n'description': '\u200b\u665a\u5b89\u200b',\n'commandDescription': '\u200b\u665a\u5b89\u200b',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/groupManagerPlugin/","title":"\u63d2\u4ef6\u200b\u7ec4\u200b\u7ba1\u7406","text":""},{"location":"plugin/plugins/groupManagerPlugin/#_1","title":"\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b PluginGroupManager StandardPlugin ... ... ..."},{"location":"plugin/plugins/groupManagerPlugin/#_2","title":"\u5177\u4f53\u200b\u4ecb\u7ecd","text":"<p>PluginGroupManager\u200b\u5177\u6709\u200b\u4e24\u4e2a\u200b\u529f\u80fd\u200b\uff1a</p> <ol> <li>\u200b\u4f5c\u4e3a\u200b\u63d2\u4ef6\u200b\u7ba1\u7406\u8005\u200b\uff0c\u200b\u63a5\u6536\u200b <code>re.compile('-grpcfg (enable|disable) %s'%groupName)</code> \u200b\u578b\u200b\u53c2\u6570\u200b\uff0c\u200b\u4f5c\u4e3a\u200b\u5f00\u542f\u200b\u6216\u200b\u5173\u95ed\u200b\u63d2\u4ef6\u200b\u7ec4\u200b\u7684\u200b\u6307\u4ee4\u200b\uff0c\u200b\u6b64\u200b\u529f\u80fd\u200b\u9700\u8981\u200b\u7fa4\u200bbot\u200b\u7ba1\u7406\u6743\u9650\u200b</li> <li>\u200b\u4f5c\u4e3a\u200b\u4e2d\u95f4\u200b\u5e73\u53f0\u200b\uff0c\u200b\u63a5\u6536\u200b\u8f93\u5165\u200b\u4f20\u7ed9\u200b\u88ab\u200b\u7ba1\u7406\u200b\u5bf9\u8c61\u200b\uff0c\u200b\u68c0\u6d4b\u200b\u88ab\u200b\u7ba1\u7406\u200b\u5bf9\u8c61\u200b\u662f\u5426\u200b\u80fd\u200b\u63a5\u6536\u200b\u53c2\u6570\u200b\u5e76\u200b\u8fd0\u884c\u200b</li> </ol> <p>\u200b\u60a8\u200b\u53ef\u4ee5\u200b\u628a\u200b\u6570\u4e2a\u200b\u63d2\u4ef6\u200b\u7c7b\u200b\u5bf9\u8c61\u200b\u653e\u8fdb\u200b\u5217\u8868\u200b\uff0c\u200b\u7136\u540e\u200b\u4f20\u7ed9\u200bPluginGroupManager\u200b\u4f5c\u4e3a\u200b\u6784\u9020\u51fd\u6570\u200b\u7684\u200b\u7b2c\u4e00\u4e2a\u200b\u53c2\u6570\u200b\uff0cgroupName\u200b\u4f5c\u4e3a\u200b\u7b2c\u4e8c\u4e2a\u200b\u53c2\u6570\u200b\u4f20\u7ed9\u200b\u6784\u9020\u51fd\u6570\u200b\uff0c\u200b\u5982\u200b\u4e0b\u9762\u200b\u793a\u8303\u200b\u6837\u4f8b\u200b</p>"},{"location":"plugin/plugins/groupManagerPlugin/#_3","title":"\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u4ee3\u7801\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>ROOT_ADMIN_ID = [111, # \u200b\u7528\u6237\u200bA  \n222, # \u200b\u7528\u6237\u200bB\n444] # \u200b\u7528\u6237\u200bD\nfrom plugins.superEmoji import FireworksFace, FirecrackersFace, BasketballFace, HotFace\nGroupPluginList = [\n# .....\nPluginGroupManager([FireworksFace(), FirecrackersFace(), BasketballFace(), HotFace()], 'superemoji'),\n# .....\n]\n</code></pre> <p>\u200b\u7fa4\u804a\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code># \u200b\u7fa4\u5185\u200b\u5c1a\u672a\u200b\u5f00\u542f\u200bsuper emoji\u200b\u529f\u80fd\u200b\n111&gt; \u200b\u70ed\u6b7b\u200b\u4e86\u200b\n# bot\u200b\u4e0d\u4e88\u200b\u7406\u4f1a\u200b\n# 111\u200b\u5f00\u542f\u200b\u7fa4\u200bsuper emoji\u200b\u529f\u80fd\u200b\n111&gt; -sudo\nbot&gt; OK\n111&gt; -grpcfg enable superemoji\nbot&gt; OK\n\n# \u200b\u5f00\u59cb\u200b\u4e92\u52a8\u200b\n222&gt; \u200b\u7bee\u7403\u200b\nbot&gt; \u3010\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u7bee\u7403\u200b\u3011\n\n# 111\u200b\u5173\u95ed\u200b\u7fa4\u200bsuper emoji\u200b\u529f\u80fd\u200b\n111&gt; -grpcfg disable superemoji\nbot&gt; OK\n\n# 444\u200b\u5c1d\u8bd5\u200b\u4e92\u52a8\u200b\n444&gt; \u200b\u7bee\u7403\u200b\n# bot\u200b\u4e0d\u4e88\u200b\u7406\u4f1a\u200b\n</code></pre>"},{"location":"plugin/plugins/groupManagerPlugin/#_4","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b<code>utils/standardPlugin.py</code></p> <pre><code>from utils.basicEvent import send, warning, readGlobalConfig, writeGlobalConfig, getGroupAdmins\nclass PluginGroupManager(StandardPlugin):\ndef __init__(self, plugins:List[StandardPlugin], groupName: str) -&gt; None:\nself.plugins = plugins\nself.groupName = groupName\nself.readyPlugin = None\nself.enabledDict = readGlobalConfig(None, groupName+'.enable')\nself.defaultEnabled = False\ndef judgeTrigger(self, msg:str, data:Any)-&gt;bool:\nuserId = data['user_id']\ngroupId = data['group_id']\nif msg == '-grpcfg enable %s'%self.groupName and userId in getGroupAdmins(groupId):\nself.readyPlugin = 'enable'\nreturn True\nif msg == '-grpcfg disable %s'%self.groupName and userId in getGroupAdmins(groupId):\nself.readyPlugin = 'disable'\nreturn True\nif not self.queryEnabled(groupId):\nreturn False\nfor plugin in self.plugins:\nif plugin.judgeTrigger(msg, data):\nself.readyPlugin = plugin\nreturn True\nreturn False\ndef executeEvent(self, msg:str, data:Any)-&gt;Union[None, str]:\nif self.readyPlugin == None:\nwarning(\"logic error in PluginGroupManager: executeEvent self.readyPlugin == None\")\nreturn None\nif self.readyPlugin in ['enable', 'disable']:\nenabled = self.readyPlugin == 'enable'\nself.readyPlugin = None\ngroupId = data[\"group_id\"]\nif self.queryEnabled(groupId) != enabled:\nwriteGlobalConfig(groupId, self.groupName + '.enable', enabled)\nself.enabledDict[groupId] = enabled\nsend(data['group_id'], \"OK\")\nreturn \"OK\"\nelse:\ntry:\nresult = self.readyPlugin.executeEvent(msg, data)\nself.readyPlugin = None\nreturn result\nexcept Exception as e:\nwarning(\"logic error in PluginGroupManager: {}\".format(e))\nreturn None\ndef queryEnabled(self, groupId: int)-&gt;bool:\nif groupId not in self.enabledDict.keys():\nwriteGlobalConfig(groupId, self.groupName, {'name':self.groupName, 'enable': self.defaultEnabled})\nself.enabledDict[groupId] = self.defaultEnabled\nreturn self.enabledDict[groupId]\n</code></pre>"},{"location":"plugin/plugins/helpPlugin/","title":"\u5e2e\u52a9\u200b\u63d2\u4ef6","text":""},{"location":"plugin/plugins/helpPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b ShowHelp StandardPlugin '-help [...]' None \u200b\u5c55\u793a\u200b bot \u200b\u4f7f\u7528\u200b\u65b9\u6cd5\u200b\u5e2e\u52a9\u200b ShowStatus StandardPlugin '-test' None \u200b\u5c55\u793a\u200b\u6d4b\u8bd5\u200b\u4fe1\u606f"},{"location":"plugin/plugins/helpPlugin/#2","title":"2. \u200b\u5177\u4f53\u200b\u4f7f\u7528\u200b\u8bf4\u660e","text":"<p>\u200b\u63d2\u4ef6\u200b\u5217\u8868\u200b\u7531\u200b <code>PluginGroupManager</code> \u200b\u548c\u200b <code>StandardPlugin</code> \u200b\u5d4c\u5957\u200b\u800c\u6210\u200b\uff0chelp\u200b\u6a21\u5757\u200b\u4e0d\u4ec5\u200b\u652f\u6301\u200b\u5e38\u89c4\u200b\u67e5\u8be2\u200b\uff0c\u200b\u8fd8\u200b\u652f\u6301\u200b\u5d4c\u5957\u200b\u67e5\u8be2\u200b\u3002</p> <p>help\u200b\u683c\u5f0f\u200b\u5982\u4e0b\u200b\uff1a</p> <ol> <li>\u200b\u663e\u793a\u200b\u6240\u6709\u200b\u63d2\u4ef6\u200b\u5e2e\u52a9\u200b\uff1a-help</li> <li>\u200b\u663e\u793a\u200b\u67d0\u4e2a\u200b\u5d4c\u5957\u200b\u8def\u5f84\u200b\uff1a-help \u200b\u540d\u79f0\u200b1 \u200b\u540d\u79f0\u200b2 ...</li> </ol> <p>\u200b\u5e38\u89c4\u200b\u67e5\u8be2\u200b\u683c\u5f0f\u200b\u5982\u200b <code>1.</code> \u200b\u6240\u793a\u200b\uff0c\u200b\u663e\u793a\u200b\u7684\u200b\u662f\u200b\u6240\u6709\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5e2e\u52a9\u200b\u4fe1\u606f\u200b\u3002</p> <p>\u200b\u5d4c\u5957\u200b\u67e5\u8be2\u200b\u683c\u5f0f\u200b\u5982\u200b <code>2.</code> \u200b\u6240\u793a\u200b\uff0c\u200b\u663e\u793a\u200b\u7684\u200b\u662f\u200b\u8fd9\u4e2a\u200b\u5d4c\u5957\u200b\u8def\u5f84\u200b\u4e0b\u200b\u63d2\u4ef6\u200b\u7684\u200b\u5e2e\u52a9\u200b\u4fe1\u606f\u200b\u3002</p>"},{"location":"plugin/plugins/helpPlugin/#3","title":"3. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u4ee3\u7801\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>helper = ShowHelp() # \u200b\u5e2e\u52a9\u200b\u63d2\u4ef6\u200b\nGroupPluginList:List[StandardPlugin]=[ # \u200b\u6307\u5b9a\u200b\u7fa4\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\ngroupMessageRecorder,\nhelper,\n# ...\n]\nPrivatePluginList:List[StandardPlugin]=[ # \u200b\u79c1\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\nhelper,\n# ...\n]\nhelper.updatePluginList(GroupPluginList, PrivatePluginList)\n</code></pre> <p>\u200b\u804a\u5929\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>\u200b\u79c1\u804a\u200b\uff1a\n111&gt; -help\nbot&gt; \u3010\u200b\u5e2e\u52a9\u200b\u56fe\u7247\u200b0\u3011\n\n\u200b\u7fa4\u804a\u200b\uff1a\n111&gt; -help\nbot&gt; \u3010\u200b\u5e2e\u52a9\u200b\u56fe\u7247\u200b1\u3011\n111&gt; -grpcfg disable sjmc\nbot&gt; [\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b]OK\n222&gt; -help\nbot&gt; \u3010\u200b\u5e2e\u52a9\u200b\u56fe\u7247\u200b2\u3011\n222&gt; -help sjmc\nbot&gt; \u3010\u200b\u5e2e\u52a9\u200b\u56fe\u7247\u200b3\u3011\n</code></pre> <p>\u200b\u5e2e\u52a9\u200b\u56fe\u7247\u200b1\uff1a </p>"},{"location":"plugin/plugins/helpPlugin/#4","title":"4. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>class ShowHelp(StandardPlugin): \ndef __init__(self) -&gt; None:\nself.pattern = re.compile(r'^\\-help\\s*(.*)$')\nself.subdevidePattern = re.compile(r'^([^\\s]+)\\s+([^\\s].*)$')\nself.pluginList = []\nself.pluginListPrivate = []\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn self.pattern.match(msg) != None\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\ngroup_id = data['group_id'] if data['message_type']=='group' else 0\nhelpWords = self.pattern.findall(msg)[0]\ndef getTargetPluginList(pluginList:List[StandardPlugin], helpWords:str)-&gt;List[StandardPlugin]:\nif helpWords == '':\nreturn pluginList\nif self.subdevidePattern.match(helpWords) != None:\ncurrentPlugin, nextHelpWords = self.subdevidePattern.findall(helpWords)[0]\nfor p in pluginList:\nif not isinstance(p, PluginGroupManager): continue\np: PluginGroupManager\nif p.groupName == currentPlugin:\nreturn getTargetPluginList(p.plugins, nextHelpWords)\nreturn []\nelse:\nfor p in pluginList:\nif not isinstance(p, PluginGroupManager): continue\np: PluginGroupManager\nif p.groupName == helpWords:\nreturn p.plugins\nreturn []\ntargetPluginList = self.pluginList if data['message_type']=='group' else self.pluginListPrivate\ntargetPluginList = getTargetPluginList(targetPluginList, helpWords)\nif len(targetPluginList) == 0:\nsend(target, '[CQ:reply,id=%d]\u200b\u6682\u672a\u200b\u521b\u5efa\u200b\u5bf9\u5e94\u200b\u540d\u79f0\u200b\u7684\u200b\u6a21\u5757\u200b'%data['message_id'], data['message_type'])\nelse:\nimgPath = drawHelpCard(targetPluginList, group_id)\nimgPath = imgPath if os.path.isabs(imgPath) else os.path.join(ROOT_PATH, imgPath)\nsend(target, '[CQ:image,file=files://%s]'%imgPath, data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'ShowHelp',\n'description': '\u200b\u5e2e\u52a9\u200b',\n'commandDescription': '-help [...]?'\n'\\n\u200b\u5f00\u542f\u200b\u63d2\u4ef6\u200b\u7ec4\u200b:  -grpcfg enable &lt;group name&gt;'\n'\\n\u200b\u5173\u95ed\u200b\u63d2\u4ef6\u200b\u7ec4\u200b:  -grpcfg disable &lt;group name&gt;',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.4',\n'author': 'Unicorn',\n}\ndef updatePluginList(self, plugins, private_plugins):\nfor plugin in plugins:\nif issubclass(type(plugin), StandardPlugin):\nself.pluginList.append(plugin)\nelse:\nwarning(\"unexpected plugin {} type in ShowHelp plugin\".format(plugin))\nfor plugin in private_plugins:\nif issubclass(type(plugin), StandardPlugin):\nself.pluginListPrivate.append(plugin)\nelse:\nwarning(\"unexpected plugin {} type in ShowHelp plugin\".format(plugin))\ndef drawHelpCard(pluginList, group_id):\nhelpCards = ResponseImage(\ntitle = '\u200b\u7fa4\u804a\u200b\u529f\u80fd\u200b\u914d\u7f6e\u200b' if group_id!=0 else '\u200b\u79c1\u804a\u200b\u529f\u80fd\u200b\u914d\u7f6e\u200b', \nfooter = (f'\u200b\u5f53\u524d\u200b\u7fa4\u53f7\u200b:{group_id}' if group_id!=0 else ''),\ntitleColor = PALETTE_CYAN,\nlayout = 'two-column',\nwidth = 1280,\ncardBodyFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 24),\ncardSubtitleFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 24),\n)\nfor item in pluginList:\ncardPluginList = []\nflag = False\nif isinstance(item, PluginGroupManager):\nitem: PluginGroupManager\nflag = item.queryEnabled(group_id)\ncardPluginList.append(('title', item.groupName))\ncardPluginList.append(('separator', ))\nfor plugin in item.getPlugins():\ninfoDict:dict = plugin.getPluginInfo()\nif 'showInHelp' in infoDict.keys() and not infoDict['showInHelp']:\ncontinue\ntry:\nif isinstance(plugin, PluginGroupManager):\nplugin: PluginGroupManager\ncardPluginList.append((\n'body' if plugin.queryEnabled(group_id) else 'subtitle',\n\"[GROUP] \"+ plugin.groupName + '\\n' +\ninfoDict['description']\n))\nelse:\ncardPluginList.append(('body',(infoDict['description']+':  '+infoDict['commandDescription'])))\nexcept KeyError:\nwarning('meet KeyError when getting help, plugin: {}'.format(plugin))\nelse:\nitem: StandardPlugin\nflag = True\ninfoDict = item.getPluginInfo()\nif 'showInHelp' in infoDict.keys() and not infoDict['showInHelp']:\ncontinue\ntry:\ncardPluginList.append(('body',(infoDict['description']+':  '+infoDict['commandDescription'])))\nexcept KeyError:\nwarning('meet KeyError when getting help, plugin: {}'.format(item))\nif len(cardPluginList)&gt;0:\nclr = PALETTE_GREY if not flag else PALETTE_CYAN\nclr2 = PALETTE_GREY if not flag else PALETTE_BLACK\nhelpCards.addCard(ResponseImage.RichContentCard(raw_content=cardPluginList, titleFontColor=clr ,bodyFontColor=clr2,subtitleFontColor=PALETTE_GREY))\nsave_path = (os.path.join(SAVE_TMP_PATH, f'{group_id}_help.png'))\nhelpCards.generateImage(save_path)\nreturn save_path\nclass ShowStatus(StandardPlugin): \ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['-test status', '-test']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, 'status: online\\n'+VERSION_TXT,data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'ShowStatus',\n'description': '\u200b\u5c55\u793a\u200b\u72b6\u6001\u200b',\n'commandDescription': '-test/-test status',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/hotSearchPlugin/","title":"\u70ed\u200b\u641c","text":""},{"location":"plugin/plugins/hotSearchPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b WeiboHotSearch StandardPlugin '\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b' / '\u200b\u70ed\u200b\u641c\u200b' / 'wbrs' / '-wbrs' None \u200b\u83b7\u53d6\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b BaiduHotSearch StandardPlugin '\u200b\u767e\u5ea6\u200b\u70ed\u200b\u641c\u200b' / 'bdrs' / '-bdrs' None \u200b\u83b7\u53d6\u200b\u767e\u5ea6\u200b\u70ed\u200b\u641c\u200b ZhihuHotSearch StandardPlugin '\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b' / 'zhrs' / '-zhrs' None \u200b\u83b7\u53d6\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c"},{"location":"plugin/plugins/hotSearchPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; -wbrs\nbot&gt; \u3010\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b\u56fe\u7247\u200b\u3011\n222&gt; -bdrs\nbot&gt; \u3010\u200b\u767e\u5ea6\u200b\u70ed\u200b\u641c\u200b\u56fe\u7247\u200b\u3011\n333&gt; -zhrs\nbot&gt; \u3010\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b\u56fe\u7247\u200b\u3011\n</code></pre> <p>\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b\u56fe\u7247\u200b\uff1a </p> <p>\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b\u56fe\u7247\u200b\uff1a </p>"},{"location":"plugin/plugins/hotSearchPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/hotSearchPlugin.py</code></p> <pre><code>def plotHotSearch(meta:List[Dict[str, Any]], width:int, imgPath:str)-&gt;None:\n\"\"\"\n    @meta: List[\n        {\n            \"text\": str,\n            \"color\": Union[None, Colors],\n            \"font\": Union[None, Fonts],\n        }\n    ]\n    @imgPath: path to save image\n    \"\"\"\ngenerator = HotSearchImage(meta, width, Colors.PALETTE_BLACK, Fonts.FONT_SYHT_M24, Colors.PALETTE_WHITE)\nimg = generator.draw()\nimg.save(imgPath)\ndef getWeiboHotSearch()-&gt;Optional[List[Dict[str, Any]]]:\n\"\"\"\n    return object like:\n    List[{\n        \"topic_flag\": 1,\n        \"is_new\": 1,\n        \"star_word\": 0,\n        \"star_name\": [\n            \"\u200b\u9e1f\u9e1f\u200b\",\n            \"\u200b\u674e\u8bde\u200b\"\n        ],\n        \"mid\": \"4865756758544195\",\n        \"word_scheme\": \"#\u200b\u9e1f\u9e1f\u200b\u56e0\u4e3a\u200b\u674e\u8bde\u4eba\u8bbe\u200b\u5d29\u584c\u200b#\",\n        \"onboard_time\": 1675584748,\n        \"subject_querys\": \"\u200b\u7efc\u827a\u200b|\u200b\u5f00\u5de5\u200b\u4e86\u200b\u65b0\u200b\u751f\u6d3b\u200b\",\n        \"expand\": 0,\n        \"realpos\": 9,\n        \"num\": 360671,\n        \"word\": \"\u200b\u9e1f\u9e1f\u200b\u56e0\u4e3a\u200b\u674e\u8bde\u4eba\u8bbe\u200b\u5d29\u584c\u200b\",\n        \"ad_info\": \"\",\n        \"raw_hot\": 360671,\n        \"emoticon\": \"\",\n        \"category\": \"\u200b\u7efc\u827a\u200b\",\n        \"flag\": 1,\n        \"label_name\": \"\u200b\u65b0\u200b\",\n        \"icon_desc\": \"\u200b\u65b0\u200b\",\n        \"small_icon_desc\": \"\u200b\u65b0\u200b\",\n        \"icon_desc_color\": \"#ff3852\",\n        \"note\": \"\u200b\u9e1f\u9e1f\u200b\u56e0\u4e3a\u200b\u674e\u8bde\u4eba\u8bbe\u200b\u5d29\u584c\u200b\",\n        \"subject_label\": \"\u200b\u7efc\u827a\u200b\",\n        \"small_icon_desc_color\": \"#ff3852\",\n        \"fun_word\": 1,\n        \"flag_desc\": \"\u200b\u7efc\u827a\u200b\",\n        \"channel_type\": \"Entertainment\",\n        \"rank\": 8\n    }]\n    \"\"\"\ntry:\nreq = requests.get('https://weibo.com/ajax/side/hotSearch')\nif req.status_code != requests.codes.ok:\nreturn None\nwb = req.json()\nif wb['ok'] != 1:\nwarning('weibo hot search api error')\nreturn None\nreturn wb['data']['realtime']\nexcept KeyError as e:\nwarning('weibo api key error: {}'.format(e))\nexcept requests.JSONDecodeError as e:\nwarning('weibo api json decode error: {}'.format(e))\nreturn None\nclass WeiboHotSearch(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b','\u200b\u70ed\u200b\u641c\u200b','wbrs','-wbrs']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nwbhs = getWeiboHotSearch()\nif wbhs == None:\nsend(target, \"[CQ:reply,id={}]\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b\u83b7\u53d6\u200b\u5931\u8d25\u200b\".format(data['message_id']), data['message_type'])\nelse:\n# hsWord = '\\n'.join(['\u3010%d\u3011%s'%(hs['rank'], hs['word']) for hs in wbhs])\n# send(target, hsWord, data['message_type'])\nmeta = [{'text':hs['word']} for hs in wbhs]\nimgPath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'wbrs_%s_%d.png'%(data['message_type'], target))\nimg = plotHotSearch(meta, 550, imgPath)\nsend(target, f'[CQ:image,file=files://{imgPath}]', data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'WeiboHotSearch',\n'description': '\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b',\n'commandDescription': '\u200b\u70ed\u200b\u641c\u200b/\u200b\u5fae\u535a\u70ed\u200b\u641c\u200b/wbrs/-wbrs',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\ndef getBaiduHotSearch()-&gt;Optional[List[Dict[str, Any]]]:\ntry:\nreq = requests.get('https://api.1314.cool/getbaiduhot/')\nif req.status_code != requests.codes.ok:\nreturn None\nbd = req.json()\nreturn bd['data']\nexcept KeyError as e:\nwarning('baidu api key error: {}'.format(e))\nexcept requests.JSONDecodeError as e:\nwarning('baidu api json decode error: {}'.format(e))\nreturn None\nclass BaiduHotSearch(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u767e\u5ea6\u200b\u70ed\u200b\u641c\u200b', 'bdrs', '-bdrs']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nbdhs = getBaiduHotSearch()\nif bdhs == None:\nsend(target, \"[CQ:reply,id={}]\u200b\u767e\u5ea6\u200b\u70ed\u200b\u641c\u200b\u83b7\u53d6\u200b\u5931\u8d25\u200b\".format(data['message_id']), data['message_type'])\nelse:\n# hsWord = '\\n'.join(['\u3010%d\u3011%s'%(rank+1, hs['word']) for rank, hs in enumerate(bdhs)])\n# send(target, hsWord, data['message_type'])\nmeta = [{'text':hs['word']} for hs in bdhs]\nimgPath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'bdrs_%s_%d.png'%(data['message_type'], target))\nimg = plotHotSearch(meta, 550, imgPath)\nsend(target, f'[CQ:image,file=files://{imgPath}]', data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'BaiduHotSearch',\n'description': '\u200b\u767e\u5ea6\u200b\u70ed\u200b\u641c\u200b',\n'commandDescription': '\u200b\u767e\u5ea6\u200b\u70ed\u200b\u641c\u200b/bdrs/-bdrs',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\ndef getZhihuHotSearch()-&gt;Optional[List[Dict[str, Any]]]:\ntry:\nreq = requests.get('https://api.zhihu.com/topstory/hot-list')\nif req.status_code != requests.codes.ok:\nreturn None\nzh = req.json()\nreturn zh['data']\nexcept KeyError as e:\nwarning('zhihu api key error: {}'.format(e))\nexcept requests.JSONDecodeError as e:\nwarning('zhihu api json decode error: {}'.format(e))\nreturn None\nclass ZhihuHotSearch(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b', 'zhrs', '-zhrs']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nzhrs = getZhihuHotSearch()\nif zhrs == None:\nsend(target, \"[CQ:reply,id={}]\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b\u83b7\u53d6\u200b\u5931\u8d25\u200b\".format(data['message_id']), data['message_type'])\nelse:\na = ResponseImage(\ntitle='\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b', \ntitleColor=Colors.PALETTE_SJTU_RED, \nprimaryColor=Colors.PALETTE_SJTU_RED, \nfooter='update at %s'%datetime.strftime(datetime.now(), \"%Y-%m-%d %H:%M\"),\nlayout='normal'\n)\nfor rank, hs in enumerate(zhrs[:10]):\ntry:\nicon:str = hs['children'][0]['thumbnail']\nif not isinstance(icon, str) or not icon.startswith('http'):\nicon = None\nexcept:\nicon = None\na.addCard({\n'style': 'normal',\n'title': hs['target']['title'],\n'keyword': str(datetime.fromtimestamp(hs['target']['created'])),\n'body': hs['target']['excerpt'],\n'icon': icon,\n})\nimgPath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'zhrs_%s_%d.png'%(data['message_type'], target))\na.generateImage(imgPath)\nsend(target, f'[CQ:image,file=files://{imgPath}]', data['message_type'])\n# hsWord = '\\n'.join(['\u3010%d\u3011%s'%(rank, hs['target']['excerpt']) for rank, hs in enumerate(zhrs[:5])])\n# send(target, hsWord, data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'ZhihuHotSearch',\n'description': '\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b',\n'commandDescription': '\u200b\u77e5\u4e4e\u200b\u70ed\u200b\u641c\u200b/zhrs/-zhrs',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/izfPlugin/","title":"\u6211\u200b\u7231\u200b\u7535\u8def\u200b\u5b9e\u9a8c","text":""},{"location":"plugin/plugins/izfPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b izf StandardPlugin '-izf' / '-ttzf' None \u200b\u968f\u673a\u200b\u83b7\u53d6\u200b\u9009\u8bfe\u200b\u793e\u533a\u200b\u5bf9\u4e8e\u200b\u300a\u200b\u7535\u8def\u200b\u5b9e\u9a8c\u200b\u300b\u200b\u7684\u200b\u4e00\u6761\u200b\u8bc4\u4ef7"},{"location":"plugin/plugins/izfPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; -ttzf\nbot&gt; \u3010\u200b\u8bc4\u4ef7\u200b\u56fe\u7247\u200b\u3011\n</code></pre> <p>\u200b\u8bc4\u4ef7\u200b\u56fe\u7247\u200b\u793a\u4f8b\u200b1\uff1a</p> <p> </p> <p>\u200b\u8bc4\u4ef7\u200b\u56fe\u7247\u200b\u793a\u4f8b\u200b2\uff1a</p> <p> </p>"},{"location":"plugin/plugins/izfPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>from typing import Union, Any\nfrom utils.basicEvent import *\nfrom utils.basicConfigs import *\nfrom utils.responseImage import FONT_SYHT_M32\nfrom utils.standardPlugin import StandardPlugin\nfrom PIL import Image, ImageDraw, ImageFont\nimport os.path\nfrom utils.responseImage import *\nimport json\nimport random\ndef drawCommentEE0502(t):\nizf = ResponseImage(title='\u200b\u6211\u200b\u7231\u200b\u7535\u8def\u200b\u5b9e\u9a8c\u200b', \nprimaryColor=PALETTE_CYAN, \nlayout='normal',\nfooter='\u200b\u6570\u636e\u200b\u6765\u6e90\u200b\uff1aSJTU\u200b\u9009\u8bfe\u200b\u793e\u533a\u200b',\nautoSize=True,\ncardBodyFont=FONT_SYHT_M24,\nwidth=880)\nizf.addCard(\nResponseImage.NormalCard(\ntitle = '# '+str(t['id']),\nkeyword = '\u200b\u8bc4\u5206\u200b: '+str(t['rating'])+('     \u200b\u6210\u7ee9\u200b: '+str(t['score']) if t['score']!=None else ''),\nsubtitle = t['modified'],\nbody=t['comment']\n)\n)\nsavePath=os.path.join(SAVE_TMP_PATH, \"izf.png\")\nizf.generateImage(savePath)\nreturn savePath\nclass ShowEE0502Comments(StandardPlugin):\ndef __init__(self) -&gt; None:\nwith open('resources/corpus/izf.json','r',encoding='utf-8') as f:\nzf_data = json.load(f)['results']\nself.resource = zf_data\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['ttzf', 'izf', '-ttzf', '-izf']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nt = random.choice(self.resource)\npicPath = drawCommentEE0502(t)\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\nsend(target, f'[CQ:image,file=files://{picPath}]', data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'izf',\n'description': '\u200b\u6211\u200b\u7231\u200b\u7535\u8def\u200b\u5b9e\u9a8c\u200b',\n'commandDescription': 'ttzf / izf',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.2',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/jilePlugin/","title":"\u5bc4\u200b\u4e86\u200b\u68c0\u6d4b","text":""},{"location":"plugin/plugins/jilePlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"<p>\u200b\u8fd9\u4e2a\u200b\u63d2\u4ef6\u200b\u662f\u200b\u7279\u522b\u200b\u9488\u5bf9\u200b\u4f5c\u8005\u200b\u7684\u200b\u4e24\u4e2a\u200b\u597d\u200b\u670b\u53cb\u200b \u2014\u2014 \u200b\u67f4\u795e\u200b\u548c\u200b\u5143\u200b\u795e\u200b\u6240\u200b\u5f00\u53d1\u200b\u7684\u200b\uff0c\u200b\u4ee5\u200b\u7eaa\u5ff5\u200b\u4ed6\u4eec\u200b\u5bf9\u200b\u5356\u5f31\u200b\u4e8b\u4e1a\u200b\u6240\u200b\u4f5c\u51fa\u200b\u7684\u200b\u8d21\u732e\u200b\u3002</p> \u200b\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b Chai_Jile StandardPlugin '\u200b\u5bc4\u200b\u4e86\u200b' / '\u200b\u6211\u200b\u5bc4\u200b' user_id = ${\u200b\u67f4\u200bQQ} patpat\u200b\u67f4\u200b[CQ:face,id=49], \u200b\u4e0d\u8981\u200b\u4f24\u5fc3\u200b\ud83d\ude18 Yuan_Jile StandardPlugin '\u200b\u771f\u5f31\u200b' / '\u200b\u5bc4\u200b\u4e86\u200b' / '\u200b\u597d\u83dc\u200b' user_id = ${\u200b\u5143\u200bQQ} \ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05"},{"location":"plugin/plugins/jilePlugin/#2","title":"2. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u6b64\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>jile.py</code></p> <pre><code>class Chai_Jile(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\n\u200b\u67f4\u200b\u7684\u200bQQ\u200b\u53f7\u200b = None\nreturn ('\u200b\u6211\u200b\u5bc4\u200b' in msg or '\u200b\u5bc4\u200b\u4e86\u200b' in msg) and (data['user_id']==\u200b\u67f4\u200b\u7684\u200bQQ\u200b\u53f7\u200b)\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nsend(data['group_id'], 'patpat\u200b\u67f4\u200b[CQ:face,id=49], \u200b\u4e0d\u8981\u200b\u4f24\u5fc3\u200b\ud83d\ude18')\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'Chai_Jile',\n'description': '\u200b\u67f4\u200b\u5bc4\u200b\u4e86\u200b',\n'commandDescription': '\u200b\u5bc4\u200b\u4e86\u200b',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass Yuan_Jile(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\n\u200b\u5143\u200b\u7684\u200bQQ\u200b\u53f7\u200b = None\n\u200b\u5e94\u7528\u200bQQ\u200b\u7fa4\u200b = None\nreturn ('\u200b\u771f\u5f31\u200b' in msg or '\u200b\u5bc4\u200b\u4e86\u200b' in msg or '\u200b\u597d\u83dc\u200b' in msg) and (data['user_id']==\u200b\u5143\u200b\u7684\u200bQQ\u200b\u53f7\u200b) and (data['group_id']==\u200b\u5e94\u7528\u200bQQ\u200b\u7fa4\u200b)\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nsend(data['group_id'], '\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05\ud83d\ude05')\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'Yuan_Jile',\n'description': '\u200b\u5143\u200b\u5bc4\u200b\u4e86\u200b',\n'commandDescription': '\u200b\u5bc4\u200b\u4e86\u200b',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/messageRecorderPlugin/","title":"\u7fa4\u200b\u6d88\u606f\u200b\u8bb0\u5f55","text":""},{"location":"plugin/plugins/messageRecorderPlugin/#_1","title":"\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"<p>\u200b\u7fa4\u200b\u6d88\u606f\u200b\u8bb0\u5f55\u200b\u63d2\u4ef6\u200b\u80fd\u200b\u628a\u200b\u7fa4\u200b\u6d88\u606f\u200b\u8bb0\u5f55\u200b\u5230\u200b sql \u200b\u91cc\u200b\uff0c</p>"},{"location":"plugin/plugins/messageRecorderPlugin/#_2","title":"\u4ee3\u7801\u200b\u5206\u6790","text":"<ol> <li> <p>\u200b\u7fa4\u200b\u540d\u79f0\u200b\u548c\u200b\u804a\u5929\u8bb0\u5f55\u200b\u7684\u200b\u63a5\u53e3\u200b</p> <p>\u200b\u8fd9\u90e8\u5206\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>utils.basicEvent.py</code> \u200b\u4e2d\u200b\uff0c\u200b\u4e3b\u8981\u200b\u7528\u4e8e\u200b\u5bf9\u63a5\u200b QQ \u200b\u673a\u5668\u4eba\u200b\u540e\u200b\u7aef\u200b\uff0c\u200b\u5177\u4f53\u200b\u7ec6\u8282\u200b\u53ef\u200b\u53c2\u8003\u200b go-cqhttp\u200b\u6587\u6863\u200b\u3002</p> <pre><code>from utils.basicConfigs import HTTP_URL\ndef get_group_list()-&gt;list:\n\"\"\"\u200b\u83b7\u53d6\u200b\u7fa4\u804a\u200b\u5217\u8868\u200b\n    @return:\n        [\n            {\n                'group_create_time': int,\n                'group_id': int,\n                'group_name': str,\n                'group_level': int,\n                'max_member_count': int,\n                'member_count': int,\n            },\n            ....\n        ]\n    \u200b\u53c2\u8003\u200b\u94fe\u63a5\u200b\uff1a https://docs.go-cqhttp.org/api/#%E8%8E%B7%E5%8F%96%E7%BE%A4%E5%88%97%E8%A1%A8\n    \"\"\"\nurl = HTTP_URL+\"/get_group_list\"\ntry:\ngroupList = json.loads(requests.get(url).text)\nif groupList['status'] != 'ok':\nwarning(\"get_group_list requests not return ok\")\nreturn []\nreturn groupList['data']\nexcept BaseException as e:\nwarning(\"error in get_group_list, error: {}\".format(e))\nreturn []\ndef get_group_msg_history(group_id: int, message_seq: Union[int, None]=None)-&gt;list:\n\"\"\"\u200b\u83b7\u53d6\u200b\u7fa4\u200b\u6d88\u606f\u200b\u5386\u53f2\u8bb0\u5f55\u200b\n    @message_seq:\n        \u200b\u8d77\u59cb\u200b\u6d88\u606f\u200b\u5e8f\u53f7\u200b, \u200b\u53ef\u200b\u901a\u8fc7\u200b get_msg \u200b\u83b7\u5f97\u200b\n        \u200b\u5982\u679c\u200b\u662f\u200bNone\u200b\u5c06\u200b\u9ed8\u8ba4\u200b\u83b7\u53d6\u200b\u6700\u65b0\u200b\u7684\u200b\u6d88\u606f\u200b\n    @group_id: \u200b\u7fa4\u53f7\u200b\n    @return: \u200b\u4ece\u200b\u8d77\u59cb\u200b\u5e8f\u53f7\u200b\u5f00\u59cb\u200b\u7684\u200b\u524d\u200b19\u200b\u6761\u200b\u6d88\u606f\u200b\n    \u200b\u53c2\u8003\u200b\u94fe\u63a5\u200b\uff1a https://docs.go-cqhttp.org/api/#%E8%8E%B7%E5%8F%96%E7%BE%A4%E6%B6%88%E6%81%AF%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95\n    \"\"\"\nurl = HTTP_URL+\"/get_group_msg_history\"\ntry:\nparams = {\n\"group_id\": group_id\n}\nif message_seq != None:\nparams[\"message_seq\"] = message_seq\nmessageHistory = json.loads(requests.get(url, params=params).text)\nif messageHistory['status'] != 'ok':\nif messageHistory['msg'] == 'MESSAGES_API_ERROR':\nprint(\"group {} meet message API error\".format(group_id))\nelse:\nwarning(\"get_group_msg_history requests not return ok\\nmessages = {}\\ngroup_id={}\\nmessage_seq={}\".format(\nmessageHistory, group_id, message_seq))\nreturn []\nreturn messageHistory['data']['messages']\nexcept BaseException as e:\nwarning('error in get_group_msg_history, error: [}'.format(e))\nreturn []\n</code></pre> </li> <li> <p>\u200b\u8bb0\u5f55\u200b\u7fa4\u804a\u200b\u6d88\u606f\u200b</p> <p>\u200b\u8fd9\u90e8\u5206\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>messageRecorder.py</code> \u200b\u4e2d\u200b\uff0c\u200b\u4e3b\u8981\u200b\u7528\u6765\u200b\u8bb0\u5f55\u200b\u7fa4\u804a\u200b\u6d88\u606f\u200b</p> <pre><code>class GroupMessageRecorder(StandardPlugin):\ndef __init__(self) -&gt; None:\n# \u200b\u9996\u5148\u200b\u83b7\u53d6\u200b\u7fa4\u804a\u200b\u5217\u8868\u200b\uff0c\u200b\u770b\u770b\u200b\u6570\u636e\u5e93\u200b\u662f\u5426\u200b\u5f00\u200b\u4e86\u200b\u8fd9\u4e9b\u200b\u8868\u200b\nself.mydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nself.mydb.autocommit = True\nself.mycursor = self.mydb.cursor()\nself.mycursor.execute(\"\"\"\n        create table if not exists `BOT_DATA`.`messageRecord`(\n            `message_id` int not null,\n            `message_seq` bigint not null,\n            `time` timestamp not null,\n            `user_id` bigint not null,\n            `message` varchar(6000) not null,\n            `group_id` bigint not null,\n            `nickname` varchar(50) not null,\n            `card` varchar(50) not null,\n            `recall` bool not null default false,\n            primary key (`group_id`, `message_seq`)\n        )charset=utf8mb4, collate=utf8mb4_unicode_ci;\"\"\")\n# \u200b\u591a\u7ebf\u7a0b\u200b\u83b7\u53d6\u200b\u79bb\u7ebf\u200b\u671f\u95f4\u200b\u7684\u200b\u804a\u5929\u8bb0\u5f55\u200b\nlatestResultSeq = getLatestRecordSeq()\nself._getGroupMessageThread = threading.Thread(target=getGroupMessageThread,args=(latestResultSeq,))\nself._getGroupMessageThread.start()\ndef recallMessage(self, data):\nprint(data)\ntry:\nself.mycursor.execute(\"\"\"\n                update `BOT_DATA`.`messageRecord` set recall=true where \n                group_id = %d and message_id = %d\n            \"\"\"%(\ndata['group_id'], data['message_id']\n))\nexcept KeyError as e:\nwarning(\"key error in recall message: {}\".format(e))\nexcept mysql.connector.Error as e:\nwarning(\"mysql error in recall message: {}\".format(e))\nexcept BaseException as e:\nwarning(\"exception in recall message: {}\".format(e))\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn data['message_type']=='group'\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ntry:\nself.mycursor.execute(\"\"\"\n                insert into `BOT_DATA`.`messageRecord`\n                (`message_id`, `message_seq`, `time`, `user_id`,\n                `message`, `group_id`, `nickname`, `card`) \n                values (%d, %d, from_unixtime(%d), %d, '%s', %d, '%s', '%s')\"\"\"%(\ndata['message_id'],\ndata['message_seq'],\ndata['time'],\ndata['user_id'],\nescape_string(data['message']),\ndata['group_id'],\nescape_string(data['sender']['nickname']),\nescape_string(data['sender']['card'])\n)\n)\nexcept mysql.connector.Error as e:\nwarning(\"mysql error in MessageRecorder: {}\".format(e))\nexcept KeyError as e:\nwarning(\"key error in MessageRecorder: {}\".format(e))\nexcept BaseException as e:\nwarning(\"exception in MessageRecorder: {}\".format(e))\nreturn None\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'GroupMessageRecorder',\n'description': '\u200b\u8bb0\u5f55\u200b\u7fa4\u804a\u200b\u6d88\u606f\u200b',\n'commandDescription': '',\n'usePlace': ['group', 'group_recall'],\n'showInHelp': False,                \n'pluginConfigTableNames': ['messageRecord', ],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre> </li> <li> <p>\u200b\u83b7\u53d6\u200b bot \u200b\u79bb\u7ebf\u200b\u65f6\u200b\u7684\u200b\u804a\u5929\u8bb0\u5f55\u200b</p> <p>\u200b\u8fd9\u90e8\u5206\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>messageRecorder.py</code> \u200b\u4e2d\u200b\uff0c\u200b\u4e3b\u8981\u200b\u7528\u6765\u200b\u83b7\u53d6\u200b\u548c\u200b\u5b58\u50a8\u200bbot \u200b\u79bb\u7ebf\u200b\u65f6\u200b\u7684\u200b\u804a\u5929\u8bb0\u5f55\u200b</p> <pre><code>def getLatestRecordSeq():\ngroupList = [group['group_id'] for group in get_group_list()]\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmycursor = mydb.cursor()\nresult = []\nfor group_id in groupList:\nif not isinstance(group_id, int): continue\nmycursor.execute(\"\"\"\n            select max(message_seq) from `BOT_DATA`.`messageRecord`\n            where group_id = %d\"\"\"%group_id)\nlatestSeq = list(mycursor)\nif len(latestSeq) == 0:\nlatestSeq = None\nelse:\nlatestSeq = latestSeq[0][0]\nresult.append((group_id, latestSeq))\nreturn result\ndef getGroupMessageHistory(group_id: int, message_seq: Union[int, None]=None)-&gt;list:\n\"\"\"\u200b\u83b7\u53d6\u200b\u804a\u5929\u8bb0\u5f55\u200b\n    @group_id: \u200b\u7fa4\u53f7\u200b\n    @message_seq: \n        if None: \u200b\u83b7\u53d6\u200b\u6700\u65b0\u200b19\u200b\u6761\u200b\u6d88\u606f\u200b\u8bb0\u5f55\u200b\n        else:    \u200b\u83b7\u53d6\u200b\u5305\u542b\u200b\u5de6\u5f00\u200b\u53f3\u95ed\u200b\u533a\u95f4\u200b(message_seq, latest_seq]\u200b\u7684\u200b\u6d88\u606f\u200b\u8bb0\u5f55\u200b\u5217\u8868\u200b\n    @return: \u200b\u6d88\u606f\u200b\u8bb0\u5f55\u200b\u5217\u8868\u200b\n    \"\"\"\ntime.sleep(1)\nmessages = get_group_msg_history(group_id)\nif message_seq == None or len(messages) == 0:\nreturn messages\nfor seq in range(message_seq, messages[-1]['message_seq'], 19):\nmessages.append(get_group_msg_history(group_id, seq))\ntime.sleep(1)\nreturn messages\ndef getGroupMessageThread(latestResultSeq):\ndef flatten(messages):\nresult = []\nfor data in messages:\nif isinstance(data, list):\nresult.extend(flatten(data))\nelse:\nresult.append(data)\nreturn result\nmydb = mysql.connector.connect(charset='utf8mb4',**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\nfor group_id, latest_seq in latestResultSeq:\nmessages = getGroupMessageHistory(group_id, latest_seq)\nprint(\"get {} messages from group {}\".format(len(messages), group_id))\nfor data in flatten(messages):\ntry:\nmycursor.execute(\"\"\"\n                    insert ignore into `BOT_DATA`.`messageRecord`\n                    (`message_id`, `message_seq`, `time`, `user_id`,\n                    `message`, `group_id`, `nickname`, `card`) \n                    values (%d, %d, from_unixtime(%d), %d, '%s', %d, '%s', '%s')\"\"\"%(\ndata['message_id'],\ndata['message_seq'],\ndata['time'],\ndata['user_id'],\nescape_string(data['message']),\ndata['group_id'],\nescape_string(data['sender']['nickname']),\nescape_string(data['sender']['card'])\n)\n)\nexcept mysql.connector.Error as e:\nprint(data)\nwarning(\"mysql error in getGroupMessageThread: {}\".format(e))\nexcept KeyError as e:\nprint(data)\nwarning(\"key error in getGroupMessageThread: {}\".format(e))\nexcept BaseException as e:\nprint(data)\nwarning(\"exception in getGroupMessageThread: {}\".format(e))\n# with open(\"getGroupMessageThreadData.json\", 'w') as f:\n#     json.dump(data, f)\n</code></pre> </li> </ol>"},{"location":"plugin/plugins/myactPlugin/","title":"\u6c34\u7fa4\u200b\u62a5\u544a","text":""},{"location":"plugin/plugins/myactPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b ActReportPlugin StandardPlugin '-myact' None \u200b\u83b7\u53d6\u200b\u672c\u4eba\u200b\u6c34\u7fa4\u200b\u62a5\u544a"},{"location":"plugin/plugins/myactPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":""},{"location":"plugin/plugins/myactPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/groupActReport.py</code></p> <pre><code>class ActReportPlugin(StandardPlugin): \ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg == '-myact' and data['message_type'] == 'group'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nimgPath = getMyActivity(data['user_id'], data['group_id'])\nimgPath = imgPath if os.path.isabs(imgPath) else os.path.join(ROOT_PATH, imgPath)\nsend(data['group_id'], '[CQ:image,file=files://%s]'%imgPath, data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'ActReport',\n'description': '\u200b\u6211\u200b\u7684\u200b\u6c34\u7fa4\u200b\u62a5\u544a\u200b',\n'commandDescription': '-myact',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\ndef getMyActivity(user_id, group_id):\nmessageNumber = 0\nmessageWithBotNumber = 0\nmessageDescript = ''\nmessageMedal = []\nmessageWithBotMedal = []\nmessageImgEmjMedal = []\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"SELECT time, message FROM BOT_DATA.messageRecord where user_id=%d and group_id=%d\"%(user_id, group_id))\nresult=list(mycursor)\n# \u200b\u6d88\u606f\u200b\u6570\u91cf\u200b\nmessageNumber = len(result)\n# \u200b\u6d88\u606f\u200b-\u200b\u65f6\u95f4\u200b\u56fe\u200b\ntime_mes = {}\ntime_meswithbot = {}\ntime_meswithimgemoji = {} #\u200b\u56fe\u7247\u200b\u7c7b\u200b\u52a8\u753b\u200b\u8868\u60c5\u200b\nst:datetime.datetime = result[0][0]\net:datetime.datetime = result[-1][0]\nfor time, message in result:\ntime: datetime.datetime\nmessage: str\nmessage = message.strip()\nt = time.strftime('%Y-%m-%d')\ny = time_mes.get(t,0)\ny += 1\ntime_mes[t] = y\nif startswith_in(message.strip(),['-ddl','-canvas','\u200b\u7b7e\u5230\u200b','\u200b\u7948\u613f\u200b','-help','-st','-lib','-hs','-mdd','-jwc','-dekt','-mc','-sjmc','-fdc','-tjmc','-mclive','-sjmclive','-fdmclive','\u200b\u5c0f\u9a6c\u200b\uff0c','\u200b\u5c0f\u200b\ud83e\udd84\uff0c','\u200b\u5c0f\u9a6c\u200b,','\u200b\u5c0f\u200b\ud83e\udd84,','-mycoins','-mytrans','\u200b\u51b3\u6597\u200b','\u200b\u63a5\u53d7\u200b\u51b3\u6597\u200b','ttzf','izf','-myact']):\ny = time_meswithbot.get(t,0)\ny += 1\ntime_meswithbot[t] = y\n# pattern= re.compile(r'^\\[CQ\\:image\\,file.*subType\\=1\\,.*\\]')\nif ('[CQ:image,file' in message and 'subType=1' in message):\ny = time_meswithimgemoji.get(t,0)\ny += 1\ntime_meswithimgemoji[t] = y\nct:datetime.datetime = deepcopy(st)\nwhile (ct&lt;et):\nct += datetime.timedelta(days=1)\nif ct&gt;datetime.datetime.now():\nbreak\nt = ct.strftime('%Y-%m-%d')\ny = time_mes.get(t,0)\nif y==0:\ntime_mes[t] = 0\ny = time_meswithbot.get(t,0)\nif y==0:\ntime_meswithbot[t] = 0\ny = time_meswithimgemoji.get(t,0)\nif y==0:\ntime_meswithimgemoji[t] = 0\n# sorted(time_mes.keys())\nx_list = list(time_mes.keys())\ny_list = list(time_mes.values())\nx_list = [datetime.datetime.strptime(x,'%Y-%m-%d') for x in x_list]\n# \u200b\u6d88\u606f\u200b\u6700\u591a\u200b\u7684\u200b\u5929\u200b\ny_max = max(y_list)\nx_max = x_list[y_list.index(y_max)].strftime('%Y \u200b\u5e74\u200b %m \u200b\u6708\u200b %d \u200b\u65e5\u200b')\n# \u200b\u5e73\u5747\u200b\u6d88\u606f\u200b\ny_avg = messageNumber / (int((et.date()-st.date()).days)+1)\nif (y_max &lt;= 5):\nmessageDescript = '\u200b\u4f60\u200b\u662f\u200b\u672c\u7fa4\u200b\u7684\u200b\u6f5c\u6c34\u5458\u200b\uff0c\u200b\u65e5\u200b\u6700\u200b\u591a\u200b\u53d1\u9001\u4fe1\u606f\u200b\u5c11\u4e8e\u200b 5 \u200b\u6761\u200b'\nmessageMedal.append('\ud83c\udf96\ufe0f \u200b\u8d44\u6df1\u200b\u6f5c\u6c34\u200b')\nelse:\nif y_avg&lt;15:\nmessageDescript = '\u200b\u4f60\u200b\u5728\u200b\u672c\u7fa4\u200b\u4f4e\u8c03\u200b\u5185\u655b\u200b\uff0c\u200b\u5e73\u5747\u200b\u6bcf\u65e5\u200b\u53d1\u9001\u4fe1\u606f\u200b %.2f \u200b\u6761\u200b'%(y_avg)\nelif y_avg&lt;50:\nmessageDescript = '\u200b\u4f60\u200b\u5728\u200b\u672c\u7fa4\u200b\u6bd4\u8f83\u200b\u6d3b\u8dc3\u200b\uff0c\u200b\u5e73\u5747\u200b\u6bcf\u65e5\u200b\u53d1\u9001\u4fe1\u606f\u200b %.2f \u200b\u6761\u200b'%(y_avg)\nelse:\nmessageDescript = '\u200b\u4f60\u200b\u5728\u200b\u672c\u7fa4\u200b\u4f83\u4f83\u800c\u8c08\u200b\uff0c\u200b\u5e73\u5747\u200b\u6bcf\u65e5\u200b\u53d1\u9001\u4fe1\u606f\u200b %.2f \u200b\u6761\u200b'%(y_avg)\nmessageMedal.append('\ud83c\udf96\ufe0f \u200b\u6c34\u7fa4\u200b\u5927\u5e08\u200b')\nmessageDescript += '\\n%s\uff0c\u200b\u4f60\u200b\u4e00\u5171\u200b\u53d1\u9001\u200b\u4e86\u200b %d \u200b\u6761\u200b\u4fe1\u606f\u200b'%(x_max, y_max)\nif messageNumber &gt;=3000:\nmessageMedal.append('\ud83c\udf96\ufe0f \u200b\u6d3b\u8dc3\u200b\u5143\u8001\u200b')\nelif y_max &gt;=300:\nmessageMedal.append('\ud83c\udf96\ufe0f \u200b\u8c08\u5929\u8bf4\u5730\u200b')\nplt.figure(figsize=(10, 3)) \nplt.bar(x_list, y_list, color='#87CEEB')\nax = plt.gca()\nax.set_facecolor('#E8F8FF')\nplt.xticks(rotation=25,size=9)\ntime_dis_path = BytesIO()\nplt.margins(0.002, 0.1)\nplt.subplots_adjust(top=1,bottom=0,left=0,right=1,hspace=0,wspace=0) \nplt.savefig(time_dis_path, dpi=200, bbox_inches='tight')\ncard_content1 = [\n('subtitle','\u200b\u5171\u200b\u53d1\u9001\u4fe1\u606f\u200b %d \u200b\u6761\u200b\\n'%(messageNumber),PALETTE_SJTU_BLUE),\n('separator',),\n('illustration', time_dis_path),\n('body', messageDescript)\n]\nif len(messageMedal) &gt; 0:\ncard_content1.append(('subtitle', '  '.join(messageMedal), PALETTE_SJTU_BLUE))\n# Bot\u200b\u4e92\u52a8\u200b-\u200b\u65f6\u95f4\u200b\u56fe\u200b\nx_list = list(time_meswithbot.keys())\ny_list = list(time_meswithbot.values())\nx_list = [datetime.datetime.strptime(x,'%Y-%m-%d') for x in x_list]\nmessageWithBotNumber = sum(y_list)\n# Bot\u200b\u4e92\u52a8\u200b-\u200b\u5956\u7ae0\u200b\nif (messageWithBotNumber&gt;=500):\nmessageWithBotMedal.append('\ud83c\udf96\ufe0f \u200b\u9ad8\u7ea7\u200b\u6d4b\u8bd5\u200b\u5de5\u7a0b\u5e08\u200b')\nelif (messageWithBotNumber&gt;=200):\nmessageWithBotMedal.append('\ud83c\udf96\ufe0f \u200b\u4e2d\u7ea7\u200b\u6d4b\u8bd5\u200b\u5de5\u7a0b\u5e08\u200b')\nelif (messageWithBotNumber&gt;=50):\nmessageWithBotMedal.append('\ud83c\udf96\ufe0f \u200b\u521d\u7ea7\u200b\u6d4b\u8bd5\u200b\u5de5\u7a0b\u5e08\u200b')\nif (messageWithBotNumber / messageNumber &gt; 0.4):\nmessageWithBotMedal.append('\ud83c\udf96\ufe0f \u200b\u4fe1\u606f\u71b5\u200b\u64cd\u7eb5\u8005\u200b')\nplt.figure(figsize=(10, 3)) \nplt.bar(x_list, y_list, color='#F8AC51')\nax = plt.gca()\nax.set_facecolor('#FFEFDD')\nplt.xticks(rotation=25,size=9)\ntime_dis2_path = BytesIO()\nplt.margins(0.002, 0.1)\nplt.subplots_adjust(top=1,bottom=0,left=0,right=1,hspace=0,wspace=0) \nplt.savefig(time_dis2_path, dpi=200, bbox_inches='tight')\ncard_content2 = [\n('subtitle','\u200b\u4e0e\u200b\u5c0f\u200b\ud83e\udd84\u200b\u5171\u200b\u4e92\u52a8\u200b %d \u200b\u6b21\u200b\\n'%(messageWithBotNumber),PALETTE_SJTU_ORANGE),\n('separator',),\n('illustration', time_dis2_path)\n]\nif len(messageWithBotMedal) &gt; 0:\ncard_content2.append(('subtitle', '  '.join(messageWithBotMedal), PALETTE_SJTU_ORANGE))\n# \u200b\u56fe\u7247\u200b\u4fe1\u606f\u200b-\u200b\u65f6\u95f4\u200b\u56fe\u200b\nx_list = list(time_meswithimgemoji.keys())\ny_list = list(time_meswithimgemoji.values())\nx_list = [datetime.datetime.strptime(x,'%Y-%m-%d') for x in x_list]\nmessageImgEmojiNumber = sum(y_list)\nif (messageImgEmojiNumber&gt;=500):\nmessageImgEmjMedal.append('\ud83c\udf96\ufe0f \u200b\u8868\u60c5\u200b\u5305\u4e4b\u795e\u200b')\nplt.figure(figsize=(10, 3)) \nplt.bar(x_list, y_list, color='#7DC473')\nax = plt.gca()\nax.set_facecolor('#E5FBE2')\nplt.xticks(rotation=25,size=9)\ntime_dis3_path = BytesIO()\nplt.margins(0.002, 0.1)\nplt.subplots_adjust(top=1,bottom=0,left=0,right=1,hspace=0,wspace=0) \nplt.savefig(time_dis3_path, dpi=200, bbox_inches='tight')\nplt.close()\ncard_content3 = [\n('subtitle','\u200b\u5171\u200b\u53d1\u9001\u200b\u52a8\u753b\u200b\u8868\u60c5\u200b %d \u200b\u6b21\u200b\\n'%(messageImgEmojiNumber),PALETTE_SJTU_GREEN),\n('separator',),\n('illustration', time_dis3_path)\n]\nif len(messageImgEmjMedal) &gt; 0:\ncard_content3.append(('subtitle', '  '.join(messageImgEmjMedal), PALETTE_SJTU_GREEN))\nimg_avatar = Image.open(BytesIO(get_avatar_pic(user_id)))\n# \u200b\u751f\u6210\u200b\u5361\u7247\u200b\u56fe\u200b\nActCards = ResponseImage(\ntitleColor = PALETTE_SJTU_BLUE,\ntitle = '\u200b\u6211\u200b\u7684\u200b\u6c34\u7fa4\u200b\u62a5\u544a\u200b',\nlayout = 'normal',\nwidth = 880,\ncardBodyFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 24),\ncardSubtitleFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 30),\n)\nActCards.addCardList([\nResponseImage.RichContentCard(\nraw_content=[\n('subtitle','ID : %d'%(user_id)),\n('separator',),\n('keyword','\u200b\u7fa4\u200b : %d'%(group_id))\n],\nicon = img_avatar\n),\nResponseImage.RichContentCard(\nraw_content = card_content1\n),\nResponseImage.RichContentCard(\nraw_content = card_content2\n),\nResponseImage.RichContentCard(\nraw_content = card_content3\n)\n])\nsave_path = (os.path.join(SAVE_TMP_PATH, f'{user_id}_{group_id}_actReport.png'))\nActCards.generateImage(save_path)\nreturn save_path\nexcept mysql.connector.Error as e:\nwarning(\"mysql error in getMyActivity: {}\".format(e))\nexcept BaseException as e:\nwarning(\"error in getMyActivity: {}\".format(e))     \n</code></pre>"},{"location":"plugin/plugins/newsPlugin/","title":"\u65b0\u95fb","text":""},{"location":"plugin/plugins/newsPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b ShowNews StandardPlugin '\u200b\u65b0\u95fb\u200b' None \u200b\u83b7\u53d6\u200b\u5f53\u65e5\u200b\u65b0\u95fb"},{"location":"plugin/plugins/newsPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u4ee3\u7801\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>ROOT_ADMIN_ID = [111, # \u200b\u7528\u6237\u200bA  \n222, # \u200b\u7528\u6237\u200bB\n444] # \u200b\u7528\u6237\u200bD\nGroupPluginList = [ # \u200b\u7fa4\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\n# .....\nPluginGroupManager([ShowNews()],'news'),  # \u200b\u65b0\u95fb\u200b\n# .....\n]\nPrivatePluginList=[ # \u200b\u79c1\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\n# .....\nShowNews(),\n# .....\n]\n</code></pre> <p>\u200b\u7fa4\u804a\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code># \u200b\u7fa4\u5185\u200b\u5c1a\u672a\u200b\u6253\u5f00\u200bnews\n111&gt; \u200b\u65b0\u95fb\u200b\n# \u200b\u65e0\u200b\u4e8b\u200b\u53d1\u751f\u200b\n# \u200b\u63a5\u4e0b\u6765\u200b\u7ba1\u7406\u5458\u200b\u6253\u5f00\u200bnews\n111&gt; -grpcfg enable news\nbot&gt; OK\n\n111&gt; \u200b\u65b0\u95fb\u200b\nbot&gt; ${\u200b\u65b0\u95fb\u200b\u56fe\u7247\u200b}\n</code></pre> <p>\u200b\u56fe\u7247\u200b\u5c55\u793a\u200b\uff1a</p> <p></p>"},{"location":"plugin/plugins/newsPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>import requests\nfrom lxml import etree\nfrom PIL import Image, ImageDraw, ImageFont\nimport datetime\nfrom pathlib import Path\nimport re\nfrom typing import Union, Any\nfrom utils.basicEvent import *\nfrom utils.basicConfigs import *\nfrom utils.standardPlugin import StandardPlugin\nTXT_ONELINE_SIZE=745\nclass ShowNews(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn (msg in ['\u200b\u6bcf\u65e5\u200b\u65b0\u95fb\u200b','\u200b\u65b0\u95fb\u200b'])\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nret = get_news()\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nif ret==\"err 0\":\nsend(target, \"\u200b\u83b7\u53d6\u200b\u5931\u8d25\u200b\\n\u200b\u65b0\u95fb\u200b\u6e90\u200b\u5c1a\u672a\u200b\u66f4\u65b0\u200b\u672c\u200b\u65e5\u200b\u65b0\u95fb\u200b\", data['message_type'])\nelse:\nnewsPicPath = os.path.join(ROOT_PATH, ret)\nsend(target, f'[CQ:image,file=files://{newsPicPath},id=40000]', data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'ShowNews',\n'description': '\u200b\u65b0\u95fb\u200b',\n'commandDescription': '\u200b\u6bcf\u65e5\u200b\u65b0\u95fb\u200b/\u200b\u65b0\u95fb\u200b',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': '\u200b\u5317\u6781\u200b\u3065\u200b\u839c\u84dd\u200b',\n}\ndef get_news():\n#\u200b\u5efa\u8bae\u200b\u662f\u200b\u751f\u6210\u200b\u56fe\u7247\u200b\u5bbd\u5ea6\u200b-\u200b\u4e24\u4fa7\u200b\u8fb9\u8ddd\u200b-\u200b\u6296\u52a8\u200b\ntoday_str=str(datetime.date.today())\nnewsPicPath = os.path.join(SAVE_TMP_PATH, f'{today_str}_news.png')\nif Path(newsPicPath).is_file(): #\u200b\u4eca\u65e5\u200b\u5df2\u200b\u66f4\u65b0\u200b\u5219\u200b\u8fd4\u56de\u200b\nreturn newsPicPath\nheaders={\n'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36'\n}\nurl = 'https://www.liulinblog.com/kuaixun'\npage_text = requests.get(url=url,headers=headers).text\ntree = etree.HTML(page_text)\nimg_url = tree.xpath('//div[@class=\"col-lg-12\"]//a[@target=\"_blank\"]/@href')[0]\ndetail_page_text = requests.get(url=img_url,headers=headers).text\nnewtree = etree.HTML(detail_page_text)\ntitle = newtree.xpath('//h1[@class=\"entry-title\"]/text()')[0]\n# \u200b\u5224\u65ad\u200b\u662f\u5426\u200b\u5f53\u65e5\u200b\u66f4\u65b0\u200b\nnews_day=int((re.findall(\"\u200b\u6708\u200b(.*?)\u200b\u65e5\u200b\",title))[0])\nif news_day != int(datetime.date.today().day):\nreturn \"err 0\"\nnews = newtree.xpath('//div[@class=\"entry-content u-text-format u-clearfix\"]//p/text()')\n#news[0] = title\ntotal = title\nfor new in news[:-1]:\ntotal = total+new.strip()\ntotal = total+'\\n'\ntotal=total.replace('https://www.liulinblog.com/','',1)\ntotal=total.replace('\uff0c\u200b\u5728\u200b\u8fd9\u91cc\u200b\u6bcf\u5929\u200b60\u200b\u79d2\u200b\u8bfb\u61c2\u200b\u4e16\u754c\u200b\uff01','\\n',1)\nreturn draw_news_card(total)\ndef draw_news_card(text):\ntoday_str=str(datetime.date.today())\ntxt_line=\"\"\ntxt_parse=[]\nfor word in text:\nif txt_line==\"\" and word in ['\uff0c','\uff1b','\u3002','\u3001','\"','\uff1a']: #\u200b\u907f\u514d\u200b\u6807\u70b9\u7b26\u53f7\u200b\u5728\u200b\u9996\u4f4d\u200b\ntxt_parse[-1]+=word\ncontinue\ntxt_line+=word\nif word=='\\n':\nif txt_line !='\\n':\ntxt_parse.append(txt_line)\ntxt_parse.append(\"-sep line-\")\ntxt_line=\"\"\ncontinue\nif font_hywh_85w_ms.getsize(txt_line)[0]&gt;TXT_ONELINE_SIZE:\ntxt_parse.append(txt_line)\ntxt_line=\"\"\nif txt_line!=\"\":\ntxt_parse.append(txt_line)\nwidth=880\ni,j=0,0\nfor one_line in txt_parse:\nif one_line==\"-sep line-\":\nj+=1\ncontinue\ni+=1\nheight=250+i*45+j*20\nimg = Image.new('RGBA', (width, height), (46, 192, 189, 255))\ndraw = ImageDraw.Draw(img)\ndraw.rectangle((0, 120, width, height), fill=(255, 255, 255, 255))\ndraw.text((width-300,40), \"\u200b\u6bcf\u65e5\u200b\u65b0\u95fb\u200b\", fill=(255,255,255,255), font=font_hywh_85w)\ndraw.text((width-120,44), \"LITTLE\\nUNIkeEN\", fill=(255,255,255,255), font=font_syht_m)\ni,j=0,0\nfor one_line in txt_parse:\nif one_line==\"-sep line-\":\nj+=1\ncontinue\ndraw.text((60,150+i*45+j*20), one_line, fill=(0,0,0,255), font=font_hywh_85w_ms)\ni+=1\ndraw.text((30,height-78),'\u200b\u6765\u6e90\u200b:\u200b\u6f8e\u6e43\u200b\u3001\u200b\u4eba\u6c11\u65e5\u62a5\u200b\u3001\u200b\u817e\u8baf\u200b\u65b0\u95fb\u200b\u3001\u200b\u7f51\u6613\u200b\u65b0\u95fb\u200b\u3001\u200b\u65b0\u534e\u7f51\u200b\u3001\u200b\u4e2d\u56fd\u200b\u65b0\u95fb\u7f51\u200b', fill=(175,175,175,255), font=font_syht_m)\ndraw.text((30,height-48),'A plugin by \u200b\u5317\u6781\u200b\u3065\u200b\u839c\u84dd\u200b, made for Little-UNIkeEN-Bot', fill=(175,175,175,255), font=font_syht_m)\nsave_path = os.path.join(SAVE_TMP_PATH, f'{today_str}_news.png')\nimg.save(save_path)\nreturn save_path\n</code></pre>"},{"location":"plugin/plugins/randomNumPlugin/","title":"\u968f\u673a\u6570","text":""},{"location":"plugin/plugins/randomNumPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b ThreeKingdomsRandom StandardPlugin '\u200b\u5224\u5b9a\u200b' None \u200b\u4e09\u56fd\u200b\u6740\u200b\u5224\u5b9a\u200b RandomNum StandardPlugin '[...]d[...]' None \u200b\u751f\u6210\u200b\u968f\u673a\u6570\u200b TarotRandom StandardPlugin '\u200b\u5854\u7f57\u200b' / '\u200b\u5360\u535c\u200b' None \u200b\u751f\u6210\u200b\u4e09\u5f20\u200b\u968f\u673a\u200b\u5854\u7f57\u724c"},{"location":"plugin/plugins/randomNumPlugin/#2","title":"2. \u200b\u6837\u4f8b\u200b\u5206\u6790","text":"<pre><code>111&gt; \u200b\u5224\u5b9a\u200b\nbot&gt; \u3010\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b\u3011\u200b\u4f60\u200b\u7684\u200b\u5224\u5b9a\u200b\u7ed3\u679c\u200b\u662f\u200b\u3010\u26653\u3011\n111&gt; \u200b\u5224\u5b9a\u200b\nbot&gt; \u3010\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b\u3011\u200b\u4f60\u200b\u7684\u200b\u5224\u5b9a\u200b\u7ed3\u679c\u200b\u662f\u200b\u3010\u26606\u3011\n222&gt; 3d10\nbot&gt; \u3010\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b\u30111, 9, 2\n111&gt; 0d1\nbot&gt; \u3010\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b\u3011\u200b\u6295\u63b7\u200b\u6b21\u6570\u200b\u8981\u200b\u4e3a\u200b\u6b63\u200b\u54e6\u200b~\n222&gt; 300d2\nbot&gt; \u3010\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b\u3011\u200b\u5bf9\u4e0d\u8d77\u200b\uff0c\u200b\u6211\u200b\u53ea\u6709\u200b20\u200b\u4e2a\u200b\u9ab0\u5b50\u200b~\n333&gt; \u200b\u5854\u7f57\u200b\nbot&gt; \u3010\u200b\u56fe\u7247\u200b\u3011\n</code></pre>"},{"location":"plugin/plugins/randomNumPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/randomNum.py</code></p> <pre><code>class ThreeKingdomsRandom(StandardPlugin):\ndef __init__(self) -&gt; None:\n# self.flowers = ['\u200b\u7ea2\u6843\u200b', '\u200b\u9ed1\u6843\u200b', '\u200b\u6885\u82b1\u200b', '\u200b\u65b9\u7247\u200b']\nself.flowers = ['\u2665', '\u2660', '\u2663', '\u2666']\nself.points = [ 'A', '2', '3', '4', '5',\n'6', '7', '8', '9', '10',\n'J', 'Q', 'K']\ndef judgeTrigger(self, msg: str, data) -&gt; bool:\nreturn msg == '\u200b\u5224\u5b9a\u200b'\ndef executeEvent(self, msg: str, data) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nresult = random.choice(self.flowers) + random.choice(self.points)\nsend(target,'[CQ:reply,id=%d]\u200b\u4f60\u200b\u7684\u200b\u5224\u5b9a\u200b\u7ed3\u679c\u200b\u662f\u200b\u3010%s\u3011'%(data['message_id'], result), data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self):\nreturn {\n'name': 'ThreeKingdomsRandom',\n'description': '\u200b\u4e09\u56fd\u200b\u6740\u200b\u5224\u5b9a\u200b',\n'commandDescription': '\u200b\u5224\u5b9a\u200b',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass RandomNum(StandardPlugin):\ndef __init__(self) -&gt; None:\nself.pattern = re.compile(r'^(\\-?\\d+)d(\\-?\\d+)$')\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn self.pattern.match(msg) != None\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\ntimes, maxNum = self.pattern.findall(msg)[0]\ntimes = int(times)\nmaxNum = int(maxNum)\nif times &gt; 20:\nresult = '\u200b\u5bf9\u4e0d\u8d77\u200b\uff0c\u200b\u6211\u200b\u53ea\u6709\u200b20\u200b\u4e2a\u200b\u9ab0\u5b50\u200b~'\nelif times &lt;= 0:\nresult = '\u200b\u6295\u63b7\u200b\u6b21\u6570\u200b\u8981\u200b\u4e3a\u200b\u6b63\u200b\u54e6\u200b~'\nelif maxNum &lt;= 0:\nresult = '\u200b\u9ab0\u5b50\u200b\u6700\u5927\u200b\u70b9\u6570\u200b\u5fc5\u987b\u200b\u662f\u200b\u6b63\u6570\u200b\u54e6\u200b~'\nelif maxNum &gt; 120:\nresult = '\u200b\u5bf9\u4e0d\u8d77\u200b\uff0c\u200b\u6211\u200b\u53ea\u80fd\u200b\u5236\u4f5c\u200b\u6700\u200b\u591a\u200b120\u200b\u4e2a\u9762\u200b\u7684\u200b\u9ab0\u5b50\u200b~'\nelse:\nresult = ', '.join([str(random.randint(1, maxNum)) for _ in range(times)])\nsend(target,'[CQ:reply,id=%d]%s'%(data['message_id'], result), data['message_type'])\nreturn 'OK'\ndef getPluginInfo(self):\nreturn {\n'name': 'RandomNum',\n'description': '\u200b\u968f\u673a\u6570\u200b\u751f\u6210\u200b',\n'commandDescription': '[\u200b\u9ab0\u5b50\u200b\u4e2a\u6570\u200b]d[\u200b\u9ab0\u5b50\u200b\u9762\u6570\u200b]',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass TarotRandom(StandardPlugin):\ndef __init__(self) -&gt; None:\nself.resourcePath = './resources/tarot'\nself.resource:dict = json.load(open(os.path.join(self.resourcePath, 'tarot.json'),'r'))\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn msg in ['\u200b\u5360\u535c\u200b', '\u200b\u5854\u7f57\u200b', '\u200b\u5854\u7f57\u200b\u5360\u535c\u200b']\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\ngroup_id = data['group_id'] if data['message_type']=='group' else 0\nuser_id = data['user_id']\nfolders = random.sample(self.resource.keys(), 3)\nimgNames = [os.path.join(self.resourcePath, random.choice(self.resource[f])) for f in folders]\nimgs = [Image.open(f) for f in imgNames]\nim = draw_tarot(imgs)\npicPath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'tarot_%d_%d.png'%(group_id, user_id))\nim.save(picPath)\nsend(target, f'[CQ:image,file=files://{picPath}]', data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self):\nreturn {\n'name': 'TarotRandom',\n'description': '\u200b\u5854\u7f57\u724c\u200b\u5360\u535c\u200b',\n'commandDescription': '\u200b\u5360\u535c\u200b/\u200b\u5854\u7f57\u200b',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\ndef draw_tarot(tarots:List[Image.Image])-&gt;Image.Image:\nw, h = (750, 400)\nw_i = w / len(tarots)\nimg = Image.new('RGBA', (w, h), PALETTE_WHITE)\nfor idx, tarot in enumerate(tarots):\ntarot: Image.Image\ncell_center_x = w_i / 2 + idx * w_i\ncell_center_y = h / 2\ntarot_x = cell_center_x - tarot.width / 2\ntarot_y = cell_center_y - tarot.height / 2\nimg.paste(tarot, (int(tarot_x), int(tarot_y)))\nreturn img\n</code></pre>"},{"location":"plugin/plugins/signinPlugin/","title":"\u7b7e\u5230","text":""},{"location":"plugin/plugins/signinPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b SignIn StandardPlugin '\u200b\u7b7e\u5230\u200b'/'\u200b\u6253\u5361\u200b'/'\u200b\u6bcf\u65e5\u200b\u7b7e\u5230\u200b' None \u200b\u7b7e\u5230"},{"location":"plugin/plugins/signinPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; \u200b\u7b7e\u5230\u200b\nbot&gt; \u3010\u200b\u7b7e\u5230\u200b\u56fe\u200b1\u3011\n111&gt; \u200b\u7b7e\u5230\u200b\nbot&gt; \u3010\u200b\u7b7e\u5230\u200b\u56fe\u200b2\u3011\n</code></pre> <p>\u200b\u7b7e\u5230\u200b\u56fe\u200b1:</p> <p></p> <p>\u200b\u7b7e\u5230\u200b\u56fe\u200b2:</p> <p></p>"},{"location":"plugin/plugins/signinPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>FORTUNE_TXT = [['r',\"\u200b\u5927\u5409\u200b\"],['r',\"\u200b\u4e2d\u5409\u200b\"],['r',\"\u200b\u5c0f\u5409\u200b\"],['g',\"\u200b\u4e2d\u5e73\u200b\"],['h',\"\u200b\u5c0f\u8d62\u200b\"],['h',\"\u200b\u4e2d\u8d62\u200b\"],['h',\"\u200b\u5927\u8d62\u200b\"],['r',\"\u200b\u5946\u200b\ud83d\udc14\"],['h','\u200b\u5946\u200b\ud83d\udc3b']]\nclass SignIn(StandardPlugin): \ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u7b7e\u5230\u200b','\u200b\u6bcf\u65e5\u200b\u7b7e\u5230\u200b','\u200b\u6253\u5361\u200b']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\npicPath = sign_in(data['user_id'])\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, f'[CQ:image,file=files://{picPath}]',data['message_type'])\ndef getPluginInfo(self,)-&gt;Any:\nreturn {\n'name': 'SignIn',\n'description': '\u200b\u7b7e\u5230\u200b',\n'commandDescription': '\u200b\u7b7e\u5230\u200b/\u200b\u6bcf\u65e5\u200b\u7b7e\u5230\u200b/\u200b\u6253\u5361\u200b',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n# \u200b\u7ed8\u5236\u200b\u7b7e\u5230\u200b\u56fe\u200b\ndef draw_signinbanner(qq_id:int, add_coins, now_coins, fortune):\nimg = Image.new('RGBA', (720, 480), (random.randint(50,200),random.randint(50,200),random.randint(50,200),255))\ndraw = ImageDraw.Draw(img)\ndraw.rectangle((0, 120, 720, 480), fill=(255, 255, 255, 255))\ndraw.text((420,40), \"\u200b\u6bcf\u65e5\u200b\u7b7e\u5230\u200b\", fill=(255,255,255,255), font=font_hywh_85w)\ndraw.text((600,44), \"LITTLE\\nUNIkeEN\", fill=(255,255,255,255), font=font_syht_m)\n# \u200b\u83b7\u53d6\u200b\u5934\u50cf\u200b\nurl_avatar = requests.get(f'http://q2.qlogo.cn/headimg_dl?dst_uin={qq_id}&amp;spec=100')\nimg_avatar = Image.open(BytesIO(url_avatar.content)).resize((150,150))\nmask = Image.new('RGBA', (150, 150), color=(0,0,0,0))\n# \u200b\u5706\u5f62\u200b\u8499\u7248\u200b\nmask_draw = ImageDraw.Draw(mask)\nmask_draw.ellipse((0,0, 150, 150), fill=(159,159,160))\nimg.paste(img_avatar, (60, 80), mask)\n# ID\ndraw.text((250, 150), \"id\uff1a\"+str(qq_id), fill=(0, 0, 0, 255), font=font_hywh_85w)\n# \u200b\u7b7e\u5230\u200b\u53ca\u9996\u200b\u7b7e\u200b\u5fbd\u7ae0\u200b\nif add_coins == -1:\ndraw.text((60, 280), \"\u200b\u4eca\u5929\u200b\u5df2\u7ecf\u200b\u7b7e\u8fc7\u200b\u5230\u200b\u4e86\u200b\u5594\u200b~\", fill=(255, 128, 64, 255), font=font_hywh_85w)\nelse:\ndraw.text((60, 280), f\"\u200b\u7b7e\u5230\u200b\u6210\u529f\u200b\uff0c\u200b\u91d1\u5e01\u200b+{str(add_coins)}\", fill=(34, 177, 76, 255), font=font_hywh_85w)\ndraw.text((60, 360), f\"\u200b\u5f53\u524d\u200b\u91d1\u5e01\u200b\uff1a{str(now_coins)}\", fill=(0, 0, 0, 255), font=font_hywh_85w)\n# \u200b\u8fd0\u52bf\u200b\nf_type=FORTUNE_TXT[fortune][0]\ndraw.rectangle((500,280,660,420),fill=BACK_CLR[f_type])\ndraw.text((540,295), '\u200b\u4eca\u65e5\u200b\u8fd0\u52bf\u200b', fill=FONT_CLR[f_type], font=font_hywh_85w_s)\nif fortune&gt;=7:\ndraw.text((525,340), FORTUNE_TXT[fortune][1][0], fill=FONT_CLR[f_type], font=font_hywh_85w_l)\ndraw.text((580,350), FORTUNE_TXT[fortune][1][1], fill=FONT_CLR[f_type], font=font_sg_emj)\nelse:\ndraw.text((525,340), FORTUNE_TXT[fortune][1], fill=FONT_CLR[f_type], font=font_hywh_85w_l)\nsave_path=os.path.join(SAVE_TMP_PATH, \"%d_sign.png\"%qq_id)\n# (f'{SAVE_TMP_PATH}/{qq_id}_sign.png')\nimg.save(save_path)\nreturn save_path\n# \u200b\u7b7e\u5230\u200b\ndef sign_in(qq_id:int):\nid= qq_id if isinstance(qq_id, int) else int(qq_id)\ntoday_str=str(datetime.date.today())\n#first_sign = False\nmydb = mysql.connector.connect(**sqlConfig)\nmydb.autocommit = True\nmycursor = mydb.cursor()\nmycursor.execute(\"SELECT lastSign FROM BOT_DATA.accounts where id=%d\"%id)\nresult=list(mycursor)\nif len(result)==0:\nmycursor.execute(\"\"\"INSERT INTO BOT_DATA.accounts (id, coin, lastSign) \n            VALUES (%d, '0', '1980-01-01')\"\"\"%id)\nlast_sign_date = '1980-01-01'\nelse:\nlast_sign_date = str(result[0][0])\nif last_sign_date !=today_str:\nadd_coins = random.randint(50,100)\nfortune = random.randint(0,6)\nupdate_user_coins(id, add_coins, '\u200b\u7b7e\u5230\u200b\u5956\u52b1\u200b')\ntry:\nmycursor.execute(\"UPDATE BOT_DATA.accounts SET lastSign='%s', fortune=%d WHERE id=%d;\"\n%(escape_string(today_str), fortune, id))\nexcept mysql.connector.errors.DatabaseError as e:\nwarning(\"sql error in signin: {}\".format(e))\nreturn draw_signinbanner(id, add_coins, get_user_coins(id), fortune)\nelse:\nmycursor.execute(\"SELECT fortune FROM BOT_DATA.accounts where id=%d\"%id)\nfortune=list(mycursor)[0][0]\nreturn draw_signinbanner(id, -1, get_user_coins(id), fortune)\n</code></pre>"},{"location":"plugin/plugins/sjmcLivePlugin/","title":"SJMC \u200b\u76f4\u64ad\u95f4\u200b\u72b6\u6001","text":""},{"location":"plugin/plugins/sjmcLivePlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b SjmcLiveStatus StandardPlugin '-mclive' / '-sjmclive' None \u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200bmc\u200b\u793e\u200bB\u200b\u7ad9\u200b\u76f4\u64ad\u200b\u72b6\u6001\u200b\uff0c\u200b\u76d1\u6d4b\u200bsjmc\u200b\u76f4\u64ad\u95f4\u200b\u4fe1\u606f\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u7279\u5b9a\u200b\u7fa4\u200b\u5e7f\u64ad\u200b\u5f00\u64ad\u200b\u6d88\u606f\u200b FduMcLiveStatus StandardPlugin '-fdmclive' None \u200b\u83b7\u53d6\u200b\u590d\u65e6\u200b\u57fa\u5ca9\u200b\u793e\u200bB\u200b\u7ad9\u200b\u76f4\u64ad\u200b\u72b6\u6001\u200b\uff0c\u200b\u76d1\u6d4b\u200b\u57fa\u5ca9\u200b\u793e\u200b\u76f4\u64ad\u95f4\u200b\u4fe1\u606f\u200b\uff0c\u200b\u5e76\u200b\u5728\u200b\u7279\u5b9a\u200b\u7fa4\u200b\u5e7f\u64ad\u200b\u5f00\u64ad\u200b\u6d88\u606f"},{"location":"plugin/plugins/sjmcLivePlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>MC\u200b\u793e\u200bB\u200b\u7ad9\u200b\u672a\u200b\u5f00\u64ad\u200b\n111&gt; -sjmclive\nbot&gt; \u200b\u5f53\u524d\u200b\u65f6\u6bb5\u200b\u672a\u200b\u5f00\u64ad\u200b\u54e6\u200b\n\nMC\u200b\u793e\u200bB\u200b\u7ad9\u200b\u5f00\u64ad\u200b\nbot&gt; \u200b\u68c0\u6d4b\u200b\u5230\u200bMC\u200b\u793e\u200bB\u200b\u7ad9\u200b\u5f00\u64ad\u200b\uff0cSJMC\u200b\u793e\u200b\u76f4\u64ad\u200b\u5730\u5740\u200b\uff1a https://live.bilibili.com/25567444\nbot&gt; \u3010sjmc\u200b\u76f4\u64ad\u95f4\u200b\u4fe1\u606f\u200b\u56fe\u7247\u200b\u3011\n333&gt; -sjmc\nbot&gt; \u3010sjmc\u200b\u76f4\u64ad\u95f4\u200b\u4fe1\u606f\u200b\u56fe\u7247\u200b\u3011\n</code></pre> <p>sjmc\u200b\u76f4\u64ad\u95f4\u200b\u4fe1\u606f\u200b\u56fe\u7247\u200b:  </p>"},{"location":"plugin/plugins/sjmcLivePlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b plugins/sjmcLive.py</p> <pre><code>class SjmcLiveStatus(StandardPlugin):\nmonitorSemaphore = Semaphore()\n@staticmethod\ndef dumpSjmcStatus(status: bool):\nexactPath = 'data/sjmcLive.json'\nwith open(exactPath, 'w') as f:\nf.write('1' if status else '0')\n@staticmethod\ndef loadSjmcStatus()-&gt;bool:\nexactPath = 'data/sjmcLive.json'\nwith open(exactPath, 'r') as f:\nreturn f.read().startswith('1')\ndef __init__(self) -&gt; None:\nself.liveId = 25567444\nself.liveRoom = LiveRoom(self.liveId)\nself.timer = Timer(5, self.sjmcMonitor)\nif SjmcLiveStatus.monitorSemaphore.acquire(blocking=False):\nself.timer.start()\nself.exactPath = 'data/sjmcLive.json'\nself.prevStatus = False # false: \u200b\u672a\u200b\u5f00\u64ad\u200b, true: \u200b\u5f00\u64ad\u200b\nself.sjmcQqGroup = 712514518\nif not os.path.isfile(self.exactPath):\nSjmcLiveStatus.dumpSjmcStatus(False)\nelse:\nself.prevStatus = SjmcLiveStatus.loadSjmcStatus()\ndef sjmcMonitor(self):\n# print('mctick')\nself.timer.cancel()\nself.timer = Timer(60,self.sjmcMonitor)\nself.timer.start()\nprevStatus = SjmcLiveStatus.loadSjmcStatus()\nroomInfo = asyncio.run(self.liveRoom.get_room_info())['room_info']\ncurrentStatus = roomInfo['live_status'] == 1\nif currentStatus != prevStatus:\nSjmcLiveStatus.dumpSjmcStatus(currentStatus)\nif currentStatus and self.sjmcQqGroup in getPluginEnabledGroups('sjmc'):\nsend(self.sjmcQqGroup, '\u200b\u68c0\u6d4b\u200b\u5230\u200bMC\u200b\u793e\u200bB\u200b\u7ad9\u200b\u5f00\u64ad\u200b\uff0cSJMC\u200b\u793e\u200b\u76f4\u64ad\u200b\u5730\u5740\u200b\uff1a https://live.bilibili.com/%d'%self.liveId)\nsavePath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'sjmcLive.png')\ngenLivePic(roomInfo, 'sjmc\u200b\u76f4\u64ad\u95f4\u200b\u72b6\u6001\u200b', savePath)\nsend(self.sjmcQqGroup, f'[CQ:image,file=files://{savePath},id=40000]')\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn msg in ['-mclive', '-sjmclive']\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\ntry:\nroomInfo = asyncio.run(self.liveRoom.get_room_info())['room_info']\nexcept LiveException as e:\nwarning(\"sjmc bilibili api exception: {}\".format(e))\nreturn\nexcept ApiException as e:\nwarning('bilibili api exception: {}'.format(e))\nreturn \nexcept BaseException as e:\nwarning('base exception in sjmclive: {}'.format(e))\nreturn\nif roomInfo['live_status'] == 1:\nsavePath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'sjmcLive-%d.png'%target)\ngenLivePic(roomInfo, 'sjmc\u200b\u76f4\u64ad\u95f4\u200b\u72b6\u6001\u200b', savePath)\nsend(target, f'[CQ:image,file=files://{savePath},id=40000]', data['message_type'])\nelse:\nsend(target, '\u200b\u5f53\u524d\u200b\u65f6\u6bb5\u200b\u672a\u200b\u5f00\u64ad\u200b\u54e6\u200b', data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'sjmclive',\n'description': '\u200b\u4ea4\u5927\u200bMC\u200b\u793e\u200bB\u200b\u7ad9\u200b\u76f4\u64ad\u95f4\u200b\u72b6\u6001\u200b',\n'commandDescription': '-mclive/-sjmclive',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.3',\n'author': 'Unicorn',\n}\ndef genLivePic(roomInfo, title, savePath)-&gt;str:\nimg = ResponseImage(\ntheme = 'unicorn',\ntitle = title, \ntitleColor = PALETTE_SJTU_GREEN, \nprimaryColor = PALETTE_SJTU_RED, \nfooter = datetime.now().strftime('\u200b\u5f53\u524d\u200b\u65f6\u95f4\u200b %Y-%m-%d %H:%M:%S'),\nlayout = 'normal'\n)\nimg.addCard(\nResponseImage.NoticeCard(\ntitle = roomInfo['title'],\nsubtitle = datetime.fromtimestamp(roomInfo['live_start_time']).strftime(\n\"\u200b\u5f00\u64ad\u200b\u65f6\u95f4\u200b  %Y-%m-%d %H:%M:%S\"),\nkeyword = '\u200b\u76f4\u64ad\u200b\u5206\u533a\u200b\uff1a '+roomInfo['area_name'],\nbody = roomInfo['description'],\nillustration = roomInfo['keyframe'],\n)\n)\nimg.generateImage(savePath)\nreturn savePath\n</code></pre> <p>\u200b\u4e3a\u4e86\u200b\u786e\u4fdd\u200b\u5b9e\u4f8b\u200b\u5316\u200b\u591a\u4e2a\u200b <code>SjmcLiveStatus</code> \u200b\u63d2\u4ef6\u200b\u65f6\u200b\u53ea\u6709\u200b\u4e00\u4e2a\u200b\u76d1\u6d4b\u200b\u5e7f\u64ad\u200bmc\u200b\u793e\u200b\u76f4\u64ad\u95f4\u200b\u72b6\u6001\u200b\uff0c\u200b\u56e0\u6b64\u200b\u4f5c\u8005\u200b\u9009\u7528\u200bthreading.Semaphore\u200b\u6765\u200b\u4fdd\u62a4\u200b\u76d1\u6d4b\u200b\u7ebf\u7a0b\u200b\u5165\u53e3\u200b</p>"},{"location":"plugin/plugins/sjmcPlugin/","title":"SJMC \u200b\u670d\u52a1\u5668\u200b\u72b6\u6001","text":""},{"location":"plugin/plugins/sjmcPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b ShowSjmcStatus StandardPlugin '-sjmc' None \u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200bmc\u200b\u793e\u200b\u670d\u52a1\u5668\u200b\u72b6\u6001"},{"location":"plugin/plugins/sjmcPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; -sjmc\nbot&gt; \u3010sjmc\u200b\u670d\u52a1\u5668\u200b\u72b6\u6001\u200b\u56fe\u7247\u200b\u3011\n</code></pre> <p>sjmc\u200b\u670d\u52a1\u5668\u200b\u72b6\u6001\u200b\u56fe\u7247\u200b\uff1a</p> <p> </p>"},{"location":"plugin/plugins/sjmcPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u5f02\u6b65\u200b\u83b7\u53d6\u4fe1\u606f\u200b</p> <p>\u200b\u4ee5\u4e0b\u200b\u4ee3\u7801\u200b\u4e2d\u200b\u91c7\u7528\u200b\u4e86\u200b\u5f02\u6b65\u200b\u7684\u200b\u4fe1\u606f\u200b\u83b7\u53d6\u200b\u51fd\u6570\u200b <code>aio_get_sjmc_info()</code> \uff0c\u200b\u5e76\u884c\u200b\u83b7\u53d6\u200b\u591a\u4e2a\u200b\u670d\u52a1\u5668\u200b\u4fe1\u606f\u200b\u3002\u200b\u4f46\u200b\u4ecd\u200b\u4fdd\u7559\u200b\u4e86\u200b\u65e7\u7248\u200b\u7684\u200b <code>get_sjmc_info()</code> \u200b\u4ee3\u7801\u200b\u3002</p> <pre><code>from datetime import datetime\nfrom typing import Union, Any\nfrom utils.basicEvent import *\nfrom utils.basicConfigs import *\nfrom utils.standardPlugin import StandardPlugin\nfrom PIL import Image, ImageDraw, ImageFont\nimport requests\nimport base64\nimport re\nimport uuid\nfrom io import BytesIO\nimport aiohttp, asyncio\nclass ShowSjmcStatus(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg == '-sjmc'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, '\u200b\u6b63\u5728\u200b\u83b7\u53d6\u200bsjmc\u200b\u72b6\u6001\u200b...', data['message_type'])\ntry:\nimgPath = draw_sjmc_info(aio_get_sjmc_info())\nimgPath = imgPath if os.path.isabs(imgPath) else os.path.join(ROOT_PATH, imgPath)\nsend(target, '[CQ:image,file=files://%s,id=40000]'%imgPath, data['message_type'])\nexcept BaseException as e:\nsend(target, \"internal error while getting sjmc\", data['message_type'])\nwarning(\"basic exception in ShowSjmcStatus: {}\".format(e))\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'ShowSjmcStatus',\n'description': 'mc\u200b\u670d\u52a1\u5668\u200b\u72b6\u6001\u200b',\n'commandDescription': '-sjmc',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\ndef aio_get_sjmc_info():\nasync def get_page(i):\nurl=f\"https://mc.sjtu.cn/wp-admin/admin-ajax.php?_ajax_nonce=0e441f8c8a&amp;action=fetch_mcserver_status&amp;i={i}\"\nasync with aiohttp.request('GET', url) as req:\nstatus = await req.json()\nreturn i, status\ntasks = [get_page(i) for i in range(8)]\nresult = asyncio.run(asyncio.wait(tasks))\nresult = [r.result() for r in result[0]]\nresult = sorted(result, key=lambda x: x[0])\nresult = [r[1] for r in result]\nreturn result\ndef get_sjmc_info():\nurl=\"https://mc.sjtu.cn/wp-admin/admin-ajax.php\"\ndat = []\nfor t in range(8):\n#try:\nparams={\n\"_ajax_nonce\": \"0e441f8c8a\",\n\"action\": \"fetch_mcserver_status\",\n\"i\": str(t),\n}\ntry:\nres = requests.get(url, verify=False, params=params)\nif res.status_code!= requests.codes.ok:\ncontinue\nres = res.json()\ndat.append(res)\nexcept requests.JSONDecodeError as e:\nwarning(\"sjmc json decode error: {}\".format(e))\nexcept requests.Timeout as e:\nprint(\"connection time out\")\nexcept KeyError as e:\nwarning(\"key error in sjmc: {}\".format(e))\nexcept BaseException as e:\nwarning(\"sjmc basic exception: {}\".format(e))\nreturn dat\ndef draw_sjmc_info(dat):\nj = sum([res['online'] and res['players']['online']!=0 for res in dat])\nj1 = 0\nFONTS_PATH = 'resources/fonts'\nwhite, grey, green, red = (255,255,255,255),(128,128,128,255),(0,255,33,255),(255,85,85,255)\nfont_mc_l = ImageFont.truetype(os.path.join(FONTS_PATH, 'Minecraft AE.ttf'), 30)\nfont_mc_m = ImageFont.truetype(os.path.join(FONTS_PATH, 'Minecraft AE.ttf'), 20)\nfont_mc_s = ImageFont.truetype(os.path.join(FONTS_PATH, 'Minecraft AE.ttf'), 16)\nfont_mc_xl = ImageFont.truetype(os.path.join(FONTS_PATH, 'Minecraft AE.ttf'), 39)\nwidth=860\nheight=215+len(dat)*140+j*35\nimg = Image.new('RGBA', (width, height), (46, 33, 23, 255))\ndraw = ImageDraw.Draw(img)\ndraw.rectangle((0, 120, width, height-80), fill=(15, 11, 7, 255))\ndraw.text((width-460,42), \"SJMC\u200b\u670d\u52a1\u5668\u200b\u72b6\u6001\u200b\", fill=(255,255,255,255), font=font_mc_xl)\ndraw.text((width-120,44), \"LITTLE\\nUNIkeEN\", fill=(255,255,255,255), font=font_syht_m)\nfor i, res in enumerate(dat):\nfy = 160+i*140+j1*31\n# \u200b\u5904\u7406\u200btitle\u200b\u975e\u6cd5\u200b\u5b57\u7b26\u200b\ntry:\ntitle = res['description']\nif not isinstance(title, str):\ntitle = title['text']\ntitle = title.replace('|',' | ',1)\ntitle = title.replace('\\n','  |  ',1)\ntitle = title.replace('\u00a7l','',5)\ntitle = title.replace('\u00a7e','',5)\ntitle = title.replace('\u00a7n','',5)\ntitle = title.replace('\u200b\u670d\u52a1\u5668\u200b\u5df2\u200b\u79bb\u7ebf\u200b...', '')\nexcept:\ntitle = 'Unknown'\n# cop = re.compile(\"[^\\u4e00-\\u9fa5^a-z^A-Z^0-9^|^\\ ^-]\") # \u200b\u6b63\u5219\u200b\u7b5b\u9009\u200b\n# title = cop.sub(\"\", title)\n# draw icon\ntry:\nicon_url = res['favicon']\nif icon_url[:4]==\"data\":\nimg_avatar = Image.open(decode_image(icon_url)).resize((80,80))\nimg.paste(img_avatar, (60, fy))\nelse:\nurl_avatar = requests.get(icon_url)\nif url_avatar.status_code != requests.codes.ok:\nimg_avatar = None\nelse:\nimg_avatar = Image.open(BytesIO(url_avatar.content)).resize((80,80))\nimg.paste(img_avatar, (60, fy))\nexcept KeyError as e:\nwarning(\"key error in sjmc draw icon: {}\".format(e))\nexcept BaseException as e:\nwarning(\"base exception in sjmc draw icon: {}\".format(e))\nnew_title=\"\"\nm=0\nwhile True:\nif title[m]=='\u00a7':\nm+=2\nnew_title+=title[m]\nm+=1\nif m&gt;=len(title):\nbreak\nif res['online']:\nres['hostname'] = res['hostname'].replace('.',' . ')\ndraw.text((160, fy), new_title, fill=white, font=font_mc_l)\nif res['online']:\ndraw.text((160, fy+45), res['hostname'], fill=grey, font=font_mc_m)\ntxt_size = draw.textsize(f\"{res['ping']}ms\", font=font_mc_m)\nping = int(res['ping'])\nclr = red if ping&gt;=100 else green\ndraw.text((width-60-txt_size[0], fy), f\"{res['ping']}ms\", fill=clr, font=font_mc_m)\ntxt_size = draw.textsize(f\"{res['players']['online']}/{res['players']['max']}\", font=font_mc_m)\ndraw.text((width-60-txt_size[0], fy+32), f\"{res['players']['online']}/{res['players']['max']}\", fill=grey, font=font_mc_m)\ntxt_size = draw.textsize(res['version'], font=font_mc_m)\ndraw.text((width-60-txt_size[0], fy+64), res['version'], fill=grey, font=font_mc_m)\nif res['players']['online']!=0:\nj1 += 1\ntxt_plr = \"\"\ntry:\nfor player in res['players']['sample']:\nif draw.textsize(txt_plr+player['name']+'\u3001',font=font_mc_s)[0]&gt;= width-300:\ntxt_plr = txt_plr[:-1]+'\u200b\u7b49\u200b '\nbreak\ntxt_plr += (player['name']+'\u3001')\ntxt_plr = txt_plr[:-1]+' \u200b\u6b63\u5728\u200b\u6e38\u73a9\u200b'\nexcept:\ntxt_plr = '( \u200b\u73a9\u5bb6\u200b\u4fe1\u606f\u200b\u83b7\u53d6\u200b\u5931\u8d25\u200bqwq )'\ntxt_size = draw.textsize(txt_plr, font=font_mc_s)\ntxt_size_2 = draw.textsize('\u25cf', font=font_mc_s)\ndraw.text((width-68-txt_size[0]-txt_size_2[0], fy+96), txt_plr, fill=grey, font=font_mc_s)\ndraw.text((width-60-txt_size_2[0], fy+96), '\u25cf', fill=green, font=font_mc_s)\nelse:\ntxt_size = draw.textsize(\"offline\", font=font_mc_m)\ndraw.text((width-60-txt_size[0], fy), \"offline\", fill=red, font=font_mc_m)\ntxt_size = draw.textsize(\"\u200b\u670d\u52a1\u5668\u200b\u79bb\u7ebf\u200b\", font=font_mc_m)\ndraw.text((width-60-txt_size[0], fy+32), \"\u200b\u670d\u52a1\u5668\u200b\u79bb\u7ebf\u200b\", fill=grey, font=font_mc_m)\ndraw.text((60,height-50),\"\u200b\u6b22\u8fce\u200b\u52a0\u5165\u200bSJTU-Minecraft\u200b\u4ea4\u6d41\u200b\u7fa4\u200b\uff01\u200b\u7fa4\u53f7\u200b 712514518\",fill=white,font=font_mc_m)\nsave_path=os.path.join(SAVE_TMP_PATH,'sjmc_status.png')\nimg.save(save_path)\nreturn save_path\ndef decode_image(src):\n\"\"\"\n    \u200b\u89e3\u7801\u200b\u56fe\u7247\u200b\n    :param src: \u200b\u56fe\u7247\u200b\u7f16\u7801\u200b\n        eg:\n            src=\"data:image/gif;base64,R0lGODlhMwAxAIAAAAAAAP///\n                yH5BAAAAAAALAAAAAAzADEAAAK8jI+pBr0PowytzotTtbm/DTqQ6C3hGX\n                ElcraA9jIr66ozVpM3nseUvYP1UEHF0FUUHkNJxhLZfEJNvol06tzwrgd\n                LbXsFZYmSMPnHLB+zNJFbq15+SOf50+6rG7lKOjwV1ibGdhHYRVYVJ9Wn\n                k2HWtLdIWMSH9lfyODZoZTb4xdnpxQSEF9oyOWIqp6gaI9pI1Qo7BijbF\n                ZkoaAtEeiiLeKn72xM7vMZofJy8zJys2UxsCT3kO229LH1tXAAAOw==\"\n    :return: \u200b\u56fe\u7247\u200b\u7684\u200bBytesIO\n    \"\"\"\n# 1\u3001\u200b\u4fe1\u606f\u63d0\u53d6\u200b\nresult = re.search(\"data:image/(?P&lt;ext&gt;.*?);base64,(?P&lt;data&gt;.*)\", src, re.DOTALL)\nif result:\next = result.groupdict().get(\"ext\")\ndata = result.groupdict().get(\"data\")\nelse:\nraise Exception(\"base64 image decode error\")\n# 2\u3001base64\u200b\u89e3\u7801\u200b\nreturn BytesIO(base64.urlsafe_b64decode(data))\n</code></pre>"},{"location":"plugin/plugins/sjtuClassroomPlugin/","title":"SJTU \u200b\u6559\u5ba4\u200b\u67e5\u8be2","text":""},{"location":"plugin/plugins/sjtuClassroomPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b SjtuClassroom StandardPlugin '\u200b\u6559\u5ba4\u200b [\u200b\u4e1c\u200b\u4e0a\u9662\u200b102/\u200b\u4e1c\u4e2d\u200b1-105/...]' None \u200b\u6559\u5ba4\u200b\u67e5\u8be2\u200b SjtuClassroomRecommend StandardPlugin '\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b' None \u200b\u81ea\u4e60\u200b\u6559\u5ba4\u200b\u63a8\u8350"},{"location":"plugin/plugins/sjtuClassroomPlugin/#2","title":"2. \u200b\u6837\u4f8b\u200b\u5206\u6790","text":"<pre><code>111&gt; \u200b\u6559\u5ba4\u200b \u200b\u4e1c\u4e0b\u200b215\nbot&gt;\u3010\u200b\u6559\u5ba4\u200b\u4fe1\u606f\u200b\u56fe\u7247\u200b\u3011\n\n222&gt; \u200b\u6559\u5ba4\u200b \u200b\u4e1c\u4e2d\u200b102\nbot&gt; \u200b\u6559\u5ba4\u200b\u53c2\u6570\u200b\u89e3\u6790\u200b\u9519\u8bef\u200b\uff0c\u200b\u8bf7\u91cd\u200b\u66f4\u65b0\u200b\u8f93\u5165\u200b\u67e5\u8be2\u200b\u53c2\u6570\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a\n\"\u200b\u6559\u5ba4\u200b \u200b\u4e1c\u200b\u4e0a\u200b105\"\u3001\"\u200b\u6559\u5ba4\u200b \u200b\u4e1c\u200b\u4e0b\u9662\u200b311\"\u3001\"\u200b\u6559\u5ba4\u200b \u200b\u4e1c\u4e2d\u200b1-102\"\n\n333&gt; \u200b\u6559\u5ba4\u200b \u200b\u4e1c\u4e2d\u200b1-102\nbot&gt; \u3010\u200b\u56de\u590d\u200b\u4e0a\u6587\u200b\u3011\u200b\u672a\u200b\u67e5\u8be2\u200b\u5230\u200b\u6559\u5ba4\u200b\u4fe1\u606f\u200b\uff0c\u200b\u53ef\u80fd\u200b\u7ed3\u679c\u200b\u662f\u200b\uff1a\u200b\u4e0d\u200b\u5b58\u5728\u200b\u8be5\u200b\u6559\u5ba4\u200b\n\n444&gt; \u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b\nbot&gt; \u3010\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b\u56fe\u7247\u200b\u3011\n</code></pre> <p>\u200b\u6559\u5ba4\u200b\u4fe1\u606f\u200b\u56fe\u7247\u200b\uff1a </p> <p>\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b\u56fe\u7247\u200b\uff1a </p>"},{"location":"plugin/plugins/sjtuClassroomPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/sjtuClassroom.py</code></p> <pre><code>headers = {\n\"Accept\": \"application/json, text/javascript, */*; q=0.01\",\n\"Accept-Encoding\": \"gzip, deflate, br\",\n\"Accept-Language\": \"zh-CN,zh;q=0.9\",\n\"Connection\": \"keep-alive\",\n\"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\",\n\"Host\": \"ids.sjtu.edu.cn\",\n\"Origin\": \"https://ids.sjtu.edu.cn\",\n\"Referer\": \"https://ids.sjtu.edu.cn/classroomUse/goPage?param=00f9e7d21b8915f2595bcf4c5e83d41e5fa0251ff700451747b9ebe10b033327\",\n\"Sec-Fetch-Dest\": \"empty\",\n\"Sec-Fetch-Mode\": \"cors\",\n\"Sec-Fetch-Site\": \"same-origin\",\n\"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\",\n\"X-Requested-With\": \"XMLHttpRequest\",\n'sec-ch-ua': '\"Not_A Brand\";v=\"99\", \"Google Chrome\";v=\"109\", \"Chromium\";v=\"109\"',\n\"sec-ch-ua-mobile\": \"?0\",\n'sec-ch-ua-platform': '\"Windows\"',\n}\ndef getSjtuBuilding(building:str)-&gt;Optional[Any]:\n\"\"\"\u200b\u83b7\u53d6\u200b\u6559\u5ba4\u200b\u4fe1\u606f\u200b\uff08\u200b\u6e29\u5ea6\u200b\u3001\u200b\u6e7f\u5ea6\u200b\u3001\u200b\u4eba\u6570\u200b\u3001PM2.5\u200b\u7b49\u200b\uff09\n    @building: \u200b\u6559\u5b66\u697c\u200b[\u200b\u4e0a\u9662\u200b/\u200b\u4e2d\u9662\u200b/...]\n    \"\"\"\nurl = 'https://ids.sjtu.edu.cn/classroomUse/findSchoolCourseInfo'\ndatas = {\n'\u200b\u4e0a\u9662\u200b': 'buildId=126',\n'\u200b\u4e2d\u9662\u200b': 'buildId=128',\n'\u200b\u4e0b\u9662\u200b': 'buildId=127',\n'\u200b\u4e1c\u200b\u4e0a\u9662\u200b': 'buildId=122',\n'\u200b\u4e1c\u200b\u4e2d\u9662\u200b': 'buildId=564',\n'\u200b\u4e1c\u200b\u4e0b\u9662\u200b': 'buildId=124',\n'\u200b\u9648\u745e\u7403\u697c\u200b': 'buildId=125',\n}\ndata = datas[building]\nsession = requests.session()\nsession.get(url)\nsession.get(\"https://jaccount.sjtu.edu.cn\")\nreq = session.post(url=url, headers=headers, data=data)\nif req.status_code != requests.codes.ok:\nwarning(\"sjtu classroom API failed!\")\nreturn None\ntry:\nresult = req.json()\nif result['code'] != 200:\nwarning(\"code != 200, sjtu classroom API failed in getSjtuBuilding\")\nreturn None\nreturn result['data']\nexcept requests.JSONDecodeError as e:\nwarning('json decode error while getting sjtu classroom: {}'.format(e))\nexcept BaseException as e:\nwarning('base exception while getting sjtu classroom: {}'.format(e))\nreturn None\ndef getRoomCourse(building:str, targetDate:datetime.date)-&gt;Optional[Any]:\nurl = 'https://ids.sjtu.edu.cn/build/findBuildRoomType'\npayload = {\n'\u200b\u4e0a\u9662\u200b': 'buildId=126',\n'\u200b\u4e2d\u9662\u200b': 'buildId=128',\n'\u200b\u4e0b\u9662\u200b': 'buildId=127',\n'\u200b\u4e1c\u200b\u4e0a\u9662\u200b': 'buildId=122',\n'\u200b\u4e1c\u200b\u4e2d\u9662\u200b': 'buildId=564',\n'\u200b\u4e1c\u200b\u4e0b\u9662\u200b': 'buildId=124',\n'\u200b\u9648\u745e\u7403\u697c\u200b': 'buildId=125',\n}[building] + targetDate.strftime('&amp;courseDate=%Y-%m-%d')\ntry:\nresult = requests.post(url=url, headers=headers, data=payload).json()\nif result['code'] != 200:\nwarning(\"code != 200, sjtu classroom API failed in getRoomCourse\")\nreturn None\nreturn result['data']\nexcept BaseException as e:\nwarning('base exception in getRoomCourse: {}'.format(e))\nreturn None\ndef getRoomDate()-&gt;Optional[Any]:\nurl = 'https://ids.sjtu.edu.cn/course/findCurSemester'\ntry:\nresult = requests.post(url=url, headers=headers).json()\nif result['code'] != 200:\nwarning(\"code != 200, sjtu classroom API failed in getRoomDate\")\nreturn None\nreturn result['data']\nexcept BaseException as e:\nwarning('base exception in getRoomDate: {}'.format(e))\nreturn None\ndef standarlizingRoomStr(roomStr:str)-&gt;Optional[Tuple[str, str]]:\n\"\"\"\n    \u200b\u4e1c\u200b\u4e0a\u200b103 =&gt; (\u200b\u4e1c\u200b\u4e0a\u9662\u200b, \u200b\u4e1c\u200b\u4e0a\u9662\u200b103)\n    \u200b\u4e1c\u4e2d\u200b1-105 =&gt; (\u200b\u4e1c\u200b\u4e2d\u9662\u200b, \u200b\u4e1c\u200b\u4e2d\u9662\u200b1-105)\n    \u200b\u4f60\u597d\u200b =&gt; None\n    \"\"\"\npattern1 = re.compile(r'^(\u200b\u4e0a\u200b|\u200b\u4e2d\u200b|\u200b\u4e0b\u200b|\u200b\u4e1c\u200b\u4e0a\u200b|\u200b\u4e1c\u4e0b\u200b)\u200b\u9662\u200b?\\s*(\\d{3})$')\nif pattern1.match(roomStr) != None:\nbuilding, roomCode = pattern1.findall(roomStr)[0]\nbuilding += '\u200b\u9662\u200b'\nreturn building, building + roomCode\npattern2 = re.compile(r'^\u200b\u4e1c\u4e2d\u200b(\u200b\u9662\u200b?\\s*)(\\d\\-\\d{3})$')\nif pattern2.match(roomStr) != None:\nbuilding = '\u200b\u4e1c\u200b\u4e2d\u9662\u200b'\n_, roomCode = pattern2.findall(roomStr)[0]\nreturn building, building+roomCode\nreturn None\ndef getWeekDay(targetDate:datetime.date)-&gt;str:\nreturn '\u200b\u661f\u671f\u200b' + ['\u200b\u4e00\u200b','\u200b\u4e8c\u200b','\u200b\u4e09\u200b','\u200b\u56db\u200b','\u200b\u4e94\u200b','\u200b\u516d\u200b','\u200b\u65e5\u200b'][targetDate.weekday()]\ndef getRoomInfo(building:str, room_name:str)-&gt;Optional[str]:\ntoday = datetime.date.today()\n# 1. get building info\nbuildingInfo = getSjtuBuilding(building)\nif buildingInfo == None: return None\ntry:\nbuildingInfo = {room['name']: room for room in buildingInfo['roomList']} \nexcept BaseException as e:\nwarning('base exception in getRoomInfo-buildingInfo: {}'.format(e))\nreturn None\n# 2. get building course\nbuildingCourse = getRoomCourse(building, today)\nif buildingCourse == None: return None\ntry:\nbuildingCourse = {room['name']: room for floor in buildingCourse['floorList'] for room in floor['children'] }\nexcept BaseException as e:\nwarning('base exception in getRoomInfo-buildingCourse: {}'.format(e))\nreturn None\n# print(buildingCourse)\n# 3. select room\nbuildingInfo = buildingInfo.get(room_name, None)\nbuildingCourse = buildingCourse.get(room_name, None)\nif buildingInfo == None or buildingCourse == None:\nreturn None\n# 4. draw picture\nrimg = ResponseImage(\ntitle='\u200b\u6559\u5ba4\u200b\u4fe1\u606f\u200b', \ntitleColor=Colors.PALETTE_SJTU_RED, \nprimaryColor=Colors.PALETTE_SJTU_RED, \nfooter=datetime.datetime.now().strftime(\"update at %Y-%m-%d %H:%M\"),\nlayout='normal'\n)\ninfoCard = [\n('title', room_name),\n('separator',),\n('body', f\"\u200b\u662f\u5426\u200b\u7a7a\u95f2\u200b\uff1a{buildingInfo.get('free_room', '--')}\\n\"\nf\"\u200b\u5ea7\u4f4d\u6570\u200b\uff1a{buildingInfo.get('zws', '--')}\\n\"\nf\"\u200b\u6e29\u5ea6\u200b\uff1a{buildingInfo.get('sensorTemp', '--')}\u2103\\n\"\nf\"\u200b\u6e7f\u5ea6\u200b\uff1a{buildingInfo.get('sensorHum', '--')}%\\n\"\nf\"CO2\uff1a{buildingInfo.get('sensorCo2', '--')}\\n\"\nf\"PM2.5\uff1a{buildingInfo.get('sensorPm25', '--')}\")\n]\nrimg.addCard(ResponseImage.RichContentCard(raw_content=infoCard, ))\ncourseCard = [('title', '\u200b\u6559\u5ba4\u200b\u8bfe\u7a0b\u200b - %s'%getWeekDay(today))]\nwa = True # warning only once\nfor course in buildingCourse.get('roomCourseList',[]):\ntry:\nsjly = course['sjly']\ncourseName = course['courseName']\nteacherName = course['teacherName']\norgName = course.get('orgName', None)\nstartSection = course['startSection']\nendSection = course['endSection']\nstartWeek = course['startWeek']\nendWeek = course['endWeek']\ncourseTxt = f'\u3010{sjly}\u3011{courseName}  {teacherName}\\n' \\\n                        f'{startSection}-{endSection}\u200b\u8282\u200b  {startWeek}-{endWeek}\u200b\u5468\u200b\\n'\nif orgName != None: courseTxt += orgName\n# print(courseTxt)\ncourseCard.append(('separator', ))\ncourseCard.append(('body', courseTxt))\nexcept BaseException as e:\nif wa:\nwarning('base exception in getRoomInfo: {}'.format(e))\nwa = False    \nrimg.addCard(ResponseImage.RichContentCard(raw_content=courseCard, ))\nsavePath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'course.png')\nrimg.generateImage(savePath)\nreturn savePath\ndef getRoomRecommend():\n# get room recommend info\ntoday = datetime.date.today()\ndate = getRoomDate()\nsection = date['section']\nbuildings = ['\u200b\u4e0a\u9662\u200b','\u200b\u4e2d\u9662\u200b','\u200b\u4e0b\u9662\u200b','\u200b\u4e1c\u200b\u4e0b\u9662\u200b','\u200b\u4e1c\u200b\u4e2d\u9662\u200b']\nrecommendDict = {}\nfor building in buildings:\n# 2.get room info pre\nbuildingInfo = getSjtuBuilding(building)\nif buildingInfo == None: return None\ntry:\nbuildingInfo = {room['name']: room for room in buildingInfo['roomList']} \nexcept BaseException as e:\nwarning('base exception in getRoomInfo-buildingInfo: {}'.format(e))\nreturn None\n# 3.get room course\nbuildingCourse = getRoomCourse(building, today)\nif buildingCourse == None: return None\ntry:\nbuildingCourse = {room['name']: room for floor in buildingCourse['floorList'] for room in floor['children'] }\nexcept BaseException as e:\nwarning('base exception in getRoomRecommend-buildingCourse: {}'.format(e))\nreturn None\nfor room_name in buildingCourse.keys():\n# print(room_name)\nflag = True # judge if there is class\nEndSection = 0\ngetBuildingCourse = buildingCourse.get(room_name, None)\ngetBuildingInfo = buildingInfo.get(room_name, None)\nif getBuildingInfo == None or getBuildingCourse == None:\nreturn None\nfor course in getBuildingCourse.get('roomCourseList',[]):\nendSection = course['endSection']\nif(EndSection &lt; endSection):EndSection = endSection\nif (endSection &gt; section):\nflag = False\nbreak\nif flag:\nroomInfo = {}\nroomInfo['endSection']=EndSection\nroomInfo['CO2']=getBuildingInfo.get('sensorCo2', '--')\nroomInfo['Temp']=getBuildingInfo.get('sensorTemp', '--')\nroomInfo['Hum']=getBuildingInfo.get('sensorHum', '--')\nrecommendDict[room_name] = roomInfo\n# 2.draw picture\nrimg = ResponseImage(\ntitle='\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b', \ntitleColor=Colors.PALETTE_SJTU_RED, \nprimaryColor=Colors.PALETTE_SJTU_RED, \nfooter=datetime.datetime.now().strftime(\"update at %Y-%m-%d %H:%M\"),\nlayout='normal'\n)\nrecommendCard = [('title', '\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b - %s'%getWeekDay(today))]\n# print(recommendDict)\nmatchPattern = re.compile(r'^(\u200b\u4e0a\u9662\u200b|\u200b\u4e2d\u9662\u200b|\u200b\u4e0b\u9662\u200b)')\nif(len(recommendDict)&gt;25):\ncount = 0\nfor room_name,roomInfo in recommendDict.items():\nif(matchPattern.match(room_name)):\ncontinue\nif(count&gt;25):break\ntry:\nif(roomInfo['endSection']==0):\nrecommendTxt = f\"\u200b\u7a7a\u95f2\u200b\u6559\u5ba4\u200b\uff1a{room_name}  \u200b\u672c\u65e5\u200b\u8be5\u200b\u6559\u5ba4\u200b\u65e0\u8bfe\u200b\\n\" \\\n                                f\"\u200b\u672c\u200b\u6559\u5ba4\u200b\u5f53\u524d\u200b\u6e29\u5ea6\u200b\u4e3a\u200b\uff1a{roomInfo['Temp']}\u2103 \uff0c\u200b\u6e7f\u5ea6\u200b\u4e3a\u200b\uff1a{roomInfo['Hum']}% \uff0cCO2\u200b\u6d53\u5ea6\u200b\u4e3a\u200b{roomInfo['CO2']}\\n\"\nelse:\nrecommendTxt = f\"\u200b\u7a7a\u95f2\u200b\u6559\u5ba4\u200b\uff1a{room_name}  \u200b\u672c\u200b\u65e5\u200b\u6700\u540e\u200b\u4e00\u8282\u8bfe\u200b\u4e3a\u200b\u7b2c\u200b{roomInfo['endSection']}\u200b\u8282\u200b\\n\" \\\n                                f\"\u200b\u672c\u200b\u6559\u5ba4\u200b\u5f53\u524d\u200b\u6e29\u5ea6\u200b\u4e3a\u200b\uff1a{roomInfo['Temp']}\u2103 \uff0c\u200b\u6e7f\u5ea6\u200b\u4e3a\u200b\uff1a{roomInfo['Hum']}% \uff0cCO2\u200b\u6d53\u5ea6\u200b\u4e3a\u200b{roomInfo['CO2']}\\n\"\nrecommendCard.append(('separator', ))\nrecommendCard.append(('body', recommendTxt))\nexcept BaseException as e:\nwarning('base exception in getRoomRecommend: {}'.format(e))\ncount += 1\nelse:\nfor room_name,endSection in recommendDict.items():\ntry:\nif(roomInfo['endSection']==0):\nrecommendTxt = f\"\u200b\u7a7a\u95f2\u200b\u6559\u5ba4\u200b\uff1a{room_name}  \u200b\u672c\u65e5\u200b\u8be5\u200b\u6559\u5ba4\u200b\u65e0\u8bfe\u200b\\n\" \\\n                                f\"\u200b\u672c\u200b\u6559\u5ba4\u200b\u5f53\u524d\u200b\u6e29\u5ea6\u200b\u4e3a\u200b\uff1a{roomInfo['Temp']}\u2103 \uff0c\u200b\u6e7f\u5ea6\u200b\u4e3a\u200b\uff1a{roomInfo['Hum']}% \uff0cCO2\u200b\u6d53\u5ea6\u200b\u4e3a\u200b{roomInfo['CO2']}\\n\"\nelse:\nrecommendTxt = f\"\u200b\u7a7a\u95f2\u200b\u6559\u5ba4\u200b\uff1a{room_name}  \u200b\u672c\u200b\u65e5\u200b\u6700\u540e\u200b\u4e00\u8282\u8bfe\u200b\u4e3a\u200b\u7b2c\u200b{roomInfo['endSection']}\u200b\u8282\u200b\\n\" \\\n                                f\"\u200b\u672c\u200b\u6559\u5ba4\u200b\u5f53\u524d\u200b\u6e29\u5ea6\u200b\u4e3a\u200b\uff1a{roomInfo['Temp']}\u2103 \uff0c\u200b\u6e7f\u5ea6\u200b\u4e3a\u200b\uff1a{roomInfo['Hum']}% \uff0cCO2\u200b\u6d53\u5ea6\u200b\u4e3a\u200b{roomInfo['CO2']}\\n\"\nrecommendCard.append(('separator', ))\nrecommendCard.append(('body', recommendTxt))\nexcept BaseException as e:\nwarning('base exception in getRoomRecommend: {}'.format(e))\nrimg.addCard(ResponseImage.RichContentCard(raw_content=recommendCard, ))\nsavePath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'RoomRecommend.png')\nrimg.generateImage(savePath)\nreturn savePath\nclass SjtuClassroom(StandardPlugin):\ndef __init__(self) -&gt; None:\nself.triggerPattern = re.compile(r'^(\u200b\u6559\u5ba4\u200b|\u200b\u6559\u5ba4\u200b\u67e5\u8be2\u200b)\\s+(.*)$')\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn self.triggerPattern.match(msg) != None\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\n_, roomStr = self.triggerPattern.findall(msg)[0]\nresult = standarlizingRoomStr(roomStr)\nif result == None:\nsend(target, '\u200b\u6559\u5ba4\u200b\u53c2\u6570\u200b\u89e3\u6790\u200b\u9519\u8bef\u200b\uff0c\u200b\u8bf7\u91cd\u200b\u66f4\u65b0\u200b\u8f93\u5165\u200b\u67e5\u8be2\u200b\u53c2\u6570\u200b\uff0c\u200b\u4f8b\u5982\u200b\uff1a\\n\"\u200b\u6559\u5ba4\u200b \u200b\u4e1c\u200b\u4e0a\u200b105\"\u3001\"\u200b\u6559\u5ba4\u200b \u200b\u4e1c\u200b\u4e0b\u9662\u200b311\"\u3001\"\u200b\u6559\u5ba4\u200b \u200b\u4e1c\u4e2d\u200b1-102\"', data['message_type'])\nreturn \"OK\"\nbuilding, room_name = result\ncourseImgPath = getRoomInfo(building, room_name)\nif courseImgPath == None:\nsend(target, f'[CQ:reply,id={data[\"message_id\"]}]\u200b\u672a\u200b\u67e5\u8be2\u200b\u5230\u200b\u6559\u5ba4\u200b\u4fe1\u606f\u200b\uff0c\u200b\u53ef\u80fd\u200b\u7ed3\u679c\u200b\u662f\u200b\uff1a\u200b\u4e0d\u200b\u5b58\u5728\u200b\u8be5\u200b\u6559\u5ba4\u200b', data['message_type'])\nelse:\nsend(target, '[CQ:image,file=file://%s]'%courseImgPath, data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'SjtuClassroom',\n'description': '\u200b\u6559\u5ba4\u200b\u67e5\u8be2\u200b',\n'commandDescription': '\u200b\u6559\u5ba4\u200b [\u200b\u4e1c\u200b\u4e0a\u9662\u200b102/\u200b\u4e1c\u4e2d\u200b1-105/...]',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass SjtuClassroomRecommend(StandardPlugin):\ndef __init__(self) -&gt; None:\nself.triggerPattern = re.compile(r'\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b')\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn self.triggerPattern.match(msg) != None\ndef executeEvent(self,msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\ncourseImgPath = getRoomRecommend()\nif courseImgPath == None:\nsend(target, f'[CQ:reply,id={data[\"message_id\"]}]\u200b\u672a\u200b\u67e5\u8be2\u200b\u5230\u200b\u6559\u5ba4\u200b\u4fe1\u606f\u200b\uff0c\u200b\u53ef\u80fd\u200b\u7ed3\u679c\u200b\u662f\u200b\uff1a\u200b\u4e0d\u200b\u5b58\u5728\u200b\u7a7a\u95f2\u200b\u6559\u5ba4\u200b', data['message_type'])\nelse:\nsend(target, '[CQ:image,file=file://%s]'%courseImgPath, data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'SjtuClassroomRecommend',\n'description': '\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b',\n'commandDescription': '\u200b\u6559\u5ba4\u200b\u63a8\u8350\u200b',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/sjtuDektPlugin/","title":"SJTU \u200b\u7b2c\u4e8c\u8bfe\u5802","text":""},{"location":"plugin/plugins/sjtuDektPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b SjtuDekt StandardPlugin '-dekt' None \u200b\u83b7\u53d6\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u6700\u65b0\u200b\u6d3b\u52a8\u200b\u5217\u8868\u200b SjtuDektMonitor StandardPlugin  CronStandardPlugin <code>None</code> None \u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u72b6\u6001\u200b\u66f4\u65b0\u200b\u5e7f\u64ad"},{"location":"plugin/plugins/sjtuDektPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; -dekt\nbot&gt; \u3010\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u6700\u65b0\u200b\u6d3b\u52a8\u200b\u56fe\u7247\u200b\u3011\n\n\u200b\u68c0\u6d4b\u200b\u5230\u200b\u6d3b\u52a8\u200b\u5217\u8868\u200b\u66f4\u65b0\u200b\nbot&gt; \u200b\u5df2\u200b\u53d1\u73b0\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u6d3b\u52a8\u200b\u66f4\u65b0\u200b:\u3010\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u6700\u65b0\u200b\u6d3b\u52a8\u200b\u56fe\u7247\u200b\u3011\n</code></pre> <p>\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u6700\u65b0\u200b\u6d3b\u52a8\u200b\u56fe\u7247\u200b\uff1a</p> <p></p>"},{"location":"plugin/plugins/sjtuDektPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u4f7f\u7528\u200b selenium \u200b\u8fdb\u884c\u200b\u6a21\u62df\u200b\u767b\u5f55\u200b\u3001\u200b\u83b7\u53d6\u200b\u6d3b\u52a8\u200b\u5217\u8868\u200b\uff0c\u200b\u83b7\u53d6\u200b\u7ed3\u679c\u200b\u5e76\u200b\u5728\u200b <code>data/dektSource</code> \u200b\u4e2d\u4ee5\u200b JSON \u200b\u5f62\u5f0f\u200b\u5b58\u50a8\u200b\uff0c\u200b\u6bcf\u6b21\u200b\u54cd\u5e94\u200b <code>-dekt</code> \u200b\u547d\u4ee4\u200b\u65f6\u200b\u4e0d\u200b\u76f4\u63a5\u200b\u5411\u200b\u670d\u52a1\u5668\u200b\u8bf7\u6c42\u200b\uff0c\u200b\u800c\u662f\u200b\u4ece\u200b\u4fdd\u5b58\u200b\u7684\u200b JSON \u200b\u6570\u636e\u200b\u4e2d\u200b\u9009\u62e9\u200b\u6700\u65b0\u200b\u7684\u200b\u8fd4\u56de\u200b\u3002</p> <p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u5de5\u5177\u200b\u4f9d\u8d56\u200b</p> <p>\u200b\u4f7f\u7528\u200b\u6b64\u200b\u63d2\u4ef6\u200b\u524d\u200b\uff0c\u200b\u60a8\u200b\u9700\u8981\u200b\u989d\u5916\u200b\u5b89\u88c5\u200b selenium \u200b\u7684\u200b\u9a71\u52a8\u5668\u200b\uff08\u200b\u65e0\u5934\u200b\u6d4f\u89c8\u5668\u200b\uff0c\u200b\u7528\u4ee5\u200b\u6a21\u62df\u200b\u767b\u5f55\u200b\uff09\u200b\u548c\u200b browsermob-proxy \u200b\u4ee3\u7406\u200b\uff08\u200b\u7528\u4e8e\u200b\u622a\u83b7\u200b\u6570\u636e\u5305\u200b\uff09</p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u65e7\u200b\u7684\u200b\u7ed8\u56fe\u200b\u4ee3\u7801\u200b</p> <p>\u200b\u8fd9\u662f\u200b\u65e9\u671f\u200b\u5b8c\u6210\u200b\u7684\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u7ed8\u56fe\u200b\u90e8\u5206\u200b\u4ee3\u7801\u200b\u5e76\u672a\u200b\u4f7f\u7528\u200b\u63a8\u8350\u200b\u7684\u200b responseImage \u200b\u5e93\u200b</p> <pre><code>import os, os.path\nimport json\nimport time\nfrom datetime import datetime\nfrom typing import Union, Any\nfrom utils.basicEvent import *\nfrom utils.basicConfigs import *\nfrom utils.standardPlugin import StandardPlugin, CronStandardPlugin\nfrom PIL import Image, ImageDraw, ImageFont\nfrom io import BytesIO\nfrom selenium import webdriver\nfrom selenium.webdriver import ChromeOptions\nfrom browsermobproxy import Server\nfrom threading import Timer, Semaphore\nDEKT_SOURCE_DIR = os.path.join(ROOT_PATH, 'data/dektSource/')\ndef DownloadActlist():\nserver = Server('/home/ubuntu/dektFetcher/browsermob-proxy-2.1.4/bin/browsermob-proxy')\nserver.start()\nproxy = server.create_proxy()\nedgeOptions = ChromeOptions()\nedgeOptions.add_argument('ignore-certificate-errors')\nedgeOptions.add_argument('--headless')\nedgeOptions.add_argument(f'--proxy-server={proxy.proxy}')\nproxy.new_har(\"dekt\", options={'captureHeaders': True, 'captureContent': True})\ndef parseCookie(cookieStr: str):\ncookies = []\ncookieStr = cookieStr.split(';')\nfor cookie in cookieStr:\ncookie = cookie.strip().split('=')\ncookies.append({\n'domain': '.sjtu.edu.cn',\n'httpOnly': False,\n'name': cookie[0],\n'path': '/',\n'secure': False,\n'value': cookie[1]\n})\nreturn cookies\ndriver=webdriver.Chrome(options=edgeOptions)\ndriver.get(\"https://jaccount.sjtu.edu.cn\")\ntime.sleep(5)\ncookies = parseCookie(JAC_COOKIE)\nfor cookie in cookies:\nif 'expiry' in cookie:\ndel cookie['expiry']\ndriver.add_cookie(cookie)\ndriver.get(\"https://dekt.sjtu.edu.cn/h5/\")\ntime.sleep(3)\nresult = proxy.har\n#print(result)\nfor entry in result['log']['entries']:\n_url = entry['request']['url']\n# \u200b\u6839\u636e\u200bURL\u200b\u627e\u5230\u200b\u6570\u636e\u200b\u63a5\u53e3\u200b\nif \"api/wmt/secondclass/fmGetNewestActivityList\" in _url:\n_response = entry['response']\n_content = _response['content']['text']\n# \u200b\u83b7\u53d6\u200b\u63a5\u53e3\u200b\u8fd4\u56de\u200b\u5185\u5bb9\u200b\nwith open(os.path.join(DEKT_SOURCE_DIR, \"dekt-%s.json\"%datetime.now().strftime(\"%Y-%m-%d-%H%M%S\")), \"w\") as f:\nf.write(_content)\nserver.stop()\ndriver.close()\ndriver.quit()\nos.system(\"kill `ps -ef | grep browsermob | awk 'NR==1{print $2}'`\")\nclass SjtuDektMonitor(StandardPlugin, CronStandardPlugin):\nmonitorSemaphore = Semaphore()\ndef __init__(self) -&gt; None:\nif SjtuDektMonitor.monitorSemaphore.acquire(blocking=False):\nself.start(10, 1790)\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn False\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nreturn \"OK\"\ndef tick(self) -&gt; None:\nDownloadActlist()\nfileName=sorted(os.listdir(DEKT_SOURCE_DIR))[-2:]\nif len(fileName) &lt; 2:\nreturn\ntry:\ndata_1 = json.load(open(os.path.join(DEKT_SOURCE_DIR, fileName[0]), 'r'))\ndata_2 = json.load(open(os.path.join(DEKT_SOURCE_DIR, fileName[1]), 'r'))\nif data_1['data'][0]['id'] != data_2['data'][0]['id']:\npicPath = NewActlistPic()\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\nfor group_id in getPluginEnabledGroups('dekt'):\nsend(group_id, f'\u200b\u5df2\u200b\u53d1\u73b0\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u6d3b\u52a8\u200b\u66f4\u65b0\u200b:[CQ:image,file=files://{picPath},id=40000]')\nexcept json.JSONDecodeError as e:\nwarning(\"dekt json parse error {}\".format(e))\nexcept KeyError as e:\nwarning(\"dekt key error: {}\".format(e))\nexcept BaseException as e:\nwarning(\"dekt error: {}\".format(e))\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'SjtuDektMonitor',\n'description': '\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u66f4\u65b0\u200b\u5e7f\u64ad\u200b',\n'commandDescription': 'None',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.4',\n'author': 'Unicorn',\n}\nclass SjtuDekt(StandardPlugin): \ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg == '-dekt'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\npicPath = NewActlistPic()\npicPath = picPath if os.path.isabs(picPath) else os.path.join(ROOT_PATH, picPath)\nsend(target, '[CQ:image,file=files://%s,id=40000]'%(picPath), data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'SjtuDekt',\n'description': '\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b',\n'commandDescription': '-dekt',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\ndef Timestamp2time(timestp):\ntime_local = time.localtime(float(timestp/1000))\ndt = time.strftime(\"%Y-%m-%d %H:%M:%S\",time_local)\nreturn str(dt)\ndef getNewestDektJSON():\nfileName=sorted(os.listdir(DEKT_SOURCE_DIR))[-1]\ntry:\ndata = json.load(open(os.path.join(DEKT_SOURCE_DIR, fileName), 'r'))\nreturn data['data'], fileName[5:22]\nexcept json.JSONDecodeError as e:\nwarning(\"dekt json decode error: {}\".format(e))\nexcept BaseException as e:\nwarning(\"exception in dekt getNewestDektJSON: {}\".format(e))\ndef NewActlistPic():\nnowtime = time.time()*1000\nactlist, rettime = getNewestDektJSON()\nwidth=880\nheight=len(actlist)*240+250\nimg, draw, h = init_image_template('\u200b\u7b2c\u4e8c\u8bfe\u5802\u200b\u00b7\u200b\u6700\u65b0\u200b\u6d3b\u52a8\u200b', width, height, (39,82,163,255))\nh+=130\nfor activity in actlist:\nimg = draw_rounded_rectangle(img, x1=60, y1=h, x2=width-60 ,y2=h+210, fill=(255,255,255,255))\nl = 60\nurl_avatar = requests.get(activity['activityPicurl'])\nif url_avatar.status_code != requests.codes.ok:\nimg_avatar = None\nelse:\nimg_avatar = Image.open(BytesIO(url_avatar.content)).resize((90,90))\nimg.paste(img_avatar, (l+30, h+30))\ntxt_size = draw.textsize(activity['activityName'], font = font_syhtmed_24)\nact_txt = \"\"\nif txt_size[0]&gt;(width-l-270):\nfor t in activity['activityName']:\ntxt_size_2 = draw.textsize(act_txt+t, font = font_syhtmed_24)\nif txt_size_2[0]&gt;(width-l-270):\nact_txt+='...'\nbreak\nact_txt+=t\nelse:\nact_txt = activity['activityName']\ndraw.text((l+150, h+30), act_txt, fill=(0,0,0,255), font = font_syhtmed_24)\ndraw.text((l+150, h+80), '\u200b\u6d3b\u52a8\u200b\u65f6\u95f4\u200b\uff1a'+Timestamp2time(activity['activeStartTime'])+' ~ '+Timestamp2time(activity['activeEndTime']), fill=(115,115,115,255), font = font_syhtmed_18)\nclr = 'o' if nowtime &lt; activity['enrollStartTime'] else 'g'\n# print(nowtime,' ' , activity['enrollStartTime'])\nclr = 'h' if nowtime &gt; activity['enrollEndTime'] else clr\nflag_txt = '\u200b\u62a5\u540d\u200b\u672a\u200b\u5f00\u59cb\u200b' if clr=='o' else '\u200b\u62a5\u540d\u200b\u8fdb\u884c\u200b\u4e2d\u200b'\nflag_txt = '\u200b\u62a5\u540d\u200b\u5df2\u200b\u7ed3\u675f\u200b' if clr=='h' else flag_txt\nenroll_time = '\u200b\u62a5\u540d\u200b\u65f6\u95f4\u200b\uff1a'+Timestamp2time(activity['enrollStartTime'])+' ~ '+Timestamp2time(activity['enrollEndTime'])\ndraw.text((l+150, h+120), enroll_time , fill=(115,115,115,255), font = font_syhtmed_18)\ntxt_size = draw.textsize(enroll_time, font= font_syhtmed_18)\ntxt_size_2 = draw.textsize(flag_txt, font= font_syhtmed_18)\nimg = draw_rounded_rectangle(img, x1=l+160+txt_size[0], y1=h+110, x2=l+180+txt_size[0]+txt_size_2[0] ,y2=h+txt_size_2[1]+130, fill=BACK_CLR[clr])\ndraw.text((l+170+txt_size[0], h+120), flag_txt, fill=FONT_CLR[clr], font=font_syhtmed_18)\nif activity['recruitQty']==0:\nactivity['recruitQty']=\"\u200b\u4e0d\u200b\u9650\u200b\"\ndraw.text((l+150, h+160), '\u200b\u62db\u52df\u200b\u4eba\u6570\u200b\uff1a'+str(activity['recruitQty'])+'  |  \u200b\u7ec4\u7ec7\u200b\u5355\u4f4d\u200b\uff1a'+activity['sponsor'][:21], fill=(115,115,115,255), font = font_syhtmed_18)\nif len(activity['sponsor'])&gt;20:\ntxt_size=draw.textsize('\u200b\u62db\u52df\u200b\u4eba\u6570\u200b\uff1a'+str(activity['recruitQty'])+'  |  \u200b\u7ec4\u7ec7\u200b\u5355\u4f4d\u200b\uff1a',font=font_syhtmed_18)\nt = activity['sponsor'][21:42]+('...' if len(activity['sponsor'])&gt;=42 else '')\ndraw.text((l+150+txt_size[0], h+163+txt_size[1]), t, fill=(115,115,115,255), font = font_syhtmed_18)\nh+=240\ntxt_size = draw.textsize(f'\u200b\u6d3b\u52a8\u200b\u5217\u8868\u200b\u66f4\u65b0\u200b\u65f6\u95f4\u200b {rettime[:10]} {rettime[11:13]}:{rettime[13:15]}:{rettime[15:]}',font=font_syhtmed_18)\ndraw.text((width/2-txt_size[0]/2, height-85), f'\u200b\u6d3b\u52a8\u200b\u5217\u8868\u200b\u66f4\u65b0\u200b\u65f6\u95f4\u200b {rettime[:10]} {rettime[11:13]}:{rettime[13:15]}:{rettime[15:]}', fill=(115,115,115,255), font = font_syhtmed_18) \nsave_path= os.path.join(SAVE_TMP_PATH, 'dekt.png')\nimg.save(save_path)\nreturn save_path\n</code></pre>"},{"location":"plugin/plugins/sjtuHesuanPlugin/","title":"SJTU \u200b\u6838\u9178\u200b\u70b9\u4f4d","text":""},{"location":"plugin/plugins/sjtuHesuanPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b SjtuHesuan StandardPlugin '-hs' None \u200b\u53d1\u9001\u200b\u5f53\u524d\u200b\u65f6\u523b\u200b\u4ea4\u5927\u200b\u6838\u9178\u200b\u70b9\u4f4d\u200b\u56fe"},{"location":"plugin/plugins/sjtuHesuanPlugin/#2","title":"2. \u200b\u539f\u7406\u200b\u8bb2\u89e3","text":"<p>\u200b\u7528\u957f\u200b\u4e3a\u200b3\u200b\u7684\u200b\u5411\u91cf\u200b\u6765\u200b\u8868\u793a\u200b\u4e8c\u7ef4\u200b\u5750\u6807\u200b\uff1a</p> \\[ (x, y, 1)^{\\rm T} \\iff \\left(nx, ny, n\\right)^{\\rm T} \\overset{denote}{\\implies} (x, y) \\] <p>\u200b\u5e73\u79fb\u200b \\((\\Delta x, \\Delta y)\\) \u200b\u53d8\u6362\u200b\uff1a</p> \\[ \\begin{bmatrix} 1&amp;0&amp;\\Delta x\\\\ 0&amp;1&amp;\\Delta y\\\\ 0&amp;0&amp;1 \\end{bmatrix} \\] <p>\u200b\u7ed5\u200b \\(z\\) \u200b\u65cb\u8f6c\u200b \\(\\theta\\) \u200b\u89d2\u200b\u53d8\u6362\u200b\uff1a</p> \\[ \\begin{bmatrix} \\cos\\theta&amp;\\sin\\theta&amp;0\\\\ -\\sin\\theta&amp;\\cos\\theta&amp;0\\\\ 0&amp;0&amp;1 \\end{bmatrix} \\] <p>\u200b\u62c9\u4f38\u200b \\((\\lambda, \\mu)\\) \u200b\u53d8\u6362\u200b\uff1a</p> \\[ \\begin{bmatrix} \\lambda&amp;0&amp;0\\\\ 0&amp;\\mu&amp;0\\\\ 0&amp;0&amp;1 \\end{bmatrix} \\] <p>\u200b\u5730\u56fe\u200b\u53d8\u6362\u200b\u53ef\u4ee5\u200b\u89c6\u4e3a\u200b\u5982\u4e0b\u200b\u65b9\u7a0b\u200b\uff0c\u200b\u4ed6\u200b\u628a\u200b\u7ecf\u7eac\u5ea6\u200b\u8f6c\u6362\u200b\u4e3a\u200b\u7167\u7247\u200b\u6750\u8d28\u200b\u7684\u200buv\u200b\u5750\u6807\u200b\uff1a</p> \\[ f({\\rm lng}, {\\rm lat})\\implies(u,v) \\] <p>\u200b\u5730\u56fe\u200b\u53d8\u6362\u200b\u628a\u200b\u7ecf\u7eac\u5ea6\u200b\u7b49\u200b\u6bd4\u4f8b\u200b\u62c9\u4f38\u200b\u5230\u200b\u7167\u7247\u200b\u4e0a\u200b\uff0c\u200b\u663e\u7136\u200b\u662f\u200b\u7ebf\u6027\u53d8\u6362\u200b\uff0c\u200b\u53ef\u4ee5\u200b\u89c6\u4e3a\u200b\u4e0a\u9762\u200b\u53d8\u6362\u200b\u7684\u200b\u7ebf\u6027\u7ec4\u5408\u200b\uff0c\u200b\u90a3\u4e48\u200b\u53d8\u6362\u200b\u77e9\u9635\u200b\u4e00\u5b9a\u200b\u5177\u6709\u200b\u5982\u4e0b\u200b\u5f62\u5f0f\u200b\uff1a</p> \\[ \\begin{bmatrix} a_{11}&amp;a_{12}&amp;a_{13}\\\\ a_{21}&amp;a_{22}&amp;a_{23}\\\\ 0&amp;0&amp;1 \\end{bmatrix} \\] <p>\u200b\u8981\u200b\u89e3\u51fa\u200b\u8fd9\u200b\u516d\u4e2a\u200b\u7cfb\u6570\u200b\uff0c\u200b\u53ea\u200b\u9700\u8981\u200b\u5728\u200b\u7167\u7247\u200b\u548c\u200b\u5730\u56fe\u200b\u4e0a\u200b\u6311\u200b3\u200b\u5bf9\u200b\u4e0d\u200b\u5171\u7ebf\u200b\u7684\u200b \u201c\u200b\u7ecf\u7eac\u200b-uv\u201d \u200b\u5bf9\u5e94\u70b9\u200b\uff1a</p> \\[ \\begin{bmatrix} a_{11}&amp;a_{12}&amp;a_{13}\\\\ a_{21}&amp;a_{22}&amp;a_{23}\\\\ 0&amp;0&amp;1 \\end{bmatrix} \\begin{bmatrix} {\\rm lng}_1&amp;{\\rm lng}_2&amp;{\\rm lng}_3\\\\ {\\rm lat}_1&amp;{\\rm lat}_2&amp;{\\rm lat}_3\\\\ 1&amp;1&amp;1 \\end{bmatrix} = \\begin{bmatrix} u_1&amp;u_2&amp;u_3\\\\ v_1&amp;v_2&amp;v_3\\\\ 1&amp;1&amp;1 \\end{bmatrix} \\] <p>\u200b\u89e3\u5f97\u200b\uff1a</p> \\[ \\begin{bmatrix} a_{11}&amp;a_{12}&amp;a_{13}\\\\ a_{21}&amp;a_{22}&amp;a_{23}\\\\ 0&amp;0&amp;1 \\end{bmatrix} = \\begin{bmatrix} u_1&amp;u_2&amp;u_3\\\\ v_1&amp;v_2&amp;v_3\\\\ 1&amp;1&amp;1 \\end{bmatrix} \\begin{bmatrix} {\\rm lng}_1&amp;{\\rm lng}_2&amp;{\\rm lng}_3\\\\ {\\rm lat}_1&amp;{\\rm lat}_2&amp;{\\rm lat}_3\\\\ 1&amp;1&amp;1 \\end{bmatrix}^{-1} \\] <p>\u200b\u6240\u4ee5\u200b\uff0c\u200b\u53d8\u6362\u200b\u65b9\u7a0b\u200b\u53ef\u4ee5\u200b\u5199\u6210\u200b\uff1a</p> \\[ \\begin{bmatrix} u\\\\v\\\\1 \\end{bmatrix} = \\begin{bmatrix} u_1&amp;u_2&amp;u_3\\\\ v_1&amp;v_2&amp;v_3\\\\ 1&amp;1&amp;1 \\end{bmatrix} \\begin{bmatrix} {\\rm lng}_1&amp;{\\rm lng}_2&amp;{\\rm lng}_3\\\\ {\\rm lat}_1&amp;{\\rm lat}_2&amp;{\\rm lat}_3\\\\ 1&amp;1&amp;1 \\end{bmatrix}^{-1} \\begin{bmatrix} {\\rm lng}\\\\{\\rm lat}\\\\1 \\end{bmatrix} \\] <p>\u200b\u63d0\u793a\u200b\uff1a\u200b\u66f4\u8fdb\u4e00\u6b65\u200b\u4e86\u89e3\u200b</p> <p>\u200b\u4f60\u200b\u53ef\u4ee5\u200b\u641c\u7d22\u200b\u201c\u200b\u56fe\u5f62\u5b66\u200b\u5750\u6807\u200b\u53d8\u6362\u200b\u201d\u200b\u4ee5\u200b\u66f4\u8fdb\u4e00\u6b65\u200b\u5b66\u4e60\u200b\u80cc\u540e\u200b\u7684\u200b\u77e5\u8bc6\u200b</p>"},{"location":"plugin/plugins/sjtuHesuanPlugin/#3","title":"3. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; -hs\nbot&gt; \u3010\u200b\u4ea4\u5927\u200b\u6838\u9178\u200b\u70b9\u4f4d\u200b\u56fe\u7247\u200b\u3011\n</code></pre>"},{"location":"plugin/plugins/sjtuHesuanPlugin/#4","title":"4. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b plugins/sjtuHesuan.py</p> <pre><code>class SjtuHesuan(StandardPlugin):\n@staticmethod\ndef xyToUv(lng:float, lat:float)-&gt;Tuple[int, int]:\nloc = np.matrix([[lng], [lat], [1.0]], dtype = np.float64)\nconvert = np.matrix([\n[19.0, 1458.0, 10.0],\n[13.0, 27.0, 834.0],\n[1.0, 1.0, 1.0]\n], dtype = np.float64) * np.matrix([\n[121.429318, 121.4524, 121.434272],\n[31.033855, 31.041409, 31.022526],\n[1.0, 1.0, 1.0]\n], dtype = np.float64).I\nuv = convert * loc\nreturn int(uv[0, 0]), int(uv[1, 0])\n@staticmethod\ndef getLocColor(openTime: str, daily: bool):\n\"\"\"\u200b\u83b7\u53d6\u200b\u6838\u9178\u200b\u70b9\u4f4d\u200b\u6e32\u67d3\u200b\u989c\u8272\u200b\n        @openTime: like '8:00-10:00'\n        @return:   \u200b\u5708\u200b\u7684\u200b\u989c\u8272\u200b, \u200b\u5b57\u200b\u7684\u200b\u989c\u8272\u200b\n        \"\"\"\ndef parseTime(timeStr, nowTime: datetime):\ntimeParser = re.compile(r'^(\\d+):(\\d+)-(\\d+):(\\d+)$')\nt00, t01, t10, t11 = timeParser.findall(timeStr)[0]\nreturn datetime.combine(nowTime.date(), time(int(t00), int(t01))), \\\n                   datetime.combine(nowTime.date(), time(int(t10), int(t11)))\nnowTime = datetime.now()\nif not daily and nowTime.isoweekday() &gt;= 6:\nreturn PALETTE_GREY, PALETTE_GREY\nelse:\nfor openTime in openTime.split(','):\nstartTime, endTime = parseTime(openTime, nowTime)\nwarningTime = endTime - timedelta(minutes=20)\nif startTime &lt;= nowTime and nowTime &lt; warningTime:\nreturn PALETTE_GREEN, PALETTE_BLACK\nelif warningTime &lt;= nowTime and nowTime &lt; endTime:\nreturn PALETTE_ORANGE, PALETTE_BLACK\nreturn PALETTE_GREY, PALETTE_GREY\ndef __init__(self) -&gt; None:\nself.hesuanList = json.load(open('resources/sjtuHesuan.json', 'r'))\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn msg == '-hs'\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nhesuanMap = Image.open('resources/images/hesuanMap.png')\ndraw = ImageDraw.Draw(hesuanMap)\nfor loc in self.hesuanList:\nlng = loc['point']['lng']\nlat = loc['point']['lat']\nx, y = SjtuHesuan.xyToUv(lng, lat)\nr = 10\ncircleFill, wordFill = SjtuHesuan.getLocColor(loc['time'], loc['timeTitle'] == '\u200b\u6bcf\u5929\u200b')\ndraw.ellipse((x-r, y-r, x+r, y+r), fill=circleFill)\nshowText = loc['title']+'\\n'+loc['timeTitle']+' '+loc['time']\ntitlesize = draw.textsize(showText, FONT_SYHT_M18)\ntmp = ResponseImage()\nif loc['title'] in ['X86', '\u200b\u897f\u200b\u4e09\u533a\u200b\u5e7f\u573a\u200b', '\u200b\u5316\u5de5\u5b66\u9662\u200b', '\u200b\u5305\u7389\u521a\u200b\u56fe\u4e66\u9986\u200b', '\u200b\u8239\u5efa\u200b\u5b66\u9662\u200b', 'X56', 'D28', 'D35', 'D25']:\ntmp.drawRoundedRectangle(x-titlesize[0]/2-10, y+15, x+titlesize[0]/2+10, y+35+titlesize[1], fill = PALETTE_WHITE, border = True, target = hesuanMap)\ndraw.text((x-titlesize[0]/2, y+25), showText, wordFill , FONT_SYHT_M18)\nelse:\ntmp.drawRoundedRectangle(x-titlesize[0]/2-10, y-35-titlesize[1], x+titlesize[0]/2+10, y-15, fill = PALETTE_WHITE, border = True, target = hesuanMap)\ndraw.text((x-titlesize[0]/2, y-25-titlesize[1]), showText, wordFill , FONT_SYHT_M18)\nsavePath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'hesuan-%d.png'%target)\nhesuanMap.save(savePath)\nsend(target, f'[CQ:image,file=files://{savePath},id=40000]', data['message_type'])\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'SjtuHesuan',\n'description': '\u200b\u6838\u9178\u200b\u67e5\u8be2\u200b',\n'commandDescription': '-hs',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.3',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/sjtuJwcPlugin/","title":"SJTU \u200b\u6559\u52a1","text":""},{"location":"plugin/plugins/sjtuJwcPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b JwcGroup StandardPlugin '-jwc' None \u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200b\u6559\u52a1\u5904\u200b\u4fe1\u606f\u200b SjtuJwcMonitor StandardPlugin  CronStandardPlugin <code>None</code> None \u200b\u5e7f\u64ad\u200b\u4ea4\u5927\u200b\u6559\u52a1\u5904\u200b\u66f4\u65b0\u200b\u4fe1\u606f"},{"location":"plugin/plugins/sjtuJwcPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<p>\u200b\u4ee3\u7801\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code>ROOT_ADMIN_ID = [111, # \u200b\u7528\u6237\u200bA  \n222, # \u200b\u7528\u6237\u200bB\n444] # \u200b\u7528\u6237\u200bD\nGroupPluginList = [ # \u200b\u7fa4\u804a\u200b\u542f\u7528\u200b\u63d2\u4ef6\u200b\n# .....\nJwcGroup()\n# .....\n]\n</code></pre> <p>\u200b\u7fa4\u804a\u200b\u90e8\u5206\u200b\uff1a</p> <pre><code># \u200b\u7fa4\u5185\u200b\u5c1a\u672a\u200b\u6253\u5f00\u200bjwc\n333&gt; -jwc\n# \u200b\u65e0\u200b\u4e8b\u200b\u53d1\u751f\u200b\n# \u200b\u63a5\u4e0b\u6765\u200b\u7ba1\u7406\u5458\u200b\u6253\u5f00\u200bcanvas\n111&gt; -grpcfg enable jwc\nbot&gt; OK\n\n# \u200b\u7528\u6237\u200b\u53d1\u9001\u200bjwc\u200b\u6307\u4ee4\u200b\n222&gt; -jwc\nbot&gt;    \u30101\u30112022-09-30 2022\u200b\u5e74\u200b\u5927\u5b66\u751f\u200b\u82f1\u8bed\u200b\u7ade\u8d5b\u200b\u95f5\u884c\u6821\u200b\u533a\u200b\u8003\u751f\u200b\u9000\u8d39\u200b\u901a\u77e5\u200b https://jwc.sjtu.edu.cn/info/1285/11905.htm\n        \u30102\u30112022-09-30 \u200b\u5173\u4e8e\u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b2022\u200b\u5e74\u200b\u7acb\u9879\u200b\u6559\u6750\u200b\u8bc4\u5ba1\u200b\u7ed3\u679c\u200b\u7684\u200b\u516c\u793a\u200b https://jwc.sjtu.edu.cn/info/1257/11904.htm\n        \u30103\u30112022-09-29 \u200b\u5173\u4e8e\u200b\u4e3e\u529e\u200b\u7b2c\u5341\u56db\u5c4a\u200b\u5168\u56fd\u200b\u5927\u5b66\u751f\u200b\u6570\u5b66\u200b\u7ade\u8d5b\u200b\u8d5b\u524d\u200b\u57f9\u8bad\u200b\u7684\u200b\u901a\u77e5\u200b https://jwc.sjtu.edu.cn/info/1222/11900.htm\n        \u30104\u30112022-09-27 \u200b\u4e0a\u6d77\u4ea4\u901a\u5927\u5b66\u200b2023\u200b\u5e74\u200b\u63a8\u8350\u200b\u4f18\u79c0\u200b\u5e94\u5c4a\u200b\u672c\u79d1\u200b\u6bd5\u4e1a\u751f\u200b\u514d\u8bd5\u200b\u653b\u8bfb\u200b\u7814\u7a76\u751f\u200b\u516c\u793a\u200b\u540d\u5355\u200b https://jwc.sjtu.edu.cn/content.jsp?urltype=news.NewsContentUrl&amp;wbtreeid=1222&amp;wbnewsid=11897\n\u30105\u30112022-09-27 \u200b\u5173\u4e8e\u200b2022\u200b\u5e74\u200b\u666e\u901a\u8bdd\u200b\u6c34\u5e73\u200b\u6d4b\u8bd5\u200b\u5de5\u4f5c\u200b\u5ef6\u671f\u200b\u5230\u200b\u672c\u5b66\u671f\u200b\u4e3e\u529e\u200b\u7684\u200b\u901a\u77e5\u200b https://jwc.sjtu.edu.cn/info/1222/11894.htm\n\n# \u200b\u67d0\u200b\u65f6\u523b\u200bbot\u200b\u68c0\u6d4b\u200b\u5230\u200b\u6559\u52a1\u5904\u200b\u901a\u77e5\u200b\u66f4\u65b0\u200b\nbot&gt; ${\u200b\u6559\u52a1\u5904\u200b\u901a\u77e5\u200b\u7684\u200b\u56fe\u7247\u200b}\n</code></pre> <p>\u200b\u56fe\u7247\u200b\u5c55\u793a\u200b\uff1a</p> <p></p> <p>\u200b\u6ce8\u610f\u200b\uff1a\u200b\u65e7\u200b\u7684\u200b\u7ed8\u56fe\u200b\u4ee3\u7801\u200b</p> <p>\u200b\u8fd9\u662f\u200b\u65e9\u671f\u200b\u5b8c\u6210\u200b\u7684\u200b\u63d2\u4ef6\u200b\uff0c\u200b\u7ed8\u56fe\u200b\u90e8\u5206\u200b\u4ee3\u7801\u200b\u5e76\u672a\u200b\u4f7f\u7528\u200b\u63a8\u8350\u200b\u7684\u200b responseImage \u200b\u5e93\u200b</p>"},{"location":"plugin/plugins/sjtuJwcPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/getJwc.py</code></p> <pre><code>from utils.standardPlugin import StandardPlugin, Any, Union, CronStandardPlugin\nfrom utils.responseImage import *\nimport requests\nfrom bs4 import BeautifulSoup as BS\nfrom utils.basicEvent import *\nfrom utils.basicConfigs import *\nfrom threading import Timer, Semaphore\nfrom pathlib import Path\nimport json\nfrom datetime import datetime\nfrom urllib.parse import urljoin\nimport qrcode\nimport os, os.path\ndef getJwc()-&gt;list:\npageUrl = 'https://jwc.sjtu.edu.cn/xwtg/tztg.htm'\nreq = requests.get(pageUrl)\nif req.status_code != requests.codes.ok:\nwarning(\"jwc.sjtu.edu.cn API failed!\")\nreturn []\npage = str(req.content, 'utf-8')\npage = BS(page, 'lxml')\nnews = page.find(class_='Newslist').ul.find_all(class_='clearfix')\nnewsList = []\nfor n in news:\ntry:\nsj = n.find(class_='sj')\nyear, month = sj.p.contents[0].split('.')\nday = sj.h2.contents[0]\ncontent = n.find(class_='wz')\ntitle:str = content.h2.contents[0]\nlink:str = content.a.get('href')\nlink = urljoin(pageUrl, link)\ndetail:str = content.p.contents[0]\nnewsList.append({\n'year': year,\n'month': month,\n'day': day,\n'title': title,\n'detail': detail,\n'link': link,\n})\nexcept BaseException as e:\nprint(\"exception in getJwc: {}\".format(e))\nreturn newsList\nclass SjtuJwcMonitor(StandardPlugin, CronStandardPlugin):\nmonitorSemaphore = Semaphore()\ndef __init__(self) -&gt; None:\nif SjtuJwcMonitor.monitorSemaphore.acquire(blocking=False):\nself.start(20, 180)\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn False\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nreturn \"OK\"\ndef tick(self, ):\nexact_path='data/jwc.json'\nif not os.path.isfile(exact_path):\nwith open(exact_path, 'w') as f:\nf.write('[]')\nurl_list:list = json.load(open(exact_path, 'r'))\nupdateFlag = len(url_list) &gt; 0\nfor j in getJwc():\nif j['link'] not in url_list:\nurl_list.append(j['link'])\nif not updateFlag: continue\npic = DrawNoticePIC(j)\npic = pic if os.path.isabs(pic) else os.path.join(ROOT_PATH, pic)\nfor group_id in getPluginEnabledGroups('jwc'):\nsend(group_id, '\u200b\u5df2\u200b\u53d1\u73b0\u200b\u6559\u52a1\u200b\u901a\u77e5\u200b\u66f4\u65b0\u200b:\\n\u3010'+j['title']+'\u3011\\n'+j['link'])\nsend(group_id, '[CQ:image,file=files://%s,id=40000]'%pic)\nwith open(exact_path, 'w') as f:\njson.dump(url_list, f, indent=4)\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'SjtuJwcMonitor',\n'description': '\u200b\u6559\u52a1\u200b\u901a\u77e5\u200b\u66f4\u65b0\u200b\u5e7f\u64ad\u200b',\n'commandDescription': 'None',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.4',\n'author': 'Unicorn',\n}\nclass GetJwc(StandardPlugin): \ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg=='-jwc'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\njwc = sorted(getJwc(), key=lambda x: '%s-%s-%s'%(x['year'], x['month'], x['day']), reverse=True)\njwcStr = \"\"\nidx = 1\nfor j in jwc[:7]:\njwcStr += '\u3010%d\u3011%s-%s-%s %s %s\\n'%(idx, j['year'], j['month'], j['day'], j['title'], j['link'])\nidx += 1\njwcStr = jwcStr[:-1]\nsend(target, jwcStr, data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'GetJwc',\n'description': '\u200b\u83b7\u53d6\u200b\u6559\u52a1\u200b\u901a\u77e5\u200b',\n'commandDescription': '-jwc',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass GetSjtuNews(StandardPlugin): \nmonitorSemaphore = Semaphore()\ndef __init__(self) -&gt; None:\nself.checkTimer = Timer(20,self.updateAndCheck)\nif GetSjtuNews.monitorSemaphore.acquire(blocking=False):\nself.checkTimer.start()\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg=='-sjtu news'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\npic_path = os.path.join(SAVE_TMP_PATH, 'sjtu_news.png')\npic_path = pic_path if os.path.isabs(pic_path) else os.path.join(ROOT_PATH, pic_path)\nif not os.path.isfile(pic_path):\ndrawSjtuNews()\nsend(target, '[CQ:image,file=files://%s,id=40000]'%pic_path, data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'GetSjtuNews',\n'description': '\u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200b\u65b0\u95fb\u7f51\u200b',\n'commandDescription': '-sjtu news',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'fangtiancheng',\n}\ndef updateAndCheck(self, ):\nself.checkTimer.cancel()\nself.checkTimer = Timer(900,self.updateAndCheck)\nself.checkTimer.start()\ndrawSjtuNews()\ndef DrawNoticePIC(notice)-&gt;str:\nwidth = 720\ntxt_line=\"\"\ntxt_parse, title_parse=[], []\nfor word in notice['title']:\nif txt_line==\"\" and word in ['\uff0c','\uff1b','\u3002','\u3001','\"','\uff1a','.','\u201d']: #\u200b\u907f\u514d\u200b\u6807\u70b9\u7b26\u53f7\u200b\u5728\u200b\u9996\u4f4d\u200b\ntitle_parse[-1]+=word\ncontinue\ntxt_line+=word\nif font_syhtmed_24.getsize(txt_line)[0]&gt;width-180:\ntitle_parse.append(txt_line)\ntxt_line=\"\"\nif txt_line!=\"\":\ntitle_parse.append(txt_line)\ntxt_line=\"\"\nfor word in notice['detail'].strip():\nif txt_line==\"\" and word in ['\uff0c','\uff1b','\u3002','\u3001','\"','\uff1a','.','\u201d']: #\u200b\u907f\u514d\u200b\u6807\u70b9\u7b26\u53f7\u200b\u5728\u200b\u9996\u4f4d\u200b\ntxt_parse[-1]+=word\ncontinue\ntxt_line+=word\nif font_syhtmed_18.getsize(txt_line)[0]&gt;width-240:\ntxt_parse.append(txt_line)\ntxt_line=\"\"\nif txt_line!=\"\":\ntxt_parse.append(txt_line)\nif txt_parse[-1][-1]!='.':\ntxt_parse[-1]+='...'\nheight = 525+len(txt_parse)*27+len(title_parse)*33\nimg, draw, h = init_image_template('\u200b\u6559\u52a1\u200b\u901a\u77e5\u200b\u00b7\u200b\u66f4\u65b0\u200b\u63d0\u9192\u200b', width, height, (167,32,56,255))\nh+=130\nl=60\nimg=draw_rounded_rectangle(img, 60, h, width-60, height-90, (255,255,255,255))\ntxt_size=draw.textsize(notice['title'], font = font_syhtmed_24)\nfor line in title_parse:\ntxt_size=draw.textsize(line, font = font_syhtmed_24)\ndraw.text(((width-txt_size[0])/2,h+33), line, fill=(0,0,0,255),font = font_syhtmed_24)\nh+=33\n# draw.text(((width-txt_size[0])/2,h+30),notice['title'], fill=(0,0,0,255),font = font_syhtmed_24)\n# h+=(30+txt_size[1])\nh+=5\ntime_txt = '%s-%s-%s'%(notice['year'], notice['month'], notice['day'])\ntxt_size=draw.textsize(time_txt, font = font_syhtmed_18)\ndraw.text(((width-txt_size[0])/2,h+30),time_txt, fill=(115,115,115,255),font = font_syhtmed_18)\nh+=(30+txt_size[1])\nfor line in txt_parse:\ntxt_size=draw.textsize(line, font = font_syhtmed_18)\ndraw.text(((width-txt_size[0])/2,h+27), line, fill=(115,115,115,255),font = font_syhtmed_18)\nh+=27\nqrc = qrcode.QRCode(\nversion=3,\nerror_correction=qrcode.constants.ERROR_CORRECT_Q,\nbox_size=15,\nborder=4,\n)\nqrc.add_data(notice['link'])\nqrc.make(fit=True)\nimgqrc = qrc.make_image().resize((180,180))\nimg.paste(imgqrc, ((width-180)//2,h+30))\nsave_path=os.path.join(SAVE_TMP_PATH, 'jwc_notice.png')\nimg.save(save_path)\nreturn save_path\n</code></pre>"},{"location":"plugin/plugins/sjtuMddPlugin/","title":"SJTU \u200b\u9ea6\u5f53\u52b3","text":""},{"location":"plugin/plugins/sjtuMddPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b GetMddStatus StandardPlugin '-mdd' None \u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u72b6\u6001\u200b MonitorMddStatus StandardPlugin  CronStandardPlugin <code>None</code> None \u200b\u5e7f\u64ad\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u72b6\u6001\u200b\u6539\u53d8\u200b\u4fe1\u606f"},{"location":"plugin/plugins/sjtuMddPlugin/#2","title":"2. \u200b\u63d2\u4ef6\u200b\u4f5c\u8005\u7b80\u4ecb","text":"<p>Teruteru: SJTU \u200b\u7535\u9662\u200b 21\u200b\u7ea7\u200b</p> <p>\u200b\u9ea6\u5f53\u52b3\u200b\u5c0f\u200b\u7a0b\u5e8f\u200b\u9006\u5411\u200b\u7834\u89e3\u200b</p>"},{"location":"plugin/plugins/sjtuMddPlugin/#3","title":"3. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>\u200b\u9ea6\u5f53\u52b3\u200b\u5f00\u95e8\u200b\nbot&gt; \ud83d\udce3\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b \u200b\u5df2\u200b\u25b6\ufe0f\u200b\u5f00\u653e\u200b\u8425\u4e1a\u200b\n111&gt; -mdd\nbot&gt; \u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b\uff1a\n     \u25b6\ufe0f\u200b\u8425\u4e1a\u200b\u4e2d\u200b\n     2022-11-21 07:31:00\n\n\u200b\u9ea6\u5f53\u52b3\u200b\u5173\u95e8\u200b\nbot&gt; \ud83d\udce3\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b \u200b\u5df2\u200b\u23f8\ufe0f\u200b\u6682\u505c\u8425\u4e1a\u200b\n111&gt; -mdd\nbot&gt; \u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b\uff1a\n     \u23f8\ufe0f\u200b\u6682\u505c\u8425\u4e1a\u200b\n     2022-11-21 10:01:00\n</code></pre>"},{"location":"plugin/plugins/sjtuMddPlugin/#4","title":"4. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>from utils.basicConfigs import ROOT_PATH\nfrom utils.responseImage import *\nfrom utils.basicEvent import send, warning\nfrom typing import Union, Tuple, Any, List\nfrom utils.standardPlugin import StandardPlugin, PluginGroupManager\nfrom utils.basicEvent import getPluginEnabledGroups\nfrom threading import Timer, Semaphore\nfrom resources.api.mddApi import mddUrl, mddHeaders\nfrom datetime import datetime\nimport os.path\nclass GetMddStatus(StandardPlugin):\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn msg == '-mdd'\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nreq = getMddStatus()\nif req == None:\nsend(target, '\u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u72b6\u6001\u200b\u5931\u8d25\u200b\uff01', data['message_type'])\ntry:\ncurrentStatus = req[\"data\"][\"onlineBusinessStatus\"]\nexcept KeyError as e:\nwarning(\"mdd api failed: {}\".format(e))\nsend(target, '\u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u72b6\u6001\u200b\u5931\u8d25\u200b\uff01', data['message_type'])\nreturn\nif currentStatus :\nsend(target, '\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b\uff1a\\n\u25b6\ufe0f\u200b\u8425\u4e1a\u200b\u4e2d\u200b\\n\\n%s'%datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\"), data['message_type'])\nelse:\nsend(target, '\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b\u5f53\u524d\u200b\u72b6\u6001\u200b\uff1a\\n\u23f8\ufe0f\u200b\u6682\u505c\u8425\u4e1a\u200b\\n\\n%s'%datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\"), data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'GetMddStatus',\n'description': '\u200b\u9ea6\u5f53\u52b3\u200b\u67e5\u8be2\u200b',\n'commandDescription': '-mdd',\n'usePlace': ['group', 'private', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.3',\n'author': 'Teruteru',\n}\nclass MonitorMddStatus(StandardPlugin):\nmonitorSemaphore = Semaphore()\n@staticmethod\ndef dumpMddStatus(status: bool):\nexactPath = 'data/mdd.json'\nwith open(exactPath, 'w') as f:\nf.write('1' if status else '0')\n@staticmethod\ndef loadMddStatus()-&gt;bool:\nexactPath = 'data/mdd.json'\nwith open(exactPath, 'r') as f:\nreturn f.read().startswith('1')\ndef __init__(self) -&gt; None:\nself.timer = Timer(5, self.mddMonitor)\nif MonitorMddStatus.monitorSemaphore.acquire(blocking=False):\nself.timer.start()\nself.exactPath = 'data/mdd.json'\nself.prevStatus = False # false: \u200b\u6682\u505c\u8425\u4e1a\u200b, true: \u200b\u8425\u4e1a\u200b\nif not os.path.isfile(self.exactPath):\nMonitorMddStatus.dumpMddStatus(False)\nelse:\nself.prevStatus = MonitorMddStatus.loadMddStatus()\ndef mddMonitor(self):\nself.timer.cancel()\nself.timer = Timer(60,self.mddMonitor)\nself.timer.start()\nprevStatus = MonitorMddStatus.loadMddStatus()\nreq = getMddStatus()\nif req == None: return\ntry:\ncurrentStatus = req[\"data\"][\"onlineBusinessStatus\"]\nexcept KeyError as e:\nwarning('mdd api failed: {}'.format(e))\nreturn\nif currentStatus != prevStatus:\nMonitorMddStatus.dumpMddStatus(currentStatus)\nif currentStatus :\nfor group in getPluginEnabledGroups('mddmonitor'):\nsend(group, '\ud83d\udce3\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b \u200b\u5df2\u200b\u25b6\ufe0f\u200b\u5f00\u653e\u200b\u8425\u4e1a\u200b')\nelse:\nfor group in getPluginEnabledGroups('mddmonitor'):\nsend(group, '\ud83d\udce3\u200b\u4ea4\u5927\u200b\u95f5\u884c\u200b\u9ea6\u5f53\u52b3\u200b \u200b\u5df2\u200b\u23f8\ufe0f\u200b\u6682\u505c\u8425\u4e1a\u200b')\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn False\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\nreturn \"OK\"\ndef getPluginInfo(self) -&gt; dict:\nreturn {\n'name': 'MonitorMddStatus',\n'description': '\u200b\u9ea6\u5f53\u52b3\u200b\u72b6\u6001\u200b\u76d1\u63a7\u200b',\n'commandDescription': 'None',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.3',\n'author': 'Teruteru',\n}\ndef getMddStatus()-&gt;Union[None, dict]:\nreq = requests.get(mddUrl, headers=mddHeaders)\nif req.status_code != requests.codes.ok:\nwarning('mdd api failed!')\nreturn None\nelse:\nreturn req.json()\n</code></pre>"},{"location":"plugin/plugins/sjtuSchoolGatePlugin/","title":"SJTU \u200b\u6821\u95e8","text":""},{"location":"plugin/plugins/sjtuSchoolGatePlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b SjtuSchoolGate StandardPlugin '-gate' None \u200b\u83b7\u53d6\u200b\u4ea4\u5927\u200b\u6821\u95e8\u200b\u72b6\u6001"},{"location":"plugin/plugins/sjtuSchoolGatePlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; -gate\nbot&gt; \u3010\u200b\u4ea4\u5927\u200b\u6821\u95e8\u200b\u72b6\u6001\u200b\u56fe\u7247\u200b\u3011\n</code></pre>"},{"location":"plugin/plugins/sjtuSchoolGatePlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b plugins/sjtuSchoolGate.py</p> <pre><code>def getSchoolGateStatus()-&gt;Optional[List[Dict]]:\nurl = \"https://campuslife.sjtu.edu.cn/api/schoolGateTraffic\"\nreq = requests.get(url=url)\nif req.status_code != requests.codes.ok:\nreturn None\ntry:\nresult = req.json()\nif result['code'] != 0: return None\nreturn result['data']\nexcept:\nreturn None\ndef drawSchoolGatePic(gatesInfo:List[Dict], savePath:str)-&gt;Tuple[bool, str]:\ngateCard = ResponseImage(\ntitle = '\u200b\u4ea4\u5927\u200b\u6821\u95e8\u200b', \ntitleColor = PALETTE_CYAN,\nwidth = 1000,\nlayout = 'two-column',\nfooter=datetime.datetime.now().strftime(\"\u200b\u66f4\u65b0\u200b\u65f6\u95f4\u200b\uff1a %Y-%m-%d %H:%M\"),\ncardBodyFont= ImageFont.truetype(os.path.join(FONTS_PATH, 'SourceHanSansCN-Medium.otf'), 24),\n)\nfor gateInfo in gatesInfo:\ncontent = []\nif gateInfo['isOpen']:\nfatalColor = PALETTE_RED\nwarningColor = PALETTE_ORANGE\ninfoColor = PALETTE_BLACK\ncontent.append(('title', gateInfo['campus'] + ' - ' + gateInfo['gate'], infoColor))\nelse:\nfatalColor = PALETTE_LIGHTRED\nwarningColor = PALETTE_LIGHTORANGE\ninfoColor = PALETTE_GREY_CONTENT\ncontent.append(('title', gateInfo['campus'] + ' - ' + gateInfo['gate']+'  [\u200b\u5173\u95ed\u200b]', infoColor))\ncontent.append(('subtitle', gateInfo['address'], infoColor))\nif gateInfo['canMv'] == 0:\ncontent.append(('subtitle', '\u200b\u7981\u6b62\u200b\u673a\u52a8\u8f66\u200b\u901a\u884c\u200b', fatalColor))\nelif gateInfo['canMv'] == 2:\ncontent.append(('subtitle', '\u200b\u4ec5\u9650\u200b\u6821\u5185\u200b\u8f66\u8f86\u200b', warningColor))\nif gateInfo['note'] != None and len(gateInfo['note'])&gt;0:\ncontent.append(('subtitle', gateInfo['note'], fatalColor))\nelse:\nif gateInfo['mvTrafficPeriod'] != None:\ncontent.append(('body', '\u200b\u673a\u52a8\u8f66\u200b\u901a\u884c\u200b\u65f6\u95f4\u200b\uff1a ' + gateInfo['mvTrafficPeriod'], infoColor))\nif gateInfo['nmvTrafficPeriod'] != None:\ncontent.append(('body', '\u200b\u884c\u4eba\u200b\u901a\u884c\u200b\u65f6\u95f4\u200b\uff1a ' + gateInfo['nmvTrafficPeriod'], infoColor))\ngateCard.addCard(ResponseImage.RichContentCard(\nraw_content=content,\ntitleFontColor=PALETTE_CYAN,\n))\ngateCard.generateImage(savePath)\nreturn True, savePath\nclass SjtuSchoolGate(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg == '-gate'\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\ngatesInfo = getSchoolGateStatus()\nif gatesInfo == None:\nsend(target, '[CQ:reply,id=%d]API\u200b\u8bf7\u6c42\u200b\u5931\u8d25\u200b\uff0c\u200b\u8bf7\u200b\u7a0d\u540e\u200b\u91cd\u8bd5\u200b'%data['message_id'], data['message_type'])\nelse:\nsavePath = os.path.join(ROOT_PATH, SAVE_TMP_PATH, 'gate_%d.png'%target)\nsucc, result = drawSchoolGatePic(gatesInfo, savePath)\nif succ:\nsend(target, '[CQ:image,file=files:///%s]'%savePath, data['message_type'])\nelse:\nsend(target, '[CQ:reply,id=%d]\u200b\u6570\u636e\u200b\u7ed8\u5236\u200b\u5931\u8d25\u200b\uff0c\u200b\u8bf7\u200b\u8054\u7cfb\u200b\u7ba1\u7406\u5458\u200b'%data['message_id'], data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self)-&gt;Any:\nreturn {\n'name': 'SjtuSchoolGate',\n'description': '\u200b\u4ea4\u5927\u200b\u6821\u95e8\u200b',\n'commandDescription': '-gate',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/superEmojiPlugin/","title":"\u8d85\u7ea7\u200b\u8868\u60c5","text":""},{"location":"plugin/plugins/superEmojiPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b FireworksFace StandardPlugin '\u200b\u70df\u82b1\u200b' / '\u200b\u653e\u4e2a\u200b\u70df\u82b1\u200b' None \u200b\u53d1\u9001\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u70df\u82b1\u200b FirecrackersFace StandardPlugin '\u200b\u97ad\u70ae\u200b' / '\u200b\u70b9\u4e2a\u200b\u97ad\u70ae\u200b' None \u200b\u53d1\u9001\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u97ad\u70ae\u200b BasketballFace StandardPlugin '\u200b\u7bee\u7403\u200b' / '\u200b\u6295\u4e2a\u200b\u7bee\u7403\u200b' None \u200b\u53d1\u9001\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u7bee\u7403\u200b HotFace StandardPlugin '\u200b\u597d\u200b\u70ed\u200b' / '\u200b\u70ed\u6b7b\u200b\u4e86\u200b' / '\u200b\u592a\u70ed\u200b\u4e86\u200b' None \u200b\u53d1\u9001\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u70ed\u5316\u200b\u4e86"},{"location":"plugin/plugins/superEmojiPlugin/#2","title":"2. \u200b\u793a\u8303\u200b\u6837\u4f8b","text":"<pre><code>111&gt; \u200b\u70df\u82b1\u200b\nbot&gt; \u3010\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u70df\u82b1\u200b\u3011\n222&gt; \u200b\u70b9\u4e2a\u200b\u97ad\u70ae\u200b\nbot&gt; \u3010\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u97ad\u70ae\u200b\u3011\n333&gt; \u200b\u6295\u4e2a\u200b\u7bee\u7403\u200b\nbot&gt; \u3010\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u7bee\u7403\u200b\u3011\n444&gt; \u200b\u70ed\u6b7b\u200b\u4e86\u200b\nbot&gt; \u3010\u200b\u8d85\u7ea7\u200b\u8868\u60c5\u200b\uff1a\u200b\u70ed\u5316\u200b\u4e86\u200b\u3011\n</code></pre>"},{"location":"plugin/plugins/superEmojiPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<pre><code>from typing import Union, Any\nfrom utils.basicEvent import *\nfrom utils.standardPlugin import StandardPlugin\nclass FireworksFace(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u653e\u4e2a\u200b\u70df\u82b1\u200b','\u200b\u70df\u82b1\u200b']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, \"[CQ:face,id=333,type=sticker]\", data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;dict:\nreturn {\n'name': 'FireworksFace',\n'description': '\u200b\u70df\u82b1\u200b',\n'commandDescription': '\u200b\u653e\u4e2a\u200b\u70df\u82b1\u200b/\u200b\u70df\u82b1\u200b',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass FirecrackersFace(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u70b9\u4e2a\u200b\u97ad\u70ae\u200b','\u200b\u97ad\u70ae\u200b']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, \"[CQ:face,id=137,type=sticker]\", data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;dict:\nreturn {\n'name': 'FirecrackersFace',\n'description': '\u200b\u97ad\u70ae\u200b',\n'commandDescription': '\u200b\u70b9\u4e2a\u200b\u97ad\u70ae\u200b/\u200b\u97ad\u70ae\u200b',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass BasketballFace(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u6295\u4e2a\u200b\u7bee\u7403\u200b','\u200b\u6295\u7bee\u200b']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, \"[CQ:face,id=114,type=sticker]\", data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;dict:\nreturn {\n'name': 'BasketballFace',\n'description': '\u200b\u6295\u7bee\u200b',\n'commandDescription': '\u200b\u6295\u4e2a\u200b\u7bee\u7403\u200b/\u200b\u6295\u7bee\u200b',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass HotFace(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg in ['\u200b\u70ed\u6b7b\u200b\u4e86\u200b', '\u200b\u597d\u200b\u70ed\u200b', '\u200b\u592a\u70ed\u200b\u4e86\u200b']\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\ntarget = data['group_id'] if data['message_type']=='group' else data['user_id']\nsend(target, \"[CQ:face,id=340,type=sticker]\", data['message_type'])\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;dict:\nreturn {\n'name': 'HotFace',\n'description': '\u200b\u70ed\u5316\u200b\u4e86\u200b',\n'commandDescription': '\u200b\u70ed\u6b7b\u200b\u4e86\u200b/\u200b\u597d\u200b\u70ed\u200b/\u200b\u592a\u70ed\u200b\u4e86\u200b',\n'usePlace': ['group', 'private'],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"},{"location":"plugin/plugins/wordcloudPlugin/","title":"\u6628\u65e5\u200b\u8bcd\u4e91","text":""},{"location":"plugin/plugins/wordcloudPlugin/#1","title":"1. \u200b\u63d2\u4ef6\u200b\u7b80\u4ecb","text":"\u63d2\u4ef6\u200b\u540d\u79f0\u200b \u200b\u7236\u7c7b\u200b \u200b\u89e6\u53d1\u200b\u5173\u952e\u8bcd\u200b \u200b\u89e6\u53d1\u200b\u6743\u9650\u200b \u200b\u5185\u5bb9\u200b GenWordCloud StandardPlugin <code>None</code> None \u200b\u751f\u6210\u200b\u8bcd\u200b\u4e91\u56fe\u200b\u3001\u200b\u8bcd\u4e91\u200b\u5e7f\u64ad\u200b wordCloudPlugin StandardPlugin '-wc' None \u200b\u83b7\u53d6\u200b\u672c\u7fa4\u200b\u6628\u65e5\u200b\u8bcd\u4e91"},{"location":"plugin/plugins/wordcloudPlugin/#2","title":"2. \u200b\u6837\u4f8b\u200b\u5206\u6790","text":""},{"location":"plugin/plugins/wordcloudPlugin/#3","title":"3. \u200b\u4ee3\u7801\u200b\u5206\u6790","text":"<p>\u200b\u4ee3\u7801\u200b\u4f4d\u4e8e\u200b <code>plugins/groupWordCloud.py</code></p> <pre><code>def wc_save_path(group_id:int, yesterday_str:str)-&gt;str:\nreturn os.path.join(ROOT_PATH, SAVE_TMP_PATH, f'{group_id}_{yesterday_str}_wordcloud.png')\nclass GenWordCloud(StandardPlugin, CronStandardPlugin):\nmonitorSemaphore = Semaphore()\ndef __init__(self):\nself.stopwords = set()\nself.userdict_path = os.path.join(ROOT_PATH, 'resources/corpus/wc_userdict.txt')\nif GenWordCloud.monitorSemaphore.acquire(blocking=False):\nself.start(5, 60)\n_content = [line.strip() for line in open('resources/corpus/wc_stopwords.txt', 'r', encoding='utf-8-sig').readlines()]\nself.stopwords.update(_content)\nif os.path.exists(self.userdict_path):            \njieba.load_userdict(self.userdict_path)\ndef judgeTrigger(self, msg: str, data: Any) -&gt; bool:\nreturn False\ndef executeEvent(self, msg: str, data: Any) -&gt; Union[None, str]:\nreturn None\ndef tick(self):\nnow_time = datetime.datetime.now()\nh_m = datetime.datetime.strftime(now_time,'%H:%M')\nyesterday_str=(datetime.date.today() + datetime.timedelta(days=-1)).strftime('%Y-%m-%d')\nif h_m not in ['00:00']: return\nfor group_id in APPLY_GROUP_ID:\nwcPic = self.genWordCloud(group_id)\nif wcPic == None: continue\npicPath = wc_save_path(group_id, yesterday_str)\nimg = Image.new('RGBA', (860, 670), PALETTE_WHITE)\ndraw = ImageDraw.Draw(img)\ndraw.rectangle((0,0,859,669), fill=PALETTE_WHITE, outline=PALETTE_GREY_BORDER, width=2)\nimg.paste(wcPic, (30,30))\nsize0 = draw.textsize('\u200b\u6628\u200b \u200b\u65e5\u200b \u200b\u8bcd\u200b \u200b\u4e91\u200b', font=FONT_SYHT_M42)\ndraw.text((30,590), '\u200b\u6628\u200b \u200b\u65e5\u200b \u200b\u8bcd\u200b \u200b\u4e91\u200b', fill=PALETTE_BLACK, font=FONT_SYHT_M42)\ndraw.text((30+size0[0]+10, 595), '\ud83e\udd84', fill=(209,113,183,255), font=FONT_SYHT_M24)\nsize1 = draw.textsize(yesterday_str, font=FONT_SYHT_M24)\nsize2 = draw.textsize('\u200b\u7fa4\u200b %d'%group_id, font=FONT_SYHT_M18)\ndraw.text((830-size1[0],590), yesterday_str, fill=PALETTE_GREY_SUBTITLE, font=FONT_SYHT_M24)\ndraw.text((830-size2[0],600+size1[1]), '\u200b\u7fa4\u200b %d'%group_id, fill=PALETTE_GREY, font=FONT_SYHT_M18)\nimg.save(picPath)\nif group_id in getPluginEnabledGroups('wcdaily'):\nsend(group_id, '\u200b\u672c\u7fa4\u200b\u6628\u65e5\u200b\u8bcd\u4e91\u200b\u5df2\u200b\u751f\u6210\u200b~','group')\nsend(group_id, f'[CQ:image,file=files://{picPath}]','group')\ndef genWordCloud(self,group_id)-&gt;Optional[Image.Image]:\ntry:\nmydb = mysql.connector.connect(**sqlConfig)\nmycursor = mydb.cursor()\nmycursor.execute(\"SELECT message FROM BOT_DATA.messageRecord WHERE group_id=%d and TO_DAYS(NOW( ))-TO_DAYS(time)&lt;=1 and user_id!=%d\"%(group_id, BOT_SELF_QQ))\nresult=list(mycursor)\ntext = []\nfor sentence, in result:\nsentence:str\nsubsentence = re.split(r'\\[CQ[^\\]]*\\]|\\s|\\,|\\.|\\!|\\@|\\;|\u3002|\uff01|\uff1f|\uff1a|\uff1b|\u201c|\u201d|\u3010|\u3011', sentence)\nsubsentence = [re.sub(r'[^\\u4e00-\\u9fa5]', '', s) for s in subsentence]\nfor s in subsentence:\ntext += jieba.cut(s)\nif len(text)&lt;=50:\nreturn None # \u200b\u6d88\u606f\u200b\u8fc7\u5c11\u200b\uff0c\u200b\u4e0d\u200b\u751f\u6210\u200b\u8bcd\u4e91\u200b\nwc = wordcloud.WordCloud(font_path=\"resources/fonts/SourceHanSansCN-Medium.otf\",\nwidth = 800,\nheight = 540,\nbackground_color='white',\nmin_font_size=6,\nmax_words=120,stopwords=self.stopwords)\nwc.generate(' '.join(text))\nim = wc.to_image()\nreturn im\nexcept mysql.connector.Error as e:\nwarning(\"mysql error in getGroupWordCloud: {}\".format(e))\nexcept BaseException as e:\nwarning(\"error in getGroupWordCloud: {}\".format(e))\nreturn None\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'GenWordCloud',\n'description': '\u200b\u8bcd\u4e91\u200b\u5e7f\u64ad\u200b',\n'commandDescription': 'None',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\nclass wordCloudPlugin(StandardPlugin):\ndef judgeTrigger(self, msg:str, data:Any) -&gt; bool:\nreturn msg=='-wc'\ndef executeEvent(self, msg:str, data:Any) -&gt; Union[None, str]:\nyesterday_str=str(datetime.date.today() + datetime.timedelta(days=-1))\nsave_path = os.path.join(SAVE_TMP_PATH, str(data['group_id'])+f'_{yesterday_str}_wordcloud.png')\nsave_path = os.path.join(ROOT_PATH, save_path)\nif not os.path.exists(save_path):\nsend(data['group_id'], \"\u200b\u672c\u7fa4\u200b\u672a\u200b\u751f\u6210\u200b\u6628\u65e5\u200b\u8bcd\u4e91\u200b\uff08\u200b\u53ef\u80fd\u200b\u539f\u56e0\u200b\uff1a\u200b\u63d2\u4ef6\u200b\u9519\u8bef\u200b\u6216\u200b\u6628\u65e5\u200b\u7fa4\u200b\u6d88\u606f\u200b\u8fc7\u5c11\u200b\uff09\")\nelse:\nsend(data['group_id'], f'[CQ:image,file=files://{save_path}]','group')\nreturn \"OK\"\ndef getPluginInfo(self, )-&gt;Any:\nreturn {\n'name': 'wordCloudPlugin',\n'description': '\u200b\u672c\u7fa4\u200b\u6628\u65e5\u200b\u8bcd\u4e91\u200b',\n'commandDescription': '-wc',\n'usePlace': ['group', ],\n'showInHelp': True,\n'pluginConfigTableNames': [],\n'version': '1.0.0',\n'author': 'Unicorn',\n}\n</code></pre>"}]}